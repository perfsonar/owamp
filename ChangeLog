------------------------------------------------------------------------
r1052 | aaron | 2009-01-23 12:35:41 -0500 (Fri, 23 Jan 2009) | 3 lines

Change the version # to 3.1


------------------------------------------------------------------------
r1051 | aaron | 2009-01-21 11:24:06 -0500 (Wed, 21 Jan 2009) | 3 lines

Update milestones to match CHANGES


------------------------------------------------------------------------
r1050 | aaron | 2009-01-21 11:16:49 -0500 (Wed, 21 Jan 2009) | 3 lines

Remove out-dated readme file


------------------------------------------------------------------------
r1049 | aaron | 2009-01-21 11:15:53 -0500 (Wed, 21 Jan 2009) | 3 lines

Add powstream change to CHANGES file


------------------------------------------------------------------------
r1048 | aaron | 2009-01-21 10:16:08 -0500 (Wed, 21 Jan 2009) | 3 lines

Commit the ChangeLog


------------------------------------------------------------------------
r1047 | aaron | 2009-01-21 09:32:03 -0500 (Wed, 21 Jan 2009) | 3 lines

Don't man2html the partial files


------------------------------------------------------------------------
r1046 | aaron | 2009-01-20 17:08:40 -0500 (Tue, 20 Jan 2009) | 3 lines

Update the man2html part of the Makefile and use the newly tagged I2util external


------------------------------------------------------------------------
r1045 | aaron | 2009-01-20 08:01:46 -0500 (Tue, 20 Jan 2009) | 8 lines

Truncate the PID file before printing the PID to it. This fixes an issue where a high PID process would get restarted and the new instance would have a low PID. The pid file would then look like:

283
8

This would not work all that well.


------------------------------------------------------------------------
r1041 | aaron | 2009-01-12 09:46:23 -0500 (Mon, 12 Jan 2009) | 3 lines

man2html seems to ignore the first line of a table, so move the environmental variable descriptions down a line so that it'll show.


------------------------------------------------------------------------
r1040 | aaron | 2009-01-12 07:54:12 -0500 (Mon, 12 Jan 2009) | 3 lines

Add infosheet to the doc directory. 


------------------------------------------------------------------------
r1039 | aaron | 2009-01-07 14:38:08 -0500 (Wed, 07 Jan 2009) | 5 lines

Silence a warning on a race condition (an error occurs if it's not just a simple race condition, so it shouldn't be an issue).
Add a line in the help describing the "-t" command
Allow you to specify more than one file for owstats and have them processed in order (modifies the man page to that effect).


------------------------------------------------------------------------
r1038 | aaron | 2009-01-07 12:33:42 -0500 (Wed, 07 Jan 2009) | 3 lines

Merge in the changes from the powstream_sender branch.


------------------------------------------------------------------------
r1037 | aaron | 2008-12-18 15:08:07 -0500 (Thu, 18 Dec 2008) | 3 lines

Minor spec file updates


------------------------------------------------------------------------
r1036 | aaron | 2008-12-18 13:20:47 -0500 (Thu, 18 Dec 2008) | 5 lines

Update the documentation with the new fixes
Use "ChangeLog" instead of "CHANGELOG" to make it more like bwctl
Add a "CHANGES" file like bwctl has


------------------------------------------------------------------------
r1035 | aaron | 2008-12-18 13:04:21 -0500 (Thu, 18 Dec 2008) | 3 lines

Put in a dependency for the owamp-server on the I2util rpm since it has utilities (pfstore) that are needed for the server


------------------------------------------------------------------------
r1034 | aaron | 2008-12-18 09:48:09 -0500 (Thu, 18 Dec 2008) | 4 lines

Update doc/Makefile.am to make sure that the new reordering document, as well as the various .ms files are included.
Document the default port in the example conf file


------------------------------------------------------------------------
r1033 | boote | 2008-12-16 13:38:51 -0500 (Tue, 16 Dec 2008) | 5 lines

Modified human readable reordering to use 02 definition (%reordering relative
to full number of packets received) and modified -M output to just output
the number of packets that are N-reordered instead of using a percentage.


------------------------------------------------------------------------
r1032 | boote | 2008-11-04 01:26:57 -0500 (Tue, 04 Nov 2008) | 4 lines

Fixed owp file reading to correctly initialize 'stat' variables for version
2 files.


------------------------------------------------------------------------
r1031 | aaron | 2008-10-30 09:37:56 -0400 (Thu, 30 Oct 2008) | 3 lines

Bring owamp more in-line with bwctl (includes I2util and man2html-ifying the man pages).


------------------------------------------------------------------------
r1030 | boote | 2008-09-23 12:20:40 -0400 (Tue, 23 Sep 2008) | 3 lines

Fix ucp->udp typo.


------------------------------------------------------------------------
r1025 | aaron | 2008-08-25 08:39:14 -0400 (Mon, 25 Aug 2008) | 5 lines

Bump the version number to 3.0d
Include an init file
Bring in a spec file more in line with the bwctl spec file


------------------------------------------------------------------------
r1011 | boote | 2008-08-15 13:07:11 -0400 (Fri, 15 Aug 2008) | 4 lines

Added XXX comments to all the places I think modifications need to be
made to enable powstream to manage 'sender' side tests.


------------------------------------------------------------------------
r1010 | boote | 2008-07-19 12:29:55 -0400 (Sat, 19 Jul 2008) | 9 lines

protocol.c
Initialize the WriteAcceptSession msg buffer to 0 before assigning the rest
of the fields. (Was sending some bugus information in the MBZ bytes...)

details.html
Updated the NTP URL reference for information on picking the number of
servers.


------------------------------------------------------------------------
r1009 | boote | 2008-07-14 13:05:08 -0400 (Mon, 14 Jul 2008) | 4 lines

If the user pfs is not valid, disable encryption for the last block of the
Server-Start message.


------------------------------------------------------------------------
r1008 | boote | 2008-07-10 18:30:58 -0400 (Thu, 10 Jul 2008) | 3 lines

Latest version of cookbook with bsc's edits.


------------------------------------------------------------------------
r1007 | boote | 2008-07-09 13:14:57 -0400 (Wed, 09 Jul 2008) | 3 lines

Update of the owamp-cookbook.doc file based on Aaron comments.


------------------------------------------------------------------------
r1006 | boote | 2008-07-08 20:39:50 -0400 (Tue, 08 Jul 2008) | 6 lines

Adding the owamp-cookbook.doc file into the repo so it has the potential
to get updated when owamp changes.

jeff


------------------------------------------------------------------------
r1005 | boote | 2008-06-30 10:32:24 -0400 (Mon, 30 Jun 2008) | 3 lines

Build hint for the forgetful... (yeah, me.)


------------------------------------------------------------------------
r1004 | boote | 2008-06-30 01:14:37 -0400 (Mon, 30 Jun 2008) | 6 lines

Fixed bugs Merlijn Hofstra found with the implementation of the
FetchSession message in owampd. (Setting nslots even if session
not complete.)



------------------------------------------------------------------------
r1003 | aaron | 2008-06-24 10:35:09 -0400 (Tue, 24 Jun 2008) | 7 lines

Minor fix for a protocol issue found by merlijn. In open mode, the HMAC field
might be non-zero even though the protocol states it needs to be non-zero. Best
I can figure is that the location of the HMAC field had some old data in it
from a previous message. Making _OWPSendHMACDigestClear unconditionally zero
out the HMAC section fixes the issue.


------------------------------------------------------------------------
r1002 | boote | 2008-06-05 17:44:57 -0400 (Thu, 05 Jun 2008) | 5 lines

Make diagnostic error message clear that it is not a serious problem.

jeff


------------------------------------------------------------------------
r1001 | boote | 2008-04-30 18:03:26 -0400 (Wed, 30 Apr 2008) | 4 lines

Fix a type alignment/casting issue. It turns out the ancillary data returned
from IP_TTL is an int, not a uchar. who knew? (big endien test host found it)


------------------------------------------------------------------------
r1000 | boote | 2008-03-15 16:18:31 -0400 (Sat, 15 Mar 2008) | 6 lines

Moving owamp todo's out of my palm database into here. These need
to be put into a better format, and some of them are likely already
done - but I'm upgrading my system and don't want to go through all
todo's in my palm database right now.


------------------------------------------------------------------------
r999 | boote | 2008-01-07 12:50:48 -0500 (Mon, 07 Jan 2008) | 3 lines

Adding checks for connect/bind functions.


------------------------------------------------------------------------
r998 | boote | 2007-12-07 19:14:48 -0500 (Fri, 07 Dec 2007) | 8 lines

Mostly corrected comments. (Reference material for bwctl.)

Corrected one 'port-range' related bit of logic. If the range is
specified, but has a length of one, failure is reported as if
a range was not specified.

jeff

------------------------------------------------------------------------
r997 | boote | 2007-09-28 02:11:11 -0400 (Fri, 28 Sep 2007) | 4 lines

spec file Warren used to generate owamp RPM. configure.ac needs to be
integrated with this before the next release.


------------------------------------------------------------------------
r996 | boote | 2007-09-17 17:54:11 -0400 (Mon, 17 Sep 2007) | 5 lines

Adding 'reordering' to -M output. (Matches what VV and I discussed last week.)

jeff


------------------------------------------------------------------------
r995 | boote | 2007-08-22 16:47:53 -0400 (Wed, 22 Aug 2007) | 3 lines

Make error message clearer.


------------------------------------------------------------------------
r992 | boote | 2007-07-05 14:36:56 -0400 (Thu, 05 Jul 2007) | 8 lines

owampd.man
    Corrected the man page to show the units for the OWAMP_DEBUG_TIMEOFFSET
    environment var.

INSTALL
    Removed a reference to a no-longer existant part of the distribution.


------------------------------------------------------------------------
r986 | boote | 2007-05-17 21:28:56 -0400 (Thu, 17 May 2007) | 5 lines

Modified to use I2Util from a different repository. The code-bases are
being separated. This is the first step to using rpm/ports/etc... style
distribution mechanisms.


------------------------------------------------------------------------
r985 | boote | 2007-05-17 21:27:15 -0400 (Thu, 17 May 2007) | 3 lines

Removed inaccurate comment.


------------------------------------------------------------------------
r984 | boote | 2007-03-23 16:44:58 -0400 (Fri, 23 Mar 2007) | 15 lines

While reviewing some owamp code (because it is similar to bwctl) I noticed
a problem:

Index: owamp/context.c
===================================================================
RCS file: /home/cvs/engdev/owamp/owamp/context.c,v
retrieving revision 1.32
diff -r1.32 context.c
553c553
<     return False;
---
>     return True;

Code reviews are good...

------------------------------------------------------------------------
r983 | boote | 2007-03-08 11:50:22 -0500 (Thu, 08 Mar 2007) | 3 lines

recvtime of 0 indicates lost packet. raw output description never
explained this - DFN question...

------------------------------------------------------------------------
r982 | boote | 2007-03-07 15:36:17 -0500 (Wed, 07 Mar 2007) | 4 lines

Adding firewall config explaination.

jeff

------------------------------------------------------------------------
r981 | boote | 2007-03-06 19:20:41 -0500 (Tue, 06 Mar 2007) | 3 lines

Modify diffserv/tos byte setting so it will hopefully work with
RFC 3542 (advanced socket api) semantics.

------------------------------------------------------------------------
r980 | boote | 2007-03-06 17:02:45 -0500 (Tue, 06 Mar 2007) | 12 lines

Corrected DSCP/PHB owping options. (Error pointed out by DFN from when
they did functional testing of the perfSONAR CLI MP.)

Removed the -H option and added symbolic constants to the -D option.

Also modified the way man pages are generated yet again. It turns out
'man' in general is not smart enough to pull in include files before
running tbl. So, I modified my man pages so during the 'make' process,
it calls soelim to do the 'includes' and then 'man' will get full
versions of every file and can run tbl on the whole thing already
put together.

------------------------------------------------------------------------
r978 | boote | 2007-02-24 07:21:54 -0500 (Sat, 24 Feb 2007) | 2 lines

Oops - missed changing the format for the includes in these files.

------------------------------------------------------------------------
r977 | boote | 2007-02-24 06:51:11 -0500 (Sat, 24 Feb 2007) | 2 lines

Updating with latest changes for release.

------------------------------------------------------------------------
r976 | boote | 2007-02-24 06:50:05 -0500 (Sat, 24 Feb 2007) | 2 lines

Updating supported system list.

------------------------------------------------------------------------
r975 | boote | 2007-02-24 06:38:29 -0500 (Sat, 24 Feb 2007) | 2 lines

use old-style basename in rule so solaris will still work.

------------------------------------------------------------------------
r974 | boote | 2007-02-24 06:31:01 -0500 (Sat, 24 Feb 2007) | 2 lines

prepare for release 3.0c

------------------------------------------------------------------------
r973 | boote | 2007-02-24 06:30:27 -0500 (Sat, 24 Feb 2007) | 2 lines

Adding milestones for the latest release.

------------------------------------------------------------------------
r972 | boote | 2007-02-24 06:23:53 -0500 (Sat, 24 Feb 2007) | 2 lines

preparing for 3.0c release

------------------------------------------------------------------------
r971 | boote | 2007-02-24 06:23:40 -0500 (Sat, 24 Feb 2007) | 2 lines

preparing for 3.0c release.

------------------------------------------------------------------------
r970 | boote | 2007-02-24 06:22:14 -0500 (Sat, 24 Feb 2007) | 8 lines

Added option to save summary data into files instead of printing it
to stdout. The option prints the filenames that are used to stdout, and
saves the summary data in the files. This makes parsing large .owp files
and creating summary plots much easier.

Also reorganized the man pages again to use the .so 'include file' option
that is part of man/groff instead of building the files using autoconf.

------------------------------------------------------------------------
r969 | boote | 2007-02-24 06:19:08 -0500 (Sat, 24 Feb 2007) | 7 lines

reversing rules that did includes of man pages using autoconf. That
turned out to be a pain. I now use autoconf to build a 'man1' dir
inside the source tree and add symlinks into the partial man pages.

This allows the '.so' groff_man include rule to be used. (Needed to
have the correct relative path to make it work.)

------------------------------------------------------------------------
r968 | boote | 2007-02-24 04:15:04 -0500 (Sat, 24 Feb 2007) | 8 lines

out_opts:
    Adding option to save summary info to files and print the filenames
    to stdout. (Useful for plotting data.)

powstream.man:
    Add information about filename format and correct a few errors
    in the documentation regarding summary/data file generation.

------------------------------------------------------------------------
r967 | boote | 2007-02-23 03:29:20 -0500 (Fri, 23 Feb 2007) | 7 lines

Document new -N option.

Modify man pages to be generated by autoconf from several sub-files.
Basically, I now include the option descriptions from other files
so they are the same between each command even though the commands
are different.

------------------------------------------------------------------------
r966 | boote | 2007-02-23 03:27:29 -0500 (Fri, 23 Feb 2007) | 2 lines

Use autoconf to generate owping/owfetch/owstats/owup man pages.

------------------------------------------------------------------------
r965 | boote | 2007-02-21 15:28:51 -0500 (Wed, 21 Feb 2007) | 8 lines

Modified powstream so it does not print the filenames for the output
session files until both the raw data file AND the summary file are
ready. This makes powmaster.pl more simple - it can now rely on the
fact that the summary file is ready when it sees the raw data file.
(This never used to be a problem, but now that the database is
faster there is no-backlog at the measurement host - so this race
condition is excercised.)

------------------------------------------------------------------------
r964 | boote | 2007-02-15 00:33:59 -0500 (Thu, 15 Feb 2007) | 3 lines

Add ability for owping(and owstats/owfetch) to sub-divide sessions for the
purposes of statistics reporting.

------------------------------------------------------------------------
r963 | boote | 2007-02-05 23:18:19 -0500 (Mon, 05 Feb 2007) | 3 lines

powstream.c:
    fflush summary file before printing results are ready

------------------------------------------------------------------------
r962 | boote | 2007-02-05 23:17:51 -0500 (Mon, 05 Feb 2007) | 2 lines

Fix help message for MallocDebug option.

------------------------------------------------------------------------
r961 | boote | 2007-02-01 14:10:30 -0500 (Thu, 01 Feb 2007) | 2 lines

Incorporate sevett edits.

------------------------------------------------------------------------
r959 | boote | 2007-01-02 18:56:30 -0500 (Tue, 02 Jan 2007) | 2 lines

Update for 3.0b release.

------------------------------------------------------------------------
r958 | boote | 2007-01-02 18:49:59 -0500 (Tue, 02 Jan 2007) | 4 lines

Preparing for 3.0b release

Adding doc/milestones.html document for version history information

------------------------------------------------------------------------
r957 | boote | 2007-01-02 18:49:26 -0500 (Tue, 02 Jan 2007) | 2 lines

Modifying release process to include editing of the new version history file.

------------------------------------------------------------------------
r956 | boote | 2006-12-19 17:31:35 -0500 (Tue, 19 Dec 2006) | 9 lines

Makefile.am:
    Add sha1P.h into distribution. (Now test apps can run.)

api.c:
    Fixed bug in relative wait time variable used to call select(2).
    (Was using the wrong function to convert from owptimestamp to
    timeval. This caused it to be off by unix_epoch.) Did not
    cause problems in normal operation.

------------------------------------------------------------------------
r955 | boote | 2006-12-19 17:29:21 -0500 (Tue, 19 Dec 2006) | 9 lines

configure.ac:
    version 3.0b

LICENSE:
    Grammar.

Makefile.am:
    Add LICENSE into dist tarball.

------------------------------------------------------------------------
r953 | boote | 2006-12-05 02:07:27 -0500 (Tue, 05 Dec 2006) | 3 lines

Correct "Unable to connect" error message so it makes sense for IPv6
addresses. (was host:port, now reports [host]:port)

------------------------------------------------------------------------
r952 | boote | 2006-12-05 01:49:45 -0500 (Tue, 05 Dec 2006) | 2 lines

Prepare for 3.0a release.

------------------------------------------------------------------------
r951 | boote | 2006-12-05 01:45:07 -0500 (Tue, 05 Dec 2006) | 12 lines

Features:
-Added 'enddelay' parameter to allow for a configurable delay before
sending the stop-sessions message.
-Added the OWAMP_DEBUG_OFFSET env var to make owamp timestamp functions
offset by the specified amount. Makes debugging issues from offset
clocks more easy to do.

Documentation:
-Added powstream.man documentation.
-Lots of spelling fixes in the man pages.
-Documented enddelay in man pages.

------------------------------------------------------------------------
r950 | boote | 2006-11-21 01:20:42 -0500 (Tue, 21 Nov 2006) | 2 lines

change recv loop to initialize properly for offset clocks.

------------------------------------------------------------------------
r949 | boote | 2006-11-21 01:09:49 -0500 (Tue, 21 Nov 2006) | 5 lines

Added OWAMP_DEBUG_TIMEOFFSET option

Fixed stopsessions message handling to report error for bad
next_seqno.

------------------------------------------------------------------------
r948 | boote | 2006-11-08 02:50:23 -0500 (Wed, 08 Nov 2006) | 2 lines

solaris port: int types, header file reordering

------------------------------------------------------------------------
r947 | boote | 2006-11-08 02:50:04 -0500 (Wed, 08 Nov 2006) | 2 lines

fix bug triggered by severly offset clocks: setitimer() called with negative value

------------------------------------------------------------------------
r946 | boote | 2006-11-08 00:21:45 -0500 (Wed, 08 Nov 2006) | 9 lines

owampd.conf:
    document default port (861)

*.c:
    Fixed a bug in the I/O. When I added the 'retn_on_intr' variable to the
    I/O functions, I forgot to go back and add it into the client side
    functions. (This caused the owping client to refuse to die from
    a cntrl-C in some cases.)

------------------------------------------------------------------------
r945 | boote | 2006-11-07 01:00:43 -0500 (Tue, 07 Nov 2006) | 2 lines

Using more standard EACCES errno instead of EAUTH.

------------------------------------------------------------------------
r944 | boote | 2006-11-07 00:54:55 -0500 (Tue, 07 Nov 2006) | 2 lines

Merging RFC version into HEAD.

------------------------------------------------------------------------
r923 | boote | 2006-10-05 20:24:23 -0400 (Thu, 05 Oct 2006) | 2 lines

fix typo in detection of truncated cmd message from recvmsg().

------------------------------------------------------------------------
r922 | boote | 2006-09-16 02:14:05 -0400 (Sat, 16 Sep 2006) | 2 lines

comment changes - and unify a type.

------------------------------------------------------------------------
r921 | boote | 2006-08-04 03:14:17 -0400 (Fri, 04 Aug 2006) | 4 lines

going back to using esterror instead of maxerror from NTP. maxerror is just TOO conservative.

jeff

------------------------------------------------------------------------
r920 | boote | 2006-07-25 19:53:36 -0400 (Tue, 25 Jul 2006) | 4 lines

Updating Boolean type to be intptr_t so get/set funcitions work better.

jeff

------------------------------------------------------------------------
r919 | boote | 2006-07-25 18:02:13 -0400 (Tue, 25 Jul 2006) | 13 lines

addr.c:
    Modifed the 64-bit byte swapping code so it does not violate
    the strict alias rules for gcc's optimizing compiler.
    (Now, instead of casting a uint8_t * into the uint64_t I do
    a memcpy and set the memory back into the uint64_t. How is that
    for un-optimizing...)

endpoint.c:
    Corrected a bug in the tempfile creation. (Failed permissions were
    not being detected correctly.)

jeff

------------------------------------------------------------------------
r918 | boote | 2006-05-25 18:57:31 -0400 (Thu, 25 May 2006) | 2 lines

These reference the reordering url too.

------------------------------------------------------------------------
r917 | boote | 2006-05-25 18:56:11 -0400 (Thu, 25 May 2006) | 2 lines

Changing to make reordering url work.

------------------------------------------------------------------------
r915 | boote | 2006-05-24 16:16:34 -0400 (Wed, 24 May 2006) | 4 lines

New changes for OWAMP_2_0c release.

jeff

------------------------------------------------------------------------
r914 | boote | 2006-05-24 16:14:33 -0400 (Wed, 24 May 2006) | 4 lines

Initialize timestamp structure for missing-packet record.

jeff

------------------------------------------------------------------------
r913 | boote | 2006-05-23 14:34:17 -0400 (Tue, 23 May 2006) | 4 lines

prepare 2.0c release.

jeff

------------------------------------------------------------------------
r912 | boote | 2006-05-23 14:34:02 -0400 (Tue, 23 May 2006) | 12 lines

BUGFIX!
    Problem: The receiver process over-writes the recv timestamp variable when
    outputting lost packet records. (The order of things changed in a
    previous release - it used to be ok to share this variable.)

    Solution: Add a temporary variable for the lost timestamp.

    Impact: If you have one lost packet, your data will show a lost packet
    roughly every 'timeout' seconds after that.

jeff

------------------------------------------------------------------------
r911 | boote | 2006-05-23 14:31:46 -0400 (Tue, 23 May 2006) | 4 lines

preparing for 2.0c release.

jeff

------------------------------------------------------------------------
r909 | boote | 2006-05-11 19:57:28 -0400 (Thu, 11 May 2006) | 4 lines

Adding owup.man into man1 targets.

jeff

------------------------------------------------------------------------
r908 | boote | 2006-05-11 19:56:57 -0400 (Thu, 11 May 2006) | 4 lines

Adding usage message for owup.

jeff

------------------------------------------------------------------------
r907 | boote | 2006-05-11 19:47:43 -0400 (Thu, 11 May 2006) | 4 lines

Adding section on version compatibility.

jeff

------------------------------------------------------------------------
r906 | boote | 2006-05-11 19:35:45 -0400 (Thu, 11 May 2006) | 4 lines

Adding documentation for owup.

jeff

------------------------------------------------------------------------
r905 | boote | 2006-04-18 17:57:42 -0400 (Tue, 18 Apr 2006) | 4 lines

changelog for 2.0b release.

jeff

------------------------------------------------------------------------
r904 | boote | 2006-04-09 19:55:03 -0400 (Sun, 09 Apr 2006) | 2 lines

Prepare for 2.0b release. (ITEC only release)

------------------------------------------------------------------------
r903 | boote | 2006-04-09 19:54:22 -0400 (Sun, 09 Apr 2006) | 4 lines

Prepare for 2.0b release. (ITEC only release)

jeff

------------------------------------------------------------------------
r902 | boote | 2006-04-09 19:41:28 -0400 (Sun, 09 Apr 2006) | 8 lines

Added setsid() code back in. Realized the problem I was having before was
unrelated - so I was able to add this back in.

Now powstream and owping now catch ^C and attempt to save partial session
information. A second ^C should completely terminate.

jeff

------------------------------------------------------------------------
r901 | boote | 2006-04-07 18:20:22 -0400 (Fri, 07 Apr 2006) | 61 lines

Removed DetachProcess context option I added last week.

The sub-processes now ignore SIGTERM/SIGHUP correctly. The parent
process initiates graceful shutdown from SIGTERM/HUP and immediate
kill from SIGINT. (SIGINT gets sent to the whole process group and
immediately terminates all children processes as well.) For TERM/HUP
the parent process attempts to trade StopSession messages and
do data validation cleanup before exiting. (The parent process
sends USR2 to sub-processes to notify them of the early exit
time.)

This also works for owping. (Note however, that a ^C will send a
SIGINT on most systems, so this is not the way to get partial results.

(I could catch SIGINT in the parent processes, and for the first
one attempt to do a graceful shutdown, and for the second one do
a SIGKILL for the child processes... But, that would require
a fair amount of code rework.)

api.c:
    Added data cleanup routines. These get called in place of the
    ReadStopSessions functions if the control connection is closed.
    Basically, this removes any  missing packet records after the
    last real received one - but shares some functionality with
    the routines that are based on the 'stoptime' and 'next_seqno'
    version used by the ReadStopSessions functions.

endpoint.c:
    Now ignore TERM/HUP.

io.c:
    Remove error message printout in low-level read function. Higher
    levels deal with the error and report it if needed.

owamp.h:
    Remove DetachProcesses context stuff.

protocol.c:
    Moved much of the code from the ReadStopSessions function into
    utility routines in api.c so they could be shared.

owampd.c:
    Handle SIGTERM/HUP more gracefully. Current sessions are now
    sent the StopSessions message and partial sessions are saved.

policy.c:
    If StopSessions DOES happen and the AcceptValue is not ACCEPT,
    then delete the data file. It is invalid data. (This is how
    the data cleaning functions notify the other portions of the
    code.)

owping.c:
    Add sig handlers and pay attention to the StopSessions return
    values to determine if partial sessions should be kept or not.

powstream.c:
    Pay attention to the AcceptValue return and delete invalid
    partial sessions.

jeff

------------------------------------------------------------------------
r900 | boote | 2006-03-30 12:56:52 -0500 (Thu, 30 Mar 2006) | 41 lines

Modified signal handling with regard to early termination of tests
to be more resiliant in powstream. (There were problems if the
sessions contained too many LostPacket records - and other
things were fixed to make signal handling more predictable.)

endpoint.c:
    Added an option to make the test processes call setsid. (This
    ensures that if powstream is sent a SIGINT from another process
    it behaves the same way as if the user types ^C on the command-line.

owamp.h:
    Added context variable for DetachProcesses option.

protocol.c:
    Modified the data cleansing algorithm to compute the received
    time of the packet from the presumed send time in the case of
    lost packet records. (It needs to know the recv time to know
    how far it is in the recv stream - the packets are sorted
    by recv time.) It does this to avoid multiple passes
    through the data when deciding what records to keep an what
    records to throw away.

    Also, the data validation was not using the next_seqno from the
    stop_sessions packet like it should have. (The statistics
    code did - but it is better to add it here.)

    Currently the data cleaning code is embeded in the ReadStopSessions
    message code. The next step is to extract it from there and generalize
    it some so it can be called in the case where StopSessions messages
    are not passed. (In that case, data is just thrown out at the moment.)

powstream.c
    Added a delayStart option. Modified it to set the DetachProcesses
    option. Modified it to call StopSessions when abandoning a test
    instead of just closing the connection allowing the library
    to do a nicer job of cleaning up. Added a debug child option.

(Just checking in what I have before going off-line completely for a few days.)

jeff

------------------------------------------------------------------------
r899 | boote | 2006-03-25 12:00:31 -0500 (Sat, 25 Mar 2006) | 7 lines

Adding cast so loss percent is calculated correctly.

(Ok, ok Eric. You were right, I should have held off longer before making another public
release.)

jeff

------------------------------------------------------------------------
r897 | boote | 2006-03-23 15:09:52 -0500 (Thu, 23 Mar 2006) | 11 lines

owampd.c
    The 'starttime' variable was not being initialized if the
    process was detaching from the terminial. Moved the initialization
    outside that block of code.

owping.c
    Removed non ISO strftime format options. Using older, more available
    versions instead.

jeff

------------------------------------------------------------------------
r896 | boote | 2006-03-23 14:14:08 -0500 (Thu, 23 Mar 2006) | 5 lines

Adding a list of things to be done for each release to help me
remember.

jeff

------------------------------------------------------------------------
r895 | boote | 2006-03-23 14:10:52 -0500 (Thu, 23 Mar 2006) | 4 lines

new change log for 2.0a

jeff

------------------------------------------------------------------------
r894 | boote | 2006-03-23 14:09:23 -0500 (Thu, 23 Mar 2006) | 3 lines

preparing for 2.0a release
    fix statistics bugs...

------------------------------------------------------------------------
r893 | boote | 2006-03-23 14:05:02 -0500 (Thu, 23 Mar 2006) | 15 lines

configure.ac:
    Removed dependence on ieeefp.h functions. (finite) It doesn't
    work enough places to make it worth using.

owamp/stats.c powstream/*:
    Fixed a border case where the last packet in a sub-session
    was lost. (I had a >, where I needed a >= to make the end
    of the session detection correctly. This was not being done
    correctly if the last packet in the sub-session was lost.)

    Modified the MAX/MIN detection to stop using 'finite' and
    use a different method to determine if MAX/MIN were valid.

jeff

------------------------------------------------------------------------
r892 | boote | 2006-03-23 12:57:06 -0500 (Thu, 23 Mar 2006) | 8 lines

stats.c:
    Fixed bug where maxdelay is reported as maxerr.

owping/*:
    Added owup command-line utility. Reports the 'start time' of a server.

jeff

------------------------------------------------------------------------
r890 | boote | 2006-03-15 16:29:14 -0500 (Wed, 15 Mar 2006) | 4 lines

Updating changelog for 2.0 release.

jeff

------------------------------------------------------------------------
r889 | boote | 2006-03-15 16:26:57 -0500 (Wed, 15 Mar 2006) | 4 lines

Adding supported systems to the documentation.

jeff

------------------------------------------------------------------------
r888 | boote | 2006-03-15 15:13:23 -0500 (Wed, 15 Mar 2006) | 6 lines

mod for 4.X version FreeBSD... (This one is trivial - if there are difficult
mods later, I will just remove 4.X from the supported systems list. It
is dated now...)

jeff

------------------------------------------------------------------------
r887 | boote | 2006-03-15 14:37:47 -0500 (Wed, 15 Mar 2006) | 5 lines

Accidentily used unsigned constants to init signed values - -1 is not a very
big number...

jeff

------------------------------------------------------------------------
r886 | boote | 2006-03-15 14:05:24 -0500 (Wed, 15 Mar 2006) | 5 lines

Adding autoconf magic to create PRIu64 and PRIuPTR if they do not
exist. (Needed for old solaris...)

jeff

------------------------------------------------------------------------
r885 | boote | 2006-03-15 12:41:46 -0500 (Wed, 15 Mar 2006) | 4 lines

Fix for Solaris 8 (since it does not define inttypes.h format macros...).

jeff

------------------------------------------------------------------------
r884 | boote | 2006-03-15 11:20:27 -0500 (Wed, 15 Mar 2006) | 4 lines

Corrected header-file inclusion order for the rest of the package.

jeff

------------------------------------------------------------------------
r883 | boote | 2006-03-15 02:23:41 -0500 (Wed, 15 Mar 2006) | 6 lines

Corrected header-file ordering so that the conf.h file gets included
before system header files. This allows _LARGEFILE_SOURCE and other
posix/STDC flags to be set more easily from autoconf macros.

jeff

------------------------------------------------------------------------
r882 | boote | 2006-03-15 01:54:48 -0500 (Wed, 15 Mar 2006) | 4 lines

Removed unneeded test.

jeff

------------------------------------------------------------------------
r881 | boote | 2006-03-15 01:49:54 -0500 (Wed, 15 Mar 2006) | 7 lines

Modified all %llu format specification strings to use the inttypes.h
fmt specifiers for uint64_t (PRIu64) instead.

Needed for 64bit systems where long long can actually be 128 bits...

jeff

------------------------------------------------------------------------
r880 | boote | 2006-03-14 15:00:14 -0500 (Tue, 14 Mar 2006) | 17 lines

Mostly corrections for 64-bit FreeBSD. (plus one bug fix in endpoint.c)

io.c
    adding include of <string.h>

endpoint.c
    Fixing buf for skip record allocation. (had MIN where I should have had MAX)
    Changing type for 'waitfor' variable. - needed for 64-bit.

fts.c
    casting to remove warning on 64-bit

owampd.c,owampdP.h,owping.c,owpingP.h
    change type for 'waitfor'

jeff

------------------------------------------------------------------------
r879 | boote | 2006-03-14 14:37:47 -0500 (Tue, 14 Mar 2006) | 8 lines

Better documentation for the bucket_width. Explained how this determines
the resolution of the histogram and therefore the resolution of the
median that is reported. (And explained that for very small maximum delays,
a bucket_width that is too small will cause the median to be reported as
a larger number than the maximum.)

jeff

------------------------------------------------------------------------
r878 | boote | 2006-03-13 20:09:13 -0500 (Mon, 13 Mar 2006) | 5 lines

Modified stats output to work if 'sent == 0'. This can happen if skip
records end up throwing out all received packets.

jeff

------------------------------------------------------------------------
r877 | boote | 2006-03-13 16:17:37 -0500 (Mon, 13 Mar 2006) | 14 lines

I2util:
    Created utility function to copy files by fd. (Uses mmap/memcpy so
    entire copy is in kernel space.)

owamp/*:
    changed post-session processing to use two files if needed to
    remove records from the datafile. (section 3.8 of owamp draft-14)

powstream:
    Modified to use mmap utility function. (used to use a local function
    here - bascially moved it to I2util.)

jeff

------------------------------------------------------------------------
r876 | boote | 2006-03-10 14:09:31 -0500 (Fri, 10 Mar 2006) | 4 lines

changes for 2.0 release.

jeff

------------------------------------------------------------------------
r875 | boote | 2006-03-10 13:00:09 -0500 (Fri, 10 Mar 2006) | 4 lines

Adding text explaining the Test Vector generation application.

jeff

------------------------------------------------------------------------
r874 | boote | 2006-03-09 20:58:54 -0500 (Thu, 09 Mar 2006) | 7 lines

Small change to ntp initialization - and now simple owamp tests seem to
be working now on solaris 8.

Local tests and tests between packrat(Linux) have been successful.

jeff

------------------------------------------------------------------------
r873 | boote | 2006-03-09 20:22:43 -0500 (Thu, 09 Mar 2006) | 4 lines

OS X defined dirfd as a Macro so the test needs to be slightly different...

jeff

------------------------------------------------------------------------
r872 | boote | 2006-03-09 20:04:29 -0500 (Thu, 09 Mar 2006) | 11 lines

Changes to make owamp compile on solaris. (This was much more of
a pain than I realized. Solaris does not support quite the same directory
API (fts/dirent) as the other systems owamp has been ported to.)

Thank goodness FreeBSD has reasonable licensing.

(I'm going to go back to FreeBSD/Linux/OS X and make sure I didn't
break anything compile-wise before I do any tests of the running code...)

jeff

------------------------------------------------------------------------
r871 | boote | 2006-03-09 14:15:26 -0500 (Thu, 09 Mar 2006) | 5 lines

Removing #define of _GNU_SOURCE. I am moving that into the autoconf
definitions.

jeff

------------------------------------------------------------------------
r870 | boote | 2006-03-09 14:14:27 -0500 (Thu, 09 Mar 2006) | 12 lines

Pulling source for fts(3) into owampd (from FreeBSD).

fts(3) does not live in Solaris land...

This version will be used on all architectures. I would rather use this one
version for all arch's than do the ugly autoconf conditional include thing...

If at some point in the future, all supported arch's have fts - then this
can be removed.

jeff

------------------------------------------------------------------------
r869 | boote | 2006-03-07 19:03:28 -0500 (Tue, 07 Mar 2006) | 4 lines

Forgot owstats.man and owfetch.man in man targets.

jeff

------------------------------------------------------------------------
r868 | boote | 2006-03-07 00:47:01 -0500 (Tue, 07 Mar 2006) | 4 lines

Want to actually install documentation...

jeff

------------------------------------------------------------------------
r867 | boote | 2006-03-07 00:43:21 -0500 (Tue, 07 Mar 2006) | 2 lines

Prepare for 2.0...

------------------------------------------------------------------------
r866 | boote | 2006-03-07 00:42:44 -0500 (Tue, 07 Mar 2006) | 4 lines

Preparing for 2.0 release...

jeff

------------------------------------------------------------------------
r865 | boote | 2006-03-07 00:35:40 -0500 (Tue, 07 Mar 2006) | 4 lines

Modifying main doc page to have version 2.0.

jeff

------------------------------------------------------------------------
r864 | boote | 2006-02-16 22:01:33 -0500 (Thu, 16 Feb 2006) | 12 lines

owampd/owampd.c:
    Fixing bug found at Jt Tech's workshop. (null uid specified would
    cause core dump.)

powstream/powstream.c:
    Fixed bug with default bucket size specification for sum sessions.
    (Was resetting to 0 if intermediate sum sessions were not being
    done, but this interferred with the sum session data created
    for regular session intervals.)

jeff

------------------------------------------------------------------------
r862 | boote | 2006-02-04 15:58:36 -0500 (Sat, 04 Feb 2006) | 4 lines

Preparing for another distribution: OWAMP_2_0_dev_e

jeff

------------------------------------------------------------------------
r861 | boote | 2006-02-04 15:56:05 -0500 (Sat, 04 Feb 2006) | 6 lines

Hmmm, should we include the documentation as part of the distribution?

After 3 YEARS of distribution! Yes - lets start doing that.

jeff

------------------------------------------------------------------------
r859 | boote | 2006-01-04 21:25:45 -0500 (Wed, 04 Jan 2006) | 6 lines

Breaking up policy so that reading of key files is done with
root permissions, but creation of data directories is done
after root permissions are reduced.

jeff

------------------------------------------------------------------------
r858 | boote | 2006-01-04 21:08:31 -0500 (Wed, 04 Jan 2006) | 6 lines

Moving policy initialization. It now happens after seteid so any
filesystem permission problems will be found on startup and not
during the first test.

jeff

------------------------------------------------------------------------
r857 | boote | 2006-01-04 19:34:32 -0500 (Wed, 04 Jan 2006) | 2 lines

Bump version again.

------------------------------------------------------------------------
r856 | boote | 2006-01-04 13:10:15 -0500 (Wed, 04 Jan 2006) | 2 lines

Fix uninitialized variable.

------------------------------------------------------------------------
r854 | boote | 2006-01-03 19:02:35 -0500 (Tue, 03 Jan 2006) | 4 lines

Fixing bug in encrypted mode.

jeff

------------------------------------------------------------------------
r853 | boote | 2006-01-03 19:01:55 -0500 (Tue, 03 Jan 2006) | 2 lines

bumping version number.

------------------------------------------------------------------------
r851 | boote | 2005-12-23 14:16:00 -0500 (Fri, 23 Dec 2005) | 18 lines

addr.c:
    comment added

owamp/doc:
    Revised for new release. Added documentation for all new features.

owamp/sapi.c:
    Changed error messages to be more consistent.

owamp/stats.c:
    Modified summary output to report hops instead of TTL.

owampd.c:
    Modified usage message to include new options.

owping.c:
    Modified usage message to include new options.

------------------------------------------------------------------------
r850 | boote | 2005-12-23 00:51:46 -0500 (Fri, 23 Dec 2005) | 7 lines

capi.c:
    Bug fix - was attempting to bind the saddr instead of the local one.
    (testing to localhost doesn't find some things. ;) )

powstream.c:
    Fix bug with null control pointer.

------------------------------------------------------------------------
r849 | boote | 2005-12-22 23:53:03 -0500 (Thu, 22 Dec 2005) | 2 lines

Arch diagram

------------------------------------------------------------------------
r848 | boote | 2005-12-22 23:44:51 -0500 (Thu, 22 Dec 2005) | 22 lines

configure:
    Bumping version
    Adding library checks for math functions

I2util:
    configure: Adding checks for socket api calls
    Adding I2Addr abstraction api from owamp (cleaned it up too).

owamp:
    Removed addr abstraction api.
    Now using I2Addr abstraction api.
        (localized almost all V4/V6 code into one file!)
    Found a memory leak in the client FetchSession api.

powstream:
    Modified the signal handling code to properly process
    the current session when a signal comes in. It catches
    the signal - stops the session and saves as much of the
    current session as it can based on the process outlined
    in the spec. (Saving only packet records earlier than the
    last actual received packet.)

------------------------------------------------------------------------
r847 | boote | 2005-12-19 19:46:33 -0500 (Mon, 19 Dec 2005) | 5 lines

Removing direct specification of -lm from the powstream makefile. It
is now specified from the configure.ac file. (On FreeBSD and OS X the
ceil() function is in libc - on Linux it is in libm. This allows
configure to handle this.

------------------------------------------------------------------------
r846 | boote | 2005-12-19 19:37:58 -0500 (Mon, 19 Dec 2005) | 4 lines

Adding #include of stdio.h for Linux.

jeff

------------------------------------------------------------------------
r845 | boote | 2005-12-19 19:30:36 -0500 (Mon, 19 Dec 2005) | 4 lines

Removed debugging code. (Oops - didn't mean to check it in.)

jeff

------------------------------------------------------------------------
r844 | boote | 2005-12-19 19:28:56 -0500 (Mon, 19 Dec 2005) | 9 lines

owamp/*.c:

    Found and fixed two memory leaks.
        1.) One was introduced by the new stats stuff in powstream.
        2.) Has existed for two years in the test-endpoint control
        code.

jeff

------------------------------------------------------------------------
r843 | boote | 2005-12-19 19:28:26 -0500 (Mon, 19 Dec 2005) | 8 lines

configure.ac:

    Add nice OS X MallocDebug library option. (I actually found the
    standard malloc with the debugging env variables more useful, but
    left this in here for the GUI-happy masses.)

jeff

------------------------------------------------------------------------
r842 | boote | 2005-12-19 19:27:34 -0500 (Mon, 19 Dec 2005) | 8 lines

doc/*:

    Document server binding options a little better.
    Document rootfolly option.
    Document bucket_width option.

jeff

------------------------------------------------------------------------
r841 | boote | 2005-12-16 16:39:53 -0500 (Fri, 16 Dec 2005) | 15 lines


endpoint.c:
    Modified ttl code to support multiple ways of receiving ttl.
    (linux is different from BSD derived systems.)
stats.c:
    Increased buffer allocation factor.
    Fixed a border case in sub-session statistics
    Modified not to use soft-float stuff - just isn't everywhere yet.
owampd.c:
    Added rootfolly option
    moved setuid code around to be easier.

powstream.c:
    Added new stats stuff.

------------------------------------------------------------------------
r840 | boote | 2005-12-12 19:43:03 -0500 (Mon, 12 Dec 2005) | 4 lines

Autoconf bs to link -lm.

jeff

------------------------------------------------------------------------
r839 | boote | 2005-12-09 19:44:42 -0500 (Fri, 09 Dec 2005) | 23 lines

I2Util:
    table.c (Modify a signed value to an unsigned one for num table elems.)

doc:
    owping - command-line option additions for statistics.
        added -a multiple percentile options (modified from previous)
        added -n units option
        added -M (machine parsable output)

owamp:
    Added stats.c functions and headers.
    endpoint.c - cleanup
        Corrected recv session to output missing packet records
        for early terminated tests.
    owping.c - totally changed statistics. They now use a fixed
        amount of memory, and are correct in many cases where
        they were not before. Added 'jitter' as well.
        added options.

powstream still needs to be modified to use the statistics.

jeff

------------------------------------------------------------------------
r838 | boote | 2005-11-03 00:15:21 -0500 (Thu, 03 Nov 2005) | 4 lines

Updated the -R option to include the TTL field.

jeff

------------------------------------------------------------------------
r837 | boote | 2005-10-26 07:42:55 -0400 (Wed, 26 Oct 2005) | 35 lines

Fixed some signal handling problems in owamp.

api.c:
    Simplified error detection code in the StopSessions function.

endpoint.c:
    Modified IPV6_HOPLIMIT reading to correctly read the data as a
    full int. (Was using unsigned char...)

    Changed IPv4 TTL reading to use ancilary type IP_RECVTTL instead
    of IP_TTL. This is more in-line with the standards docs and seems
    to work on FreeBSD and OS X. However... I will need to test it on
    linux. I believe Linux uses IP_TTL for the RECV side as well. If so
    I will need to put some linux specific code in to handle this.

io.c:
    Modified the signaling part to fail more gracefully if the write/read
    function fails due to a broken pipe.

owampd.c:
    Adding a shutdown(2) of socketpair sockets in the main owampd control
    process during a graceful shutdown. (child processes were hanging
    while attempting to "release" resources over the pipe.)

powstream.c:
    changing the -C option to -N: I like it better.

    modifying the error handling code to reset "both" control connections
    instead of just the one with the problem.

    Moved some of the state resetting code to the end of the main control
    loop to simplify the logic.

jeff

------------------------------------------------------------------------
r836 | boote | 2005-10-19 20:02:12 -0400 (Wed, 19 Oct 2005) | 11 lines

owamp library:
Adding functions to actually read the skip records out of the file for
statistical purposes.

powstream:
Adding ability to terminate early on a unix signal - saving the partial
session using the skip records data. (This still needs to be added
for owping - after SC.)

jeff

------------------------------------------------------------------------
r835 | boote | 2005-10-15 19:58:19 -0400 (Sat, 15 Oct 2005) | 10 lines

Added functionality to terminate a powstream session early by sending
it a signal.

Modified "finished" information to be an actual enum within the
code instead of a u_int32_t.

Added rec_size as inforation in the file "hdr" structure to deal
with differences between current owp files and future files that
have ttl in them.

------------------------------------------------------------------------
r834 | boote | 2005-10-12 15:02:59 -0400 (Wed, 12 Oct 2005) | 4 lines

Modified all formatting to remove tabs and use 4 char indents.

jeff

------------------------------------------------------------------------
r833 | boote | 2005-10-12 11:55:19 -0400 (Wed, 12 Oct 2005) | 10 lines

Basically: Adding ttl code into powstream

fixing mmap file copy code (the read file also needs PROT_WRITE).

Reordered summary code to get fileend before checking for records.

Modified summary generation code to include ttl information.

jeff

------------------------------------------------------------------------
r832 | boote | 2005-10-06 15:46:14 -0400 (Thu, 06 Oct 2005) | 18 lines

Fixed several bugs that were exposed by running on OS X:

api.c:
    initialized variable problem

endpoint.c:
    Made sequence numbers consistently 32 bit quantities.
    Fixed type mismatch in function definition/function prototype.

time.c:
    Made timespec -> timestamp conversion encode error estimates
    with scale=64 and mult=1 if !sync.

(powstream still has problems but owping/owampd have been tested a
fair bit on OS X now.)

jeff

------------------------------------------------------------------------
r831 | boote | 2005-10-05 22:52:03 -0400 (Wed, 05 Oct 2005) | 32 lines

General:
Modified code to remove compiler warnings.
reformatted some of the code to remove annoying tabs.
(Will go through and reformat the rest before releasing.)

powstream.c:
    Major rework - simplified the code (somewhat). Summary files
    are now the "intermediate" data output by powstream. It only
    puts out raw data files based on the larger interval you give
    it. (On abilene that is currently 12 hours... we may want to
    change that.)

    Summary statistics will be put out more regularly. I suspect
    we will stick with the 30 second summary sessions for abilene.


**** Not TESTED! ****

It compiles completely clean, but I have not had a chance to run it
yet. (It does compile on OS X as well... I guess this is what happens
when that is what is sitting in front of me.)

owamp plans:

Testing starts next week along with major reworking of the ami
perl scripts to handle the ttl data as well as the new interval
setup of powstream. (I intend to gut most of the "validation" code
from the ami scripts and use the "skip records" from the raw data
files for this. It should make the database code about 50% easier!)

jeff

------------------------------------------------------------------------
r830 | boote | 2005-09-30 19:46:27 -0400 (Fri, 30 Sep 2005) | 4 lines

Checkpoint. powstream is currently a mess.

jeff

------------------------------------------------------------------------
r829 | boote | 2005-09-30 19:45:50 -0400 (Fri, 30 Sep 2005) | 4 lines

Adding check for sys/timex.h to determine if NTP syscalls avail.

jeff

------------------------------------------------------------------------
r828 | boote | 2005-09-30 19:45:14 -0400 (Fri, 30 Sep 2005) | 4 lines

Modified context funcs to remove (void*)func_ptr issues.

jeff

------------------------------------------------------------------------
r827 | boote | 2005-09-30 19:44:40 -0400 (Fri, 30 Sep 2005) | 4 lines

Modified context to remove (void*)func_ptr issues.

jeff

------------------------------------------------------------------------
r826 | boote | 2005-09-30 19:42:01 -0400 (Fri, 30 Sep 2005) | 7 lines

Modified context functions to remove (void*)func_ptr related
compiler warnings.

Removed NTP requirement for owamp. (unleash the chaos) [UNTESTED]

jeff

------------------------------------------------------------------------
r825 | boote | 2005-09-29 20:21:02 -0400 (Thu, 29 Sep 2005) | 6 lines

Stupid autoconf always changing and never getting better...

complex_build_software--

jeff

------------------------------------------------------------------------
r824 | boote | 2005-06-20 20:00:07 -0400 (Mon, 20 Jun 2005) | 10 lines

I introduced a few bugs in the new version with regard to authenticated
mode. (Basically, the SendBlocks function is destructive for the
passed in message, and I was using memory I wanted to look at later.)

This is somewhat non-intuitive (It would be nice if Send was not destructive)
however, I don't want to add an extra copy in to everything, so I will just
need to be more careful.

jeff

------------------------------------------------------------------------
r823 | boote | 2005-06-20 19:57:13 -0400 (Mon, 20 Jun 2005) | 5 lines

Corrected size of copy. (Only the first 4 chars of a username were actually
being used to match for policy decisions.)

jeff

------------------------------------------------------------------------
r822 | boote | 2005-05-10 02:03:45 -0400 (Tue, 10 May 2005) | 4 lines

Added support for ttl and the new file API into powstream.

jeff

------------------------------------------------------------------------
r820 | boote | 2005-05-09 17:56:24 -0400 (Mon, 09 May 2005) | 4 lines

Preparing for a 2.0dev-a release.

jeff

------------------------------------------------------------------------
r819 | boote | 2005-05-09 17:34:51 -0400 (Mon, 09 May 2005) | 5 lines

Corrected logic for "raw" option. (There is some confusing interplay
between the "quiet" and the "raw" option. I need to correct this someday...)

jeff

------------------------------------------------------------------------
r818 | boote | 2005-05-06 11:27:39 -0400 (Fri, 06 May 2005) | 13 lines

owampd.man:
    Documented error message philosophy.
    Documented SIGNAL usage.

owamp/capi.c:
owamp/endpoint.c:
owamp/sapi.c:
owampd/policy.c:
    Changed error levels for some messages. INFO is now used exclusively
    for "access" log issues.

jeff

------------------------------------------------------------------------
r817 | boote | 2005-05-03 19:44:26 -0400 (Tue, 03 May 2005) | 4 lines

Changed the default test back to 10hz. (Stas convinced me it is better.)

jeff

------------------------------------------------------------------------
r816 | boote | 2005-05-03 16:03:09 -0400 (Tue, 03 May 2005) | 4 lines

Changed default test to 1 packet per second, and 10 packets.

jeff

------------------------------------------------------------------------
r815 | boote | 2005-05-03 10:48:45 -0400 (Tue, 03 May 2005) | 4 lines

changed how the "quiet" option works slightly.

jeff

------------------------------------------------------------------------
r814 | boote | 2005-05-03 08:16:13 -0400 (Tue, 03 May 2005) | 8 lines

owping.man:
    Adding TTL output information to -R

owping.c:
    Correct "comments" regarding the -R "printraw" function.

jeff

------------------------------------------------------------------------
r813 | boote | 2005-05-02 16:22:24 -0400 (Mon, 02 May 2005) | 4 lines

syntax...

jeff

------------------------------------------------------------------------
r812 | boote | 2005-05-02 15:45:50 -0400 (Mon, 02 May 2005) | 12 lines

api.c:
    Deal with division by 0 in OWPTestPacketRate.

owping.c:
    Add summary statistics for ttl.
    Add output of "end of test" estimate.

owping.man:
    Document the -z option (delay start).

jeff

------------------------------------------------------------------------
r811 | boote | 2005-04-29 23:19:42 -0400 (Fri, 29 Apr 2005) | 4 lines

Oops - syntax.

jeff

------------------------------------------------------------------------
r810 | boote | 2005-04-29 23:16:36 -0400 (Fri, 29 Apr 2005) | 5 lines

Adding a -z option to owping. (delayStart) This option is used to run
a test the specified number of seconds in the future.

jeff

------------------------------------------------------------------------
r809 | boote | 2005-04-28 20:16:10 -0400 (Thu, 28 Apr 2005) | 5 lines

Removed all shm stuff. The portability issues were not worth the marginal
performance enhancement.

jeff

------------------------------------------------------------------------
r808 | boote | 2005-04-28 13:02:52 -0400 (Thu, 28 Apr 2005) | 12 lines

Initial port to Linux, and

I FINALLY FOUND THE WEIRD MEMORY BUG!
When I introduced the IPC mechanism, I had to change where the datafile was
closed so the parent could access it after the child exits. However, I
forgot that I had specified the file buffer directly, and this was
still being freed. Unfortunately, efence was only marginally useful in finding
this because memory accesses inside the file io functions are somehow
trapped differently. But, 4 hours later.... I finally figured it out.

jeff

------------------------------------------------------------------------
r807 | boote | 2005-04-27 18:37:49 -0400 (Wed, 27 Apr 2005) | 4 lines

Added shm file sizing.

jeff

------------------------------------------------------------------------
r806 | boote | 2005-04-27 12:50:05 -0400 (Wed, 27 Apr 2005) | 29 lines

Corrected FetchSession interaction. Needed to send block of IZP between
skips and data records even if there are no skips. I had accidentily put the
write of that block in the if(num_skiprecs) block.

Simplified the Data file reading code slightly.

Corrected FetchSession interaction. Needed to send block of IZP between
skips and data records even if there are no skips. I had accidentily put the
write of that block in the if(num_skiprecs) block.

Simplified the Data file reading code slightly.

Still to be done for this version (aiming for this week):

        Fix shared memory IPC - just need to add an fdtruncate call
        to assign the file size. (Currently using normal files for
        IPC - this is a compile time selection.)

        Add ttl summary info to owping/owstats output.

        Test ttl data on an OS that supports it...

        Add sub-session summaries to powstream so AMI database host
        interaction can be optimized.

        Porting to additional OS's.

jeff

------------------------------------------------------------------------
r805 | boote | 2005-04-25 20:59:56 -0400 (Mon, 25 Apr 2005) | 21 lines

Bug fixes for new code:

Needed to modify where the datafile is closed. (It used to be closed
in the parent immediately, now the parent has to go through the data
when the stop sessions message comes in to delete records after
(stoptime - timeout).

Also needed to modify all fdopens to open w+ instead of w so the
records can be queried as well as written.

Needed to modify the interpolated binary search to round instead of truncate
when determining the candidate.

Missed a few spots where the return type of the DataHeader write functions
changed return values. (They now return boolean - they used to return int's.)

Receive sessions are working from owping now. There is still a problem with
the Fetch protocol at the moment that I have not tracked down yet.

jeff

------------------------------------------------------------------------
r804 | boote | 2005-04-22 18:19:44 -0400 (Fri, 22 Apr 2005) | 4 lines

Ugh. - typo.

jeff

------------------------------------------------------------------------
r803 | boote | 2005-04-22 18:18:28 -0400 (Fri, 22 Apr 2005) | 4 lines

Just formatting changes.

jeff

------------------------------------------------------------------------
r802 | boote | 2005-04-21 19:57:21 -0400 (Thu, 21 Apr 2005) | 4 lines

Modified api call for reading an owp file header.

jeff

------------------------------------------------------------------------
r801 | boote | 2005-04-21 12:42:59 -0400 (Thu, 21 Apr 2005) | 4 lines

Adding autoconf rules for disabling the use of shared-mem for IPC.

jeff

------------------------------------------------------------------------
r800 | boote | 2005-04-20 20:17:46 -0400 (Wed, 20 Apr 2005) | 4 lines

Fixing syntax errors (typos).

jeff

------------------------------------------------------------------------
r799 | boote | 2005-04-20 18:50:44 -0400 (Wed, 20 Apr 2005) | 26 lines

I2util/
aespasswd.c:
    Fixed C macro for creating a string out of a constant.

doc/*:
    *   Added some NTP details based on user comments. (These are old, I
    still need to incorporate comments from the Atl workshop.
    *   Made arch diagram a little nicer.

owamp/*:
    Changes to deal with IPC for reporting back skip ranges to control
    process from the "sender" process. Also, changes for the file format
    to deal with skip records and of course changes to deal with the
    modifications to the StopSessions and FetchSession protocols.

owampd/*:
    Forgot to initialize a variable.

owping:
    formatting changes

powstream:
    change iotime to 3.

jeff

------------------------------------------------------------------------
r798 | boote | 2004-12-02 14:25:48 -0500 (Thu, 02 Dec 2004) | 2 lines

Added a link to J-OWAMP.

------------------------------------------------------------------------
r797 | boote | 2004-10-05 18:17:09 -0400 (Tue, 05 Oct 2004) | 4 lines

Adding some new failure (accept) values into code.

jeff

------------------------------------------------------------------------
r796 | boote | 2004-09-28 01:56:42 -0400 (Tue, 28 Sep 2004) | 4 lines

remove unused vars.

jeff

------------------------------------------------------------------------
r795 | boote | 2004-09-27 17:26:49 -0400 (Mon, 27 Sep 2004) | 4 lines

typo's.

jeff

------------------------------------------------------------------------
r794 | boote | 2004-09-27 16:20:06 -0400 (Mon, 27 Sep 2004) | 4 lines

Upgrade to version 2.0a.

jeff

------------------------------------------------------------------------
r793 | boote | 2004-09-27 14:17:54 -0400 (Mon, 27 Sep 2004) | 7 lines

owamp.h: Modify "standard" owamp port to 4824

protocol.c: change format of "fetch session" response records. (re-order
    fields to make alignment marginally better.)

jeff

------------------------------------------------------------------------
r792 | boote | 2004-09-27 00:01:56 -0400 (Mon, 27 Sep 2004) | 5 lines

Modified sender not to send packets that should have been sent more than
"timeout" in the past. (change in spec)

jeff

------------------------------------------------------------------------
r791 | boote | 2004-09-22 21:20:46 -0400 (Wed, 22 Sep 2004) | 4 lines

correct summary data for case of duplicate packets.

jeff

------------------------------------------------------------------------
r790 | boote | 2004-09-22 20:43:41 -0400 (Wed, 22 Sep 2004) | 7 lines

owping.c
owpingP.h:
    Adding -D and -H options for setting typeP in owmap protocol with
    DSCP or PHB values.

jeff

------------------------------------------------------------------------
r789 | boote | 2004-09-22 20:42:13 -0400 (Wed, 22 Sep 2004) | 17 lines

capi.c:
sapi.c:
owampP.h:
    Modify calls to endpoint start hooks to expect a possible return
    of "EUNSUPPORTED" error codes so PHB option could be passed to server.
    (owampd still can't do anything with this option and will fail to start
    the test, but another owamp-test server may have the capability and this
    simply allows the option to be set for requests.)
endpoint.c:
    Decode and use the typeP word. If it is a DSCP value, set TOS sockopt
    to do it. If it is a PHB return unsupported.
protocol.c:
    Remove validate of typeP from here and move it into endpoint so the
    option can be passed within the protocol.

jeff

------------------------------------------------------------------------
r788 | boote | 2004-09-22 20:34:35 -0400 (Wed, 22 Sep 2004) | 4 lines

Document the typeP options.

jeff

------------------------------------------------------------------------
r787 | boote | 2004-09-22 19:56:17 -0400 (Wed, 22 Sep 2004) | 4 lines

reformat to 4-char tab stops.

jeff

------------------------------------------------------------------------
r786 | boote | 2004-09-22 19:46:08 -0400 (Wed, 22 Sep 2004) | 4 lines

change format for 'usage' message slightly.

jeff

------------------------------------------------------------------------
r785 | boote | 2004-08-23 16:53:44 -0400 (Mon, 23 Aug 2004) | 6 lines

Added more info to debug messages.

Moved str2num functions into I2util library.

jeff

------------------------------------------------------------------------
r783 | boote | 2004-07-26 18:33:35 -0400 (Mon, 26 Jul 2004) | 4 lines

Changing default config to allow 1 mb/s sessions.

jeff

------------------------------------------------------------------------
r782 | boote | 2004-07-08 17:06:52 -0400 (Thu, 08 Jul 2004) | 4 lines

Added a recommended hardware section.

jeff

------------------------------------------------------------------------
r781 | boote | 2004-06-29 16:23:31 -0400 (Tue, 29 Jun 2004) | 7 lines

Initialize 'rc' so fine optimized code still works... Ugh.

re-order some conf file parsing for permissions reasons. Then take root
permissions back to open keys/limits files.

jeff

------------------------------------------------------------------------
r780 | boote | 2004-06-28 18:34:57 -0400 (Mon, 28 Jun 2004) | 4 lines

Modified socket options to be AF specific. (ttl becomes hoplimit in IPv6)

jeff

------------------------------------------------------------------------
r779 | boote | 2004-06-28 02:14:41 -0400 (Mon, 28 Jun 2004) | 5 lines

Modified code to only try and do ttl if the right sockopt is available.
(It is not on older FreeBSD systems like we are using on Abilene... Ugh.)

jeff

------------------------------------------------------------------------
r778 | boote | 2004-06-28 01:26:47 -0400 (Mon, 28 Jun 2004) | 4 lines

Decode version 3 file headers too...

jeff

------------------------------------------------------------------------
r777 | boote | 2004-06-28 00:03:24 -0400 (Mon, 28 Jun 2004) | 6 lines

Updated version number to 1.7a

This will be the first version to support ttl.

jeff

------------------------------------------------------------------------
r776 | boote | 2004-06-27 23:59:54 -0400 (Sun, 27 Jun 2004) | 5 lines

found another place where the change in test record size to support ttl
caused a needed buffer size change.

jeff

------------------------------------------------------------------------
r775 | boote | 2004-06-27 23:24:21 -0400 (Sun, 27 Jun 2004) | 7 lines

Corrected ProcessFetchSession to handle the new version 3 files.

Modified the message buffer to be large enough to hold the new
fetch records buffer size.

jeff

------------------------------------------------------------------------
r774 | boote | 2004-06-27 22:27:26 -0400 (Sun, 27 Jun 2004) | 4 lines

Modified the "raw" output to include the TTL value of the packet.

jeff

------------------------------------------------------------------------
r773 | boote | 2004-06-27 22:27:01 -0400 (Sun, 27 Jun 2004) | 5 lines

Fixed recvttl function. Was using the wrong constants to decode the
ancillary data.

jeff

------------------------------------------------------------------------
r772 | boote | 2004-06-27 22:26:29 -0400 (Sun, 27 Jun 2004) | 2 lines

removed "boote" path stuff...

------------------------------------------------------------------------
r771 | boote | 2004-06-27 21:59:25 -0400 (Sun, 27 Jun 2004) | 4 lines

Fixed many "minor" compiler warnings. (mostly unused vars and the like)

jeff

------------------------------------------------------------------------
r770 | boote | 2004-06-19 00:54:05 -0400 (Sat, 19 Jun 2004) | 4 lines

Some compile errors fixed... will fix the rest next week.

jeff

------------------------------------------------------------------------
r769 | boote | 2004-06-19 00:06:42 -0400 (Sat, 19 Jun 2004) | 21 lines

Unified "time" api code so all time functions go through the functions
in time.c.

Created version 3 of the owd file format to support ttl data in the records.

Modified the code to set the ttl and retrieve the ttl.

Created single functions for encoding and decoding data records to make it
more simple to change the file i/o functions.

Simplified the "receiver" code by using file i/o functions.

Modified the way "lost packet" records are encoded in the protocol data
stream and in files.

removed functions from unixtime.c

(all this still needs to be compiled and tested...)

jeff

------------------------------------------------------------------------
r766 | boote | 2004-06-09 15:22:16 -0400 (Wed, 09 Jun 2004) | 4 lines

Preparing to tag version OWAMP_1_6f.

jeff

------------------------------------------------------------------------
r765 | boote | 2004-06-09 15:17:47 -0400 (Wed, 09 Jun 2004) | 5 lines

Adding a changelog file for owamp. (Just used rcs2log - but it is better
than nothing, and was dead easy to do.)

jeff

------------------------------------------------------------------------
r764 | boote | 2004-06-09 14:25:49 -0400 (Wed, 09 Jun 2004) | 6 lines

owampd.c: re-ordered descriptor cleanup code.

owping.c: syntax error.

jeff

------------------------------------------------------------------------
r763 | boote | 2004-06-09 13:29:22 -0400 (Wed, 09 Jun 2004) | 6 lines

Thought of a more simple way to close "most" of the open fd's in the
child. This will be important when I add the partial sessions (lots more
fd's will be in use.)

jeff

------------------------------------------------------------------------
r762 | boote | 2004-06-09 12:59:21 -0400 (Wed, 09 Jun 2004) | 4 lines

change the comment to reflect the new limits on portrange.

jeff

------------------------------------------------------------------------
r761 | boote | 2004-06-09 12:57:29 -0400 (Wed, 09 Jun 2004) | 9 lines

*.c:
	Disallow port ranges of a single value other than 0.
	Disallow port ranges where low>high.

doc/*:
	Document port range options.

jeff

------------------------------------------------------------------------
r760 | boote | 2004-06-09 04:35:03 -0400 (Wed, 09 Jun 2004) | 19 lines

I2Util/*:
	Adding functionality to allow error logs to be "reset" after a
	process forks. Specifically added this functionality to the
	"syslog" logger.

owampd.conf,owampd.c:
	Added portrange to owampd.
	Removed current code that closed file descriptors in child.
	Did not work correctly - can only close descriptors from other
	parent/child pipes. Will fix this another time.
	Added code to reset syslog after fork.
endpoint.c:
	Fixed bad error format string.

protocol.c,owampP.h:
	Fixed a bug that resulted in the server configured port
	value being lost, and not saved in the owp files with the
	rest of the TestRequest record.

------------------------------------------------------------------------
r759 | boote | 2004-06-08 19:48:21 -0400 (Tue, 08 Jun 2004) | 2 lines

shortcutting ephemeral specification...

------------------------------------------------------------------------
r758 | boote | 2004-06-08 19:46:38 -0400 (Tue, 08 Jun 2004) | 9 lines

endpoint.c:
	removed assumption that "low" range of 0 means ephemeral.
	Not setting OWPTestPortRange at all means ephemeral.

owping[P].{ch}:
	Adding -P option to allow owping to make use of OWPTestPortRange

jeff

------------------------------------------------------------------------
r757 | boote | 2004-06-07 18:57:56 -0400 (Mon, 07 Jun 2004) | 7 lines

Added hooks to allow a port range to be specified for the test stream.

Now I have to go to the applications (owampd/owping/owampd) and have them
use the hooks. (and test this.)

jeff

------------------------------------------------------------------------
r756 | boote | 2004-06-04 18:04:42 -0400 (Fri, 04 Jun 2004) | 4 lines

Adding just a bit more...

jeff

------------------------------------------------------------------------
r755 | boote | 2004-06-04 17:57:41 -0400 (Fri, 04 Jun 2004) | 4 lines

Corrected syntax errors.

jeff

------------------------------------------------------------------------
r754 | boote | 2004-06-04 17:49:55 -0400 (Fri, 04 Jun 2004) | 2 lines

Too many letters...

------------------------------------------------------------------------
r753 | boote | 2004-06-04 17:32:25 -0400 (Fri, 04 Jun 2004) | 4 lines

spell checked...

jeff

------------------------------------------------------------------------
r752 | boote | 2004-06-04 17:26:52 -0400 (Fri, 04 Jun 2004) | 4 lines

Adding general schedules.

jeff

------------------------------------------------------------------------
r751 | boote | 2004-05-28 18:10:11 -0400 (Fri, 28 May 2004) | 4 lines

Oops - missed a few references.

jeff

------------------------------------------------------------------------
r750 | boote | 2004-05-28 18:05:32 -0400 (Fri, 28 May 2004) | 6 lines

Removing conf file functions from owamp library. I put versions of these
into the I2util library when bwctl was written, this allows bwctl/owamp to
share more code.

jeff

------------------------------------------------------------------------
r749 | boote | 2004-05-28 15:18:22 -0400 (Fri, 28 May 2004) | 5 lines

Added code to allow low level client I/O to be interruptable. This will
correct infrequent problems we have had with powstream hanging.

jeff

------------------------------------------------------------------------
r748 | boote | 2004-05-27 08:08:34 -0400 (Thu, 27 May 2004) | 14 lines

Corrected a number of bugs in the AES implementation within the test packets.

Added debugging code.

Corrected AES encryption for the fetch-session message. (The "zero" buffer
was being contaminated by the fact that _OWPSendBlocks encrypts back to
the same buffer that is sent to it.)

Cleaned up some compile messages.

All encryption modes look like they are working correctly now.

jeff

------------------------------------------------------------------------
r747 | boote | 2004-05-21 18:58:59 -0400 (Fri, 21 May 2004) | 4 lines

close file descriptors in new owampd-control processes.

jeff

------------------------------------------------------------------------
r746 | boote | 2004-05-20 16:50:10 -0400 (Thu, 20 May 2004) | 13 lines

bootstrap: corrected to work with later versions of autoconf.

context.c: Added do-nothing SIGCHLD handler, NTP initialization.
endpoint.c: Removed NTP initialization.
time.c: Added NTP init function.
owping.c: Cleanup, added aes passphrases, fixed aes bug.
powstream.c: ""

I have not tested the passphrase stuff with the server yet - but it
seems to be working correctly.

jeff

------------------------------------------------------------------------
r745 | boote | 2004-05-20 16:46:33 -0400 (Thu, 20 May 2004) | 5 lines

Mostly adding comments that allow vim to assign the correct filetype - just
makes the syntax highlighting work correctly.

jeff

------------------------------------------------------------------------
r744 | boote | 2004-05-13 18:48:03 -0400 (Thu, 13 May 2004) | 4 lines

fixed typo.

jeff

------------------------------------------------------------------------
r743 | boote | 2004-05-13 14:09:16 -0400 (Thu, 13 May 2004) | 4 lines

spelling.

jeff

------------------------------------------------------------------------
r742 | boote | 2004-05-13 13:37:43 -0400 (Thu, 13 May 2004) | 4 lines

Eric's comments.

jeff

------------------------------------------------------------------------
r741 | boote | 2004-05-13 10:29:35 -0400 (Thu, 13 May 2004) | 4 lines

Modified owamp to use I2Hex functions instead of built-in.

jeff

------------------------------------------------------------------------
r740 | boote | 2004-05-13 10:17:22 -0400 (Thu, 13 May 2004) | 4 lines

susan edits

jeff

------------------------------------------------------------------------
r739 | boote | 2004-05-13 09:28:24 -0400 (Thu, 13 May 2004) | 2 lines

Susan edits.

------------------------------------------------------------------------
r738 | boote | 2004-05-12 20:25:46 -0400 (Wed, 12 May 2004) | 4 lines

Reset current version to 1.6d

jeff

------------------------------------------------------------------------
r737 | boote | 2004-05-12 19:36:43 -0400 (Wed, 12 May 2004) | 4 lines

Corrected bold in title.

jeff

------------------------------------------------------------------------
r736 | boote | 2004-05-12 17:05:53 -0400 (Wed, 12 May 2004) | 4 lines

Added a link to the spec into the overview document.

jeff

------------------------------------------------------------------------
r735 | boote | 2004-05-12 16:22:15 -0400 (Wed, 12 May 2004) | 4 lines

Modified description of disk limits to be consistant between these files.

jeff

------------------------------------------------------------------------
r734 | boote | 2004-05-12 14:28:51 -0400 (Wed, 12 May 2004) | 2 lines

owampd.limits.man page.

------------------------------------------------------------------------
r733 | boote | 2004-05-12 12:56:47 -0400 (Wed, 12 May 2004) | 4 lines

Documentation on keys file.

jeff

------------------------------------------------------------------------
r732 | boote | 2004-05-11 19:37:31 -0400 (Tue, 11 May 2004) | 9 lines

details.html:
	Add information on allowing others access to query ntpd.

*.man:
	Modifying encryption description.
	adding owfetch/owampd.conf

jeff

------------------------------------------------------------------------
r731 | boote | 2004-05-10 12:22:28 -0400 (Mon, 10 May 2004) | 2 lines

Incorporated Susan's edits.

------------------------------------------------------------------------
r730 | boote | 2004-05-07 18:03:00 -0400 (Fri, 07 May 2004) | 4 lines

spell checked.

jeff

------------------------------------------------------------------------
r729 | boote | 2004-05-07 17:58:14 -0400 (Fri, 07 May 2004) | 6 lines

Modified the description of encrypted mode in owping.man

Added a man page on owampd.

jeff

------------------------------------------------------------------------
r728 | boote | 2004-05-07 17:57:32 -0400 (Fri, 07 May 2004) | 4 lines

Added the -e option to the "usage" message.

jeff

------------------------------------------------------------------------
r727 | boote | 2004-05-07 10:52:03 -0400 (Fri, 07 May 2004) | 2 lines

spell checked...

------------------------------------------------------------------------
r726 | boote | 2004-05-07 10:47:07 -0400 (Fri, 07 May 2004) | 6 lines

Added examples and alphabetized args in owping.man

Created owstats.man.

jeff

------------------------------------------------------------------------
r725 | boote | 2004-05-05 01:03:51 -0400 (Wed, 05 May 2004) | 4 lines

Removing the '-V' option.

jeff

------------------------------------------------------------------------
r724 | boote | 2004-05-05 01:02:28 -0400 (Wed, 05 May 2004) | 4 lines

first real cut at an owping(1) manual page.

jeff

------------------------------------------------------------------------
r723 | boote | 2004-05-04 18:12:18 -0400 (Tue, 04 May 2004) | 4 lines

Incorporating Susan's edits.

jeff

------------------------------------------------------------------------
r722 | boote | 2004-05-03 17:44:24 -0400 (Mon, 03 May 2004) | 2 lines

Minor changes...

------------------------------------------------------------------------
r721 | boote | 2004-05-03 15:21:56 -0400 (Mon, 03 May 2004) | 10 lines

owamp/protocol.c:
	Adding comments for the format of the data record in a fetch message.

doc/*:
	Adding some documentation. Overview and details are fairly complete
	- just starting man pages. owping.man file is not ready to be
	reviewed.

jeff

------------------------------------------------------------------------
r720 | boote | 2004-05-03 10:30:20 -0400 (Mon, 03 May 2004) | 5 lines

Fixed bug that Ralf found. (powstream didn't work unless you used the -b
option.)

jeff

------------------------------------------------------------------------
r719 | boote | 2004-04-28 17:41:59 -0400 (Wed, 28 Apr 2004) | 5 lines

Adding two simple benchmark programs that are being used to make decisions
about how implement the software clock in owamp.

jeff

------------------------------------------------------------------------
r718 | boote | 2004-03-24 01:41:31 -0500 (Wed, 24 Mar 2004) | 4 lines

Adding message when sig is caught.

jeff

------------------------------------------------------------------------
r716 | boote | 2004-03-10 18:39:27 -0500 (Wed, 10 Mar 2004) | 4 lines

syntax error.

jeff

------------------------------------------------------------------------
r715 | boote | 2004-03-10 18:10:18 -0500 (Wed, 10 Mar 2004) | 4 lines

new version 1.0e

jeff

------------------------------------------------------------------------
r714 | boote | 2004-03-10 17:44:11 -0500 (Wed, 10 Mar 2004) | 4 lines

Changed to use esterr again. maxerr is just way too conservative to be useful.

jeff

------------------------------------------------------------------------
r713 | boote | 2004-03-10 10:19:51 -0500 (Wed, 10 Mar 2004) | 4 lines

Fix AES key policy bug.

jeff

------------------------------------------------------------------------
r712 | boote | 2004-03-03 02:19:19 -0500 (Wed, 03 Mar 2004) | 9 lines

endpoint.c:
	Changed time error estimates to use "maxerror" instead of "esterror".

owampd.c:
	Cleaned up logic slightly and commented a little better.
	(I did this when explaining the source to Rich.)

jeff

------------------------------------------------------------------------
r710 | boote | 2004-01-16 04:18:52 -0500 (Fri, 16 Jan 2004) | 4 lines

Try again... Wasn't handling negative offsets correctly.

jeff

------------------------------------------------------------------------
r709 | boote | 2004-01-16 03:57:47 -0500 (Fri, 16 Jan 2004) | 4 lines

found another place nano's can overflow...

jeff

------------------------------------------------------------------------
r708 | boote | 2004-01-16 03:36:52 -0500 (Fri, 16 Jan 2004) | 5 lines

Fix a bug in the new timing code. (Forgot to check if the nsec's field was
larger than 1 sec before passing back.)

jeff

------------------------------------------------------------------------
r706 | boote | 2004-01-16 02:14:30 -0500 (Fri, 16 Jan 2004) | 4 lines

Attempt to fix the ntp offset problem.

jeff

------------------------------------------------------------------------
r705 | boote | 2004-01-14 18:22:51 -0500 (Wed, 14 Jan 2004) | 4 lines

fix signed/unsigned compare mistake.

jeff

------------------------------------------------------------------------
r704 | boote | 2004-01-12 20:22:07 -0500 (Mon, 12 Jan 2004) | 4 lines

incrementing revision number for hawaii tracking.

jeff

------------------------------------------------------------------------
r703 | boote | 2003-12-08 14:27:19 -0500 (Mon, 08 Dec 2003) | 4 lines

Remove compiler warnings.

jeff

------------------------------------------------------------------------
r702 | boote | 2003-11-07 01:46:35 -0500 (Fri, 07 Nov 2003) | 4 lines

Removed unused owampd.passwd file from owamp.

jeff

------------------------------------------------------------------------
r701 | boote | 2003-10-29 11:43:50 -0500 (Wed, 29 Oct 2003) | 7 lines

fixed a small bug that could happen if a child process somehow hung.

Now the parent will handle that more gracefully. (This has not happened
as far as I know...)

jeff

------------------------------------------------------------------------
r700 | boote | 2003-10-21 11:26:00 -0400 (Tue, 21 Oct 2003) | 4 lines

byte-swap the OWPNum64 values before hex-encoding them for output.

jeff

------------------------------------------------------------------------
r699 | boote | 2003-10-20 17:50:37 -0400 (Mon, 20 Oct 2003) | 4 lines

Adding a program to generate test vectors.

jeff

------------------------------------------------------------------------
r698 | boote | 2003-10-20 12:09:57 -0400 (Mon, 20 Oct 2003) | 6 lines

saddr.h:	added comment

policy.c:	fixed bug in MSGCLAIM message decoding.

jeff

------------------------------------------------------------------------
r697 | boote | 2003-10-01 19:33:02 -0400 (Wed, 01 Oct 2003) | 8 lines

owampd: Changed the bandwidth limit to be bits/second instead of bytes/second.

protocol.c: Corrected possible signal problem.

sapi.c: corrected possible error detection problem.

jeff

------------------------------------------------------------------------
r696 | boote | 2003-09-26 12:53:32 -0400 (Fri, 26 Sep 2003) | 8 lines

sapi.c:	modified the order of ProcessStartSession to remove a potential
	race condition.
powstream.c:
	Added a check for interrupts to another spot to make powstream
	more responsive to interrupts during the "connect" sequence.

jeff

------------------------------------------------------------------------
r695 | boote | 2003-09-19 13:25:13 -0400 (Fri, 19 Sep 2003) | 6 lines

Adding -r option to -h message.

Corrected signal handling for OpenControl.

jeff

------------------------------------------------------------------------
r693 | boote | 2003-07-15 02:49:43 -0400 (Tue, 15 Jul 2003) | 4 lines

removed unused stuff.

jeff

------------------------------------------------------------------------
r692 | boote | 2003-07-15 02:45:16 -0400 (Tue, 15 Jul 2003) | 4 lines

remove digest/script stuff that is no longer used.

jeff

------------------------------------------------------------------------
r691 | boote | 2003-07-15 01:43:07 -0400 (Tue, 15 Jul 2003) | 4 lines

update to version 1.6c

jeff

------------------------------------------------------------------------
r690 | boote | 2003-07-09 02:47:25 -0400 (Wed, 09 Jul 2003) | 4 lines

Corrected bug that caused lost records to be reported incorrectly.

jeff

------------------------------------------------------------------------
r689 | boote | 2003-06-15 18:33:28 -0400 (Sun, 15 Jun 2003) | 4 lines

Forgot to add element to struct.

jeff

------------------------------------------------------------------------
r688 | boote | 2003-06-15 18:29:29 -0400 (Sun, 15 Jun 2003) | 9 lines

I think I finally figured out the strange short read. dup doesn't give you two
underlying file pointers - so the read was repositioning the filepointer and
then the other process would write to the file moving the file pointer up.

fixed this by using fopen to create another reference to the file without
using dup.

jeff

------------------------------------------------------------------------
r687 | boote | 2003-06-14 18:05:15 -0400 (Sat, 14 Jun 2003) | 2 lines

more diagnostics...

------------------------------------------------------------------------
r686 | boote | 2003-06-14 17:26:09 -0400 (Sat, 14 Jun 2003) | 4 lines

Adding fseeko to END to try and update stream to real size of file...

jeff

------------------------------------------------------------------------
r685 | boote | 2003-06-14 13:17:31 -0400 (Sat, 14 Jun 2003) | 4 lines

Add ftello to unexpected EOF to determine how far into the file it is.

jeff

------------------------------------------------------------------------
r684 | boote | 2003-06-14 12:45:51 -0400 (Sat, 14 Jun 2003) | 4 lines

corrected off_t to use %llu for printf statements.

jeff

------------------------------------------------------------------------
r683 | boote | 2003-06-14 12:31:55 -0400 (Sat, 14 Jun 2003) | 4 lines

more diag...

jeff

------------------------------------------------------------------------
r682 | boote | 2003-06-14 12:12:09 -0400 (Sat, 14 Jun 2003) | 4 lines

Add yet more diagnostics...

jeff

------------------------------------------------------------------------
r681 | boote | 2003-06-14 11:23:49 -0400 (Sat, 14 Jun 2003) | 5 lines

resetting eof flag for shared stream in case the parent process reads to
the end of the file before the session is complete.

jeff

------------------------------------------------------------------------
r680 | boote | 2003-06-14 02:06:11 -0400 (Sat, 14 Jun 2003) | 4 lines

fixed 32/64 bit int mismatch.

jeff

------------------------------------------------------------------------
r679 | boote | 2003-06-13 22:58:21 -0400 (Fri, 13 Jun 2003) | 2 lines

yet mor diagnostics...

------------------------------------------------------------------------
r678 | boote | 2003-06-13 22:45:36 -0400 (Fri, 13 Jun 2003) | 2 lines

typo.

------------------------------------------------------------------------
r677 | boote | 2003-06-13 22:33:10 -0400 (Fri, 13 Jun 2003) | 4 lines

adding more diagnostics to fread failure message.

jeff

------------------------------------------------------------------------
r676 | boote | 2003-06-13 21:52:39 -0400 (Fri, 13 Jun 2003) | 10 lines

I2util/table.[ch]:
	Added a HashClean function to clean out a hash table.

powstream.c:
	Added some diagnostics to find out why fread is failing on the
	partial session file. Also modified the Hash table to be cleaned
	on error.

jeff

------------------------------------------------------------------------
r675 | boote | 2003-06-13 01:00:01 -0400 (Fri, 13 Jun 2003) | 4 lines

Fixed max/min problem. (The problem was that I forgot to implement it. Sigh.)

jeff

------------------------------------------------------------------------
r674 | boote | 2003-05-28 14:53:49 -0400 (Wed, 28 May 2003) | 4 lines

Fixed bug with -b flag.

jeff

------------------------------------------------------------------------
r673 | boote | 2003-05-27 19:32:51 -0400 (Tue, 27 May 2003) | 4 lines

Added an option to powstream to make it compute summary data on the fly.

jeff

------------------------------------------------------------------------
r672 | boote | 2003-05-02 16:10:33 -0400 (Fri, 02 May 2003) | 4 lines

Don't set V6 sockopts unless you have a V6 socket!

jeff

------------------------------------------------------------------------
r670 | boote | 2003-04-03 15:24:25 -0500 (Thu, 03 Apr 2003) | 4 lines

I thought $(RM) was standard?

jeff

------------------------------------------------------------------------
r669 | boote | 2003-04-02 20:01:25 -0500 (Wed, 02 Apr 2003) | 6 lines

Added install of owstats/owfetch links to owping.

removed absolete/non-functional owdrive script.

jeff

------------------------------------------------------------------------
r668 | boote | 2003-03-28 15:28:32 -0500 (Fri, 28 Mar 2003) | 10 lines

owping:
	Added a -R "raw" output option. It just dumps records out.
	Absolutely no processing what-so-ever.

owamp:
	Small fixes. (OWPDelay had a bug - it would never return a negative
	delay...)

jeff

------------------------------------------------------------------------
r667 | boote | 2003-03-27 18:37:58 -0500 (Thu, 27 Mar 2003) | 4 lines

Make sure IPV6_V6ONLY sockopt is 0 for server sock so dual-stack will work.

jeff

------------------------------------------------------------------------
r665 | boote | 2003-03-24 12:41:33 -0500 (Mon, 24 Mar 2003) | 4 lines

Grr! - missing packet records are valid to write as well as read!

jeff

------------------------------------------------------------------------
r664 | boote | 2003-03-21 17:48:53 -0500 (Fri, 21 Mar 2003) | 4 lines

Ugh! Yes - a "missing packet" record is a valid record.

jeff

------------------------------------------------------------------------
r663 | boote | 2003-03-20 18:19:49 -0500 (Thu, 20 Mar 2003) | 5 lines

Fixed another case where an IPv4 address was presented as a v6 "v4 mapped"
address.

jeff

------------------------------------------------------------------------
r662 | boote | 2003-03-20 12:35:08 -0500 (Thu, 20 Mar 2003) | 8 lines

conf/owampd.conf:
added more comments to owampd.conf

owampd/policy.c:
owampd will now create the datadir if it doesn't already exist.

jeff

------------------------------------------------------------------------
r661 | boote | 2003-03-20 01:36:11 -0500 (Thu, 20 Mar 2003) | 4 lines

Added comments to explain the "assign" lines in the limits file.

jeff

------------------------------------------------------------------------
r660 | boote | 2003-03-19 21:29:00 -0500 (Wed, 19 Mar 2003) | 4 lines

Merging VERS5 into head. Wahoo!!!

jeff

------------------------------------------------------------------------
r626 | karp | 2003-01-20 21:59:35 -0500 (Mon, 20 Jan 2003) | 3 lines

An extensive rewrite. Attempted to incorporate Jeff's remarks on the
first draft.

------------------------------------------------------------------------
r619 | owamp | 2003-01-02 14:27:05 -0500 (Thu, 02 Jan 2003) | 2 lines

Initial import.

------------------------------------------------------------------------
r618 | karp | 2002-12-23 09:02:56 -0500 (Mon, 23 Dec 2002) | 4 lines

In last check in I accidentally removed code which was skipping
records with bad precision. This resulted in these records ruining
declared precsion of the plots. Putting the deleted code back in now.

------------------------------------------------------------------------
r617 | karp | 2002-12-20 15:25:52 -0500 (Fri, 20 Dec 2002) | 2 lines

Call owdigest with syslog reporting.

------------------------------------------------------------------------
r616 | karp | 2002-12-20 15:03:41 -0500 (Fri, 20 Dec 2002) | 4 lines

Added syslog support. Issue a warning if the count of 'sent'
records in a session is 0, and provide the highest number
of precision bits in a session for diagnostics.

------------------------------------------------------------------------
r615 | karp | 2002-12-09 13:37:17 -0500 (Mon, 09 Dec 2002) | 2 lines

First cut at the exponential RNG part of the spec.

------------------------------------------------------------------------
r614 | karp | 2002-12-09 13:14:01 -0500 (Mon, 09 Dec 2002) | 5 lines

Program 'vector' computes a million members of the
exponential sequence with a fixed seed, and prints out
the last one.  It can be used by future implementors of
OWAMP to verify correctness of the exponential RNG.

------------------------------------------------------------------------
r613 | boote | 2002-11-27 14:38:24 -0500 (Wed, 27 Nov 2002) | 5 lines

copying ugly but effective hack from collector that removes the dependence on
a working sigsuspend function.

jeff

------------------------------------------------------------------------
r612 | boote | 2002-11-27 14:31:41 -0500 (Wed, 27 Nov 2002) | 4 lines

kill's don't seem to be reliably delivered. This change will ensure delivery.

jeff

------------------------------------------------------------------------
r611 | boote | 2002-11-27 14:25:18 -0500 (Wed, 27 Nov 2002) | 4 lines

improve error detection in perl evals of "kill".

jeff

------------------------------------------------------------------------
r610 | boote | 2002-11-27 13:58:35 -0500 (Wed, 27 Nov 2002) | 4 lines

kill's now happen inside eval to ensure they are "caught" in the perl way...

jeff

------------------------------------------------------------------------
r609 | owamp | 2002-11-27 13:39:44 -0500 (Wed, 27 Nov 2002) | 4 lines

Oops - accidentily checked in a debugging error message yesterday.

jeff

------------------------------------------------------------------------
r608 | boote | 2002-11-27 13:34:48 -0500 (Wed, 27 Nov 2002) | 4 lines

Fix -T error.

jeff

------------------------------------------------------------------------
r607 | karp | 2002-11-27 11:29:22 -0500 (Wed, 27 Nov 2002) | 2 lines

Added debug checks for merge.

------------------------------------------------------------------------
r606 | boote | 2002-11-26 16:26:53 -0500 (Tue, 26 Nov 2002) | 8 lines

Adding check for sa_len. FreeBSD getaddrinfo/getnameinfo functions don't work
properly if you don't set this value, even though it is a non-standard
sockaddr member. Sigh.

(This *might* be the cause of the "bind" errors, but I'm not sure yet.)

jeff

------------------------------------------------------------------------
r605 | boote | 2002-11-26 14:19:18 -0500 (Tue, 26 Nov 2002) | 4 lines

added gai error messages.

jeff

------------------------------------------------------------------------
r604 | boote | 2002-11-26 13:23:07 -0500 (Tue, 26 Nov 2002) | 5 lines

Adding more detailed error reporting - removing "connect" of recv udp socket.
Added socket compare function into I2Util.

jeff

------------------------------------------------------------------------
r603 | boote | 2002-11-25 20:28:39 -0500 (Mon, 25 Nov 2002) | 4 lines

Corrected error reporting...

jeff

------------------------------------------------------------------------
r602 | boote | 2002-11-25 20:09:38 -0500 (Mon, 25 Nov 2002) | 4 lines

Improve error reporting.

jeff

------------------------------------------------------------------------
r601 | karp | 2002-11-19 16:49:58 -0500 (Tue, 19 Nov 2002) | 2 lines

Undo the last change.

------------------------------------------------------------------------
r600 | karp | 2002-11-19 16:02:02 -0500 (Tue, 19 Nov 2002) | 2 lines

Fix to have owmesh.conf installed.

------------------------------------------------------------------------
r599 | karp | 2002-11-17 19:22:03 -0500 (Sun, 17 Nov 2002) | 2 lines

Fixed warnings due to use strict

------------------------------------------------------------------------
r598 | karp | 2002-11-17 18:46:54 -0500 (Sun, 17 Nov 2002) | 2 lines

Added timeout value of 10 sec for flock

------------------------------------------------------------------------
r597 | karp | 2002-11-17 04:07:23 -0500 (Sun, 17 Nov 2002) | 2 lines

Fixed a bug in computing summary period.

------------------------------------------------------------------------
r596 | karp | 2002-11-15 14:27:37 -0500 (Fri, 15 Nov 2002) | 2 lines

Eliminated bulky Math::BigInt ops from time calculations.

------------------------------------------------------------------------
r595 | karp | 2002-11-12 15:06:23 -0500 (Tue, 12 Nov 2002) | 3 lines

Switch to double float to represent min delay in seconds
rather than play cast games with signed int's.

------------------------------------------------------------------------
r594 | karp | 2002-11-11 13:31:02 -0500 (Mon, 11 Nov 2002) | 4 lines

Fixed the bucket scheme (scary stuff - I am going to make sure
that the scheme is consistent across varios scripts/modules
to prevent this from happening again)

------------------------------------------------------------------------
r593 | karp | 2002-11-09 20:46:29 -0500 (Sat, 09 Nov 2002) | 2 lines

More little fixes.

------------------------------------------------------------------------
r592 | karp | 2002-11-09 18:25:46 -0500 (Sat, 09 Nov 2002) | 2 lines

Another negative-realated bug fixed.

------------------------------------------------------------------------
r591 | karp | 2002-11-09 17:54:57 -0500 (Sat, 09 Nov 2002) | 2 lines

Fixed bug with negative min.

------------------------------------------------------------------------
r590 | karp | 2002-11-09 17:24:56 -0500 (Sat, 09 Nov 2002) | 2 lines

Fixed bug with negative min delays.

------------------------------------------------------------------------
r589 | karp | 2002-11-08 17:38:04 -0500 (Fri, 08 Nov 2002) | 2 lines

Added archiving png files, and error bounds for plot legends.

------------------------------------------------------------------------
r588 | karp | 2002-11-08 13:29:21 -0500 (Fri, 08 Nov 2002) | 2 lines

Added proper error values into digest files.

------------------------------------------------------------------------
r587 | owamp | 2002-11-07 20:43:50 -0500 (Thu, 07 Nov 2002) | 4 lines

need to put this somewhere else - but I'm putting it here for now.

jeff

------------------------------------------------------------------------
r586 | owamp | 2002-11-07 20:38:30 -0500 (Thu, 07 Nov 2002) | 4 lines

pid files need to be opened "trunc".

jeff

------------------------------------------------------------------------
r585 | owamp | 2002-11-07 20:04:37 -0500 (Thu, 07 Nov 2002) | 4 lines

scripts should exit with 0 exit status if they succeeded in sending sigs.

jeff

------------------------------------------------------------------------
r584 | boote | 2002-11-07 19:36:12 -0500 (Thu, 07 Nov 2002) | 2 lines

Now it will even compile back on freebsd...

------------------------------------------------------------------------
r583 | owamp | 2002-11-07 19:27:22 -0500 (Thu, 07 Nov 2002) | 4 lines

fix for linux fseeko brain-damage...

jeff

------------------------------------------------------------------------
r582 | owamp | 2002-11-07 19:16:35 -0500 (Thu, 07 Nov 2002) | 5 lines

Port back to linux again... Ugh, you wouldn't think you would have to touch
so many files.

jeff

------------------------------------------------------------------------
r581 | owamp | 2002-11-07 17:20:17 -0500 (Thu, 07 Nov 2002) | 4 lines

Corrected print->warn statement.

jeff

------------------------------------------------------------------------
r580 | karp | 2002-11-07 17:14:18 -0500 (Thu, 07 Nov 2002) | 2 lines

Fixed a typo

------------------------------------------------------------------------
r579 | boote | 2002-11-07 17:03:58 -0500 (Thu, 07 Nov 2002) | 10 lines

Added setuid capabilities. The scripts will refuse to run as root. They
will set their permissions to another uid if UserName is set in the config
file.

Also added the -h/-k flags. -h will send HUP to an existing powmaster/collector
and -k will send TERM. This will make rc scripts trivial. The only things
needed in the rc script are the config file and the path to the executable.

jeff

------------------------------------------------------------------------
r578 | boote | 2002-11-06 20:02:38 -0500 (Wed, 06 Nov 2002) | 9 lines

owmesh.conf:
	Adding UserName/GroupName. I'm using these to setuid the
	powmaster/collector scripts. Although that didn't make this check-in.

powmaster.pl:
	Adding -e option to call of powstream to set syslog facility.

jeff

------------------------------------------------------------------------
r577 | boote | 2002-11-06 20:00:42 -0500 (Wed, 06 Nov 2002) | 6 lines

Example owampd.conf.

Don't expect this to work for you... You will need to edit it.

jeff

------------------------------------------------------------------------
r576 | boote | 2002-11-06 19:53:09 -0500 (Wed, 06 Nov 2002) | 6 lines

Added syslog facility option.

Added -r (LOG_PERROR) option too.

jeff

------------------------------------------------------------------------
r575 | boote | 2002-11-06 19:51:45 -0500 (Wed, 06 Nov 2002) | 10 lines

Added setuid functionality.

Added syslog facility option.

Added a config file.

Hmm. sounds so simple when you put it that way.

jeff

------------------------------------------------------------------------
r574 | boote | 2002-11-06 19:48:22 -0500 (Wed, 06 Nov 2002) | 23 lines

api.c:
	Added sigaction to ignore SIGPIPE to ContextInitialize().

endpoint.c:
	Modified error messages to put a space after the ':' as per
	one of Stas's rare bugs.

	modified send->sendto so that ICMP errors can not disconnect our
	sockect.

	Explicitly added an ignore of SIGPIPE for the child procs.

	Better error handling in EndpointInitHook - actually kills of
	child proc if necessary.

io.c:
	Removed redundant I2Readn/I2Writen functions. These are in the
	I2Util library and should NOT be here.

	Corrected ReceiveBlocks function to handle short reads.

jeff

------------------------------------------------------------------------
r573 | boote | 2002-11-05 19:51:11 -0500 (Tue, 05 Nov 2002) | 5 lines

Fixed errors that occured during failure conditions. i.e. If the endpoint
can't Initialize, the control socket should not be closed!

jeff

------------------------------------------------------------------------
r572 | karp | 2002-11-05 18:14:39 -0500 (Tue, 05 Nov 2002) | 6 lines

Added conf var:

# Multiplier to represent "infinite delay" relative to the largest
# non-infinite value
INF_DELAY_MULT  1.1

------------------------------------------------------------------------
r571 | karp | 2002-11-05 18:13:31 -0500 (Tue, 05 Nov 2002) | 2 lines

Added proper plotting of "infinities".

------------------------------------------------------------------------
r570 | karp | 2002-11-05 13:07:48 -0500 (Tue, 05 Nov 2002) | 2 lines

Keep significant digits in min for plotting.

------------------------------------------------------------------------
r569 | karp | 2002-11-05 12:18:07 -0500 (Tue, 05 Nov 2002) | 2 lines

Changed fine region bucket width down to 0.01ms

------------------------------------------------------------------------
r568 | karp | 2002-11-04 17:53:34 -0500 (Mon, 04 Nov 2002) | 2 lines

Fixed 24-hour plots.

------------------------------------------------------------------------
r567 | karp | 2002-11-04 12:33:50 -0500 (Mon, 04 Nov 2002) | 3 lines

Treat lost packets as having "infinite" delay for percentile
calculations.

------------------------------------------------------------------------
r566 | karp | 2002-11-01 20:16:37 -0500 (Fri, 01 Nov 2002) | 2 lines

Changed tick labels on 30-sce res

------------------------------------------------------------------------
r565 | karp | 2002-11-01 20:16:16 -0500 (Fri, 01 Nov 2002) | 2 lines

Added locking to datafile being plotted.

------------------------------------------------------------------------
r564 | karp | 2002-11-01 18:21:54 -0500 (Fri, 01 Nov 2002) | 2 lines

Fixed use of syslog.

------------------------------------------------------------------------
r563 | karp | 2002-11-01 18:06:48 -0500 (Fri, 01 Nov 2002) | 2 lines

Fixed tiny bug

------------------------------------------------------------------------
r562 | karp | 2002-11-01 18:03:23 -0500 (Fri, 01 Nov 2002) | 2 lines

Misc fixes and improvements.

------------------------------------------------------------------------
r561 | karp | 2002-11-01 17:37:24 -0500 (Fri, 01 Nov 2002) | 2 lines

Incorporate make_top_html.pl into crontab

------------------------------------------------------------------------
r560 | karp | 2002-11-01 14:45:53 -0500 (Fri, 01 Nov 2002) | 2 lines

Optimized percentile calculation.

------------------------------------------------------------------------
r559 | karp | 2002-10-31 19:11:18 -0500 (Thu, 31 Oct 2002) | 2 lines

Added vertical space betweeb tables.

------------------------------------------------------------------------
r558 | karp | 2002-10-31 17:41:49 -0500 (Thu, 31 Oct 2002) | 2 lines

Fixed to properly interact with buckets2stats

------------------------------------------------------------------------
r557 | karp | 2002-10-31 17:17:59 -0500 (Thu, 31 Oct 2002) | 2 lines

Cleaned up debugging remains

------------------------------------------------------------------------
r556 | karp | 2002-10-31 16:50:17 -0500 (Thu, 31 Oct 2002) | 2 lines

Add SUMMARY_PERIOD var (currently at 300)

------------------------------------------------------------------------
r555 | karp | 2002-10-31 16:49:28 -0500 (Thu, 31 Oct 2002) | 3 lines

Prepare the summary file by computing medians and loss over the last
SUMMARY_PERIOD (new conf var) and choosing the worst.

------------------------------------------------------------------------
r554 | owamp | 2002-10-31 10:25:08 -0500 (Thu, 31 Oct 2002) | 4 lines

buckets2stats.pl: oops syntax error in my print->warn change.

collector.pl: modified verbose output.

------------------------------------------------------------------------
r553 | owamp | 2002-10-30 23:53:15 -0500 (Wed, 30 Oct 2002) | 9 lines

buckets2stats.pl: just changed some print messages to warn's so they go to
syslog.

collector.pl: added a verbose warn message.

Conf.pm: added an Achive var.

jeff

------------------------------------------------------------------------
r552 | owamp | 2002-10-30 22:55:38 -0500 (Wed, 30 Oct 2002) | 4 lines

Adding verbose message for VALIDTIMES update.

jeff

------------------------------------------------------------------------
r551 | karp | 2002-10-30 18:08:47 -0500 (Wed, 30 Oct 2002) | 2 lines

Cosmetic clean-up before substantial changes.

------------------------------------------------------------------------
r550 | karp | 2002-10-30 12:53:16 -0500 (Wed, 30 Oct 2002) | 2 lines

Forgot OWP::Syslog

------------------------------------------------------------------------
r549 | karp | 2002-10-30 12:47:57 -0500 (Wed, 30 Oct 2002) | 2 lines

Added syslog reporting.

------------------------------------------------------------------------
r548 | karp | 2002-10-30 12:39:40 -0500 (Wed, 30 Oct 2002) | 2 lines

Remove use Posix

------------------------------------------------------------------------
r547 | karp | 2002-10-30 12:26:56 -0500 (Wed, 30 Oct 2002) | 2 lines

Remove use Posix

------------------------------------------------------------------------
r546 | owamp | 2002-10-30 11:55:24 -0500 (Wed, 30 Oct 2002) | 4 lines

Added better error messages for a closed socket.

jeff

------------------------------------------------------------------------
r545 | owamp | 2002-10-30 11:35:47 -0500 (Wed, 30 Oct 2002) | 4 lines

Added $verbose messages.

jeff

------------------------------------------------------------------------
r544 | karp | 2002-10-30 11:28:45 -0500 (Wed, 30 Oct 2002) | 2 lines

Redirect stdout and stderr to /dev/null

------------------------------------------------------------------------
r543 | owamp | 2002-10-30 11:17:39 -0500 (Wed, 30 Oct 2002) | 4 lines

Added missing address for udp uptime sends to central host.

jeff

------------------------------------------------------------------------
r542 | karp | 2002-10-30 11:07:14 -0500 (Wed, 30 Oct 2002) | 2 lines

Fixed perl path and closed GNUPLOT handle explicitly.

------------------------------------------------------------------------
r541 | owamp | 2002-10-29 18:48:34 -0500 (Tue, 29 Oct 2002) | 4 lines

modified collector/powmaster to use node names for dir names.

jeff

------------------------------------------------------------------------
r540 | karp | 2002-10-29 17:53:48 -0500 (Tue, 29 Oct 2002) | 2 lines

Corrected some timing bugs.

------------------------------------------------------------------------
r539 | owamp | 2002-10-29 17:14:30 -0500 (Tue, 29 Oct 2002) | 4 lines

remove extra dirs from building - send/recv identical should not happen.

jeff

------------------------------------------------------------------------
r538 | owamp | 2002-10-29 16:40:00 -0500 (Tue, 29 Oct 2002) | 2 lines

fix syntax error. ugh.

------------------------------------------------------------------------
r537 | owamp | 2002-10-29 11:29:07 -0500 (Tue, 29 Oct 2002) | 4 lines

Removed commented out code.

jeff

------------------------------------------------------------------------
r536 | owamp | 2002-10-29 11:17:33 -0500 (Tue, 29 Oct 2002) | 4 lines

fix uninitialized var - only happened if you DON't set -n...

jeff

------------------------------------------------------------------------
r535 | boote | 2002-10-29 02:59:05 -0500 (Tue, 29 Oct 2002) | 6 lines

I have had the distinct misfortoune if discovering that SIGCHLD can
be received during a kill call for that child, even if sigprocmask
has SIGCHLD blocked...

jeff

------------------------------------------------------------------------
r534 | boote | 2002-10-28 16:33:31 -0500 (Mon, 28 Oct 2002) | 4 lines

owampd now uses syslog.

jeff

------------------------------------------------------------------------
r533 | owamp | 2002-10-28 14:22:55 -0500 (Mon, 28 Oct 2002) | 4 lines

Fix DEFS and removed ref to CentralUploadDir.

jeff

------------------------------------------------------------------------
r532 | owamp | 2002-10-28 14:02:06 -0500 (Mon, 28 Oct 2002) | 4 lines

Linux/upgraded perl fixes.

jeff

------------------------------------------------------------------------
r531 | boote | 2002-10-27 04:57:50 -0500 (Sun, 27 Oct 2002) | 9 lines

Modified collector/powmaster to be daemons unless Debug is set in the
config file, or -f is passed on the command line. (-f: foreground)

Modified the reentrant fix from before so that it is fixed in
Syslog.pm itself. This is better since it is more self-containted,
and it actually works. The other fix didn't. Ugh.

jeff

------------------------------------------------------------------------
r530 | boote | 2002-10-26 18:44:17 -0400 (Sat, 26 Oct 2002) | 4 lines

forget to protect one of the sub-proc sig handlers.

jeff

------------------------------------------------------------------------
r529 | boote | 2002-10-26 18:40:16 -0400 (Sat, 26 Oct 2002) | 7 lines

FINALLY FIGURED OUT THE DAMN SIGNAL PROBLEM!!!!!

Because "die" is tied to syslog - die has become nonreentrant. I have added
a semaphore to the signal handlers to compensate.

jeff

------------------------------------------------------------------------
r528 | boote | 2002-10-25 19:56:10 -0400 (Fri, 25 Oct 2002) | 10 lines

Reworked the sig stuff yet again... It is "a little" more simple now.

powmaster now sends a HUP to powstream's that need to reinitialize their test
due to another node restarting.

powstream.c had a bug in that it didn't properly check the "status" of all
the recv children.

jeff

------------------------------------------------------------------------
r527 | karp | 2002-10-25 19:29:47 -0400 (Fri, 25 Oct 2002) | 2 lines

Minor fix

------------------------------------------------------------------------
r526 | karp | 2002-10-25 19:15:59 -0400 (Fri, 25 Oct 2002) | 2 lines

Updated change to OwampdVarDir

------------------------------------------------------------------------
r525 | karp | 2002-10-25 18:41:57 -0400 (Fri, 25 Oct 2002) | 2 lines

Added missing OWP/\*.pm files

------------------------------------------------------------------------
r524 | karp | 2002-10-25 18:39:32 -0400 (Fri, 25 Oct 2002) | 2 lines

Added OWP/Makefile support

------------------------------------------------------------------------
r523 | karp | 2002-10-25 18:35:24 -0400 (Fri, 25 Oct 2002) | 2 lines

Added scripts/OWP/Makefile

------------------------------------------------------------------------
r522 | karp | 2002-10-25 15:36:19 -0400 (Fri, 25 Oct 2002) | 2 lines

Set up scripts to be install along with owamp binaries.

------------------------------------------------------------------------
r521 | boote | 2002-10-24 19:03:35 -0400 (Thu, 24 Oct 2002) | 4 lines

Fixed a problem with send/recv children being zombied.

jeff

------------------------------------------------------------------------
r520 | boote | 2002-10-24 03:44:19 -0400 (Thu, 24 Oct 2002) | 24 lines

Full functionality seems to be working now. valid_time files are being
updated and everything.

The only thing I think might be useful to add now would be to make these
scripts be daemons, and write to a pid file so rc scripts can access them
more easily.

(I'm going to sleep in tomorrow, but then I would like to try and install
using the owamp user-id, and see how it goes.)

jeff

OWP.pm:
	corrected bug in validsessions function - 0 length array was
	messing things up.
collector.pl:
	Removed GDBM_File and replaced with DB_File. This allows
	locking to work correctly. GDBM_File was giving me fits - this
	may have actually been part of my signal problems before.
owmesh.conf:
	replace gdbm with db in file extensions.
powmaster.pl:
	Removed GDBM_File.

------------------------------------------------------------------------
r519 | boote | 2002-10-23 20:21:10 -0400 (Wed, 23 Oct 2002) | 24 lines

OWP.pm:
	fixed logic of valid_session to not delete the last "uptime" pair.

collector.pl:
	LOTS of additions for uptimewatch capability.
	(doesn't yet delete files - but it does update per/dir database.)
	LOTS of changes to enhance signal support.

owmesh.conf:
	addition of udpmessage length.

powmaster.pl:
	added syslog support
	enhanced signal support

RawIO.pm:
	simplified signal support.

Syslog.pm:
	removed duplicate printing to stderr.
	added initial syslog opened message...

jeff

------------------------------------------------------------------------
r518 | karp | 2002-10-22 17:54:48 -0400 (Tue, 22 Oct 2002) | 2 lines

Clean-up of html and gnuplot code

------------------------------------------------------------------------
r517 | boote | 2002-10-22 03:47:10 -0400 (Tue, 22 Oct 2002) | 6 lines

I moved the live_update functionality into the powmaster script. I think it
will make things much easier if there is just the two applications to run
directly on the node... owampd and powmaster.

jeff

------------------------------------------------------------------------
r516 | boote | 2002-10-22 01:33:19 -0400 (Tue, 22 Oct 2002) | 8 lines

Modified format of owampd.info file to contain both the pid and the
starttime. This way scripts can be sure the starttime is for the given
pid - owampd creates the file with an atomic "rename" operation.

The previous method introduced a race condition.

jeff

------------------------------------------------------------------------
r515 | boote | 2002-10-21 12:57:36 -0400 (Mon, 21 Oct 2002) | 4 lines

Better error message for closed socket.

jeff

------------------------------------------------------------------------
r514 | karp | 2002-10-18 19:11:04 -0400 (Fri, 18 Oct 2002) | 2 lines

Added support for scripts directory Makefile

------------------------------------------------------------------------
r513 | karp | 2002-10-18 19:08:52 -0400 (Fri, 18 Oct 2002) | 5 lines

Initial import.

owampd.sh.in is used as a template for owampd.sh script - to
be placed in /usr/local/etc/rc.d

------------------------------------------------------------------------
r512 | boote | 2002-10-18 18:59:18 -0400 (Fri, 18 Oct 2002) | 7 lines

Oops. Forgot to delete the session file after archiving and digesting.

(My filesystem was getting very large... I've been running this most of
the day.)

jeff

------------------------------------------------------------------------
r511 | boote | 2002-10-18 18:49:10 -0400 (Fri, 18 Oct 2002) | 8 lines

powmaster -> collector file transfers seem to be working.
collector digesting also seems to be working.

Still need to add "validation" to data using uptimewatch. (uptimewatch doesn't currently use the same setup as
collector, so it needs to be modified.)

jeff

------------------------------------------------------------------------
r510 | karp | 2002-10-17 19:19:13 -0400 (Thu, 17 Oct 2002) | 3 lines

Check-point - still need to work out how to initialize $conf
(specify NODE).

------------------------------------------------------------------------
r509 | karp | 2002-10-17 19:17:52 -0400 (Thu, 17 Oct 2002) | 2 lines

Added SEPARATOR conf var.

------------------------------------------------------------------------
r508 | karp | 2002-10-17 19:16:12 -0400 (Thu, 17 Oct 2002) | 2 lines

Improved robustness. Factored out repeated code (fetching starttime/pid).

------------------------------------------------------------------------
r507 | boote | 2002-10-17 19:15:28 -0400 (Thu, 17 Oct 2002) | 5 lines

Only checking in for the example on setting the "NODE" - doesn't work right
 now...

jeff

------------------------------------------------------------------------
r506 | karp | 2002-10-17 19:13:27 -0400 (Thu, 17 Oct 2002) | 2 lines

Minor cosmetic fixes.

------------------------------------------------------------------------
r505 | karp | 2002-10-17 16:48:33 -0400 (Thu, 17 Oct 2002) | 2 lines

Fix split to parse messages properly.

------------------------------------------------------------------------
r504 | karp | 2002-10-17 15:23:51 -0400 (Thu, 17 Oct 2002) | 8 lines

Initial import.

# This sub merges digest files @files into a new digest file $newname.
sub merge {
	my ($newname, @files) = @_;
...
}

------------------------------------------------------------------------
r503 | karp | 2002-10-16 18:58:58 -0400 (Wed, 16 Oct 2002) | 2 lines

Fixed losThre default to be 10

------------------------------------------------------------------------
r502 | karp | 2002-10-16 18:58:18 -0400 (Wed, 16 Oct 2002) | 2 lines

Converted command-line options to match the style of owping.

------------------------------------------------------------------------
r501 | karp | 2002-10-16 13:20:16 -0400 (Wed, 16 Oct 2002) | 7 lines

Initial commit.

# This script creates crontab file to run buckets2stats.pl at the right
# frequencies. Default name for the output file is "crontab".

# usage: makecron.pl [crontab_out_file]

------------------------------------------------------------------------
r500 | karp | 2002-10-16 11:46:48 -0400 (Wed, 16 Oct 2002) | 2 lines

Fixed inconsistent sub names.

------------------------------------------------------------------------
r499 | karp | 2002-10-15 18:30:57 -0400 (Tue, 15 Oct 2002) | 2 lines

Removed autoscaling of x-axis

------------------------------------------------------------------------
r498 | karp | 2002-10-15 18:29:57 -0400 (Tue, 15 Oct 2002) | 2 lines

Changed code so as to make it easy to color links as needed.

------------------------------------------------------------------------
r497 | karp | 2002-10-15 11:06:58 -0400 (Tue, 15 Oct 2002) | 3 lines

Revamped the whole graph-plotting part. Added PLOT_FMT variable
to owmesh.conf to control time units in plot titles.

------------------------------------------------------------------------
r496 | boote | 2002-10-11 00:32:22 -0400 (Fri, 11 Oct 2002) | 5 lines

check-point of collector script.


jeff

------------------------------------------------------------------------
r495 | boote | 2002-10-10 18:39:38 -0400 (Thu, 10 Oct 2002) | 12 lines

checkpointing mostly... long weekend.

endpoint.c:	removed some debugging print statements to fix some
		of Stas's "rare bugs".

owamp.h:	changed the default port.

all the scripts...
	Added stuff that isn't complete yet...

jeff

------------------------------------------------------------------------
r494 | karp | 2002-10-09 16:38:41 -0400 (Wed, 09 Oct 2002) | 3 lines

Constructing plots of (min, median, 90th percentile) and
basic web-pages for every link in the mesh.

------------------------------------------------------------------------
r493 | karp | 2002-10-09 16:35:12 -0400 (Wed, 09 Oct 2002) | 2 lines

Added PLOT_PERIOD_NAME attribute to be used in graph titles.

------------------------------------------------------------------------
r492 | boote | 2002-10-09 15:52:06 -0400 (Wed, 09 Oct 2002) | 5 lines

Fixed small bug in the __DIE__ handler... Need to call die instead of
returning from it.

jeff

------------------------------------------------------------------------
r491 | boote | 2002-10-09 14:57:14 -0400 (Wed, 09 Oct 2002) | 8 lines

Added a module to allow you to tie a fh to syslog. Also allows you to send
die/warn messages to syslog as well. It is based upon Tie::Syslog but
there were a few changes I needed to make to use it. (The die/warn
handle mechanism only worked for STDERR.)  I also modified the arg parsing
to use named args.)

jeff

------------------------------------------------------------------------
r490 | karp | 2002-10-08 19:53:58 -0400 (Tue, 08 Oct 2002) | 2 lines

Added CentralWWWDir attribute

------------------------------------------------------------------------
r489 | karp | 2002-10-08 19:51:53 -0400 (Tue, 08 Oct 2002) | 2 lines

Cleaned up to make use of the new path functions.

------------------------------------------------------------------------
r488 | karp | 2002-10-08 19:50:34 -0400 (Tue, 08 Oct 2002) | 3 lines

Add auxiliary functions for quick construction of key paths
from conf variables.

------------------------------------------------------------------------
r487 | karp | 2002-10-08 19:39:47 -0400 (Tue, 08 Oct 2002) | 2 lines

Tiny - forgot to add usage.

------------------------------------------------------------------------
r486 | karp | 2002-10-08 19:38:41 -0400 (Tue, 08 Oct 2002) | 3 lines

Initial import. Builds directories and constructs some small
pages (these are already properly linked in from the top page)

------------------------------------------------------------------------
r485 | karp | 2002-10-08 19:36:01 -0400 (Tue, 08 Oct 2002) | 3 lines

Construct tables with proper relative links (currently using
just median, will add more stats)

------------------------------------------------------------------------
r484 | karp | 2002-10-07 17:48:30 -0400 (Mon, 07 Oct 2002) | 2 lines

Got working template for contruction of the top level html page.

------------------------------------------------------------------------
r483 | boote | 2002-10-05 14:28:24 -0400 (Sat, 05 Oct 2002) | 18 lines

owamp/capi.c:
	Fixed a bug. Error condition was reported fatal, when it should
	have been able to continue. (It wasn't looping through all possible
	addrinfo structs to find a match because of this. It was failing
	on the first bad one.)

powmaster.pl:
	Better signal handling.
	fixed a bug (array passed in first value instead of array ref
		for the mkpath command.)
	fixed another bug... Needed to "dup" the write side of the pipe
		to ensure all powstreams can write to it.
Conf.pm:
	Removed DEBUG/VERBOSE from the defaults. (undef should be the default
	value - putting them here made 0 the default...)

jeff

------------------------------------------------------------------------
r482 | boote | 2002-10-04 20:11:24 -0400 (Fri, 04 Oct 2002) | 7 lines

powmaster.pl:
	manages powstream ok now - has a send_data process that is event
	driven. (It wakes up whenever there is more data to be sent to
	the central-server.)

jeff

------------------------------------------------------------------------
r481 | karp | 2002-10-04 18:41:19 -0400 (Fri, 04 Oct 2002) | 2 lines

Cleaned up and plugged in all conf variables.

------------------------------------------------------------------------
r480 | boote | 2002-10-04 18:07:34 -0400 (Fri, 04 Oct 2002) | 12 lines

powstream:
	Added -p option: causes it to print the filenames it creates
	on stdout.
owmesh.conf:
	Added DevNull
Conf.pm:
	Fixed undefined var problem.
powmaster.pl:
	Script to "manage" all powstream receivers on a node.

jeff

------------------------------------------------------------------------
r479 | karp | 2002-10-04 16:39:43 -0400 (Fri, 04 Oct 2002) | 2 lines

Added OWP::Utils.pm

------------------------------------------------------------------------
r478 | karp | 2002-10-04 16:38:41 -0400 (Fri, 04 Oct 2002) | 11 lines

At this point the script is geared towards being called
from crontab still (this may change).

# This script accepts a resolution, fetches look-back period,
# and constructs plots for all node pairs. The resolution itself
# and its associated attributes MUST be defined in the config
# file so that they can be fetched. Resulting plots are placed
# under $conf->{'CENTRALWWWDIR'}

# usage: buckets2stats.pl <resolution>

------------------------------------------------------------------------
r477 | boote | 2002-10-03 18:23:33 -0400 (Thu, 03 Oct 2002) | 4 lines

Added env var and homedir parsing for the "path" config options.

jeff

------------------------------------------------------------------------
r476 | boote | 2002-10-03 17:45:22 -0400 (Thu, 03 Oct 2002) | 11 lines

owmesh.conf:
	Added vars needed by powmaster.pl

testconf.pl:
	Added test of must_get_val method.
Conf.pm:
	Changed how values are returned. More use of perl references to
	avoid copying data until needed.

jeff

------------------------------------------------------------------------
r475 | boote | 2002-10-03 15:36:36 -0400 (Thu, 03 Oct 2002) | 7 lines

powsteam: added powstream specific cmdline args to usage().

owmesh.conf: Oops - I had commented something out in the pervious version
		that was needed.

jeff

------------------------------------------------------------------------
r474 | boote | 2002-10-03 14:38:20 -0400 (Thu, 03 Oct 2002) | 19 lines

Tolya - I reset a bunch of the parameters to more "global" defaults. If
you want them to keep their current values for you, you need to start
using the OWPCONF env var to set another config file that will be read
after the default one. (Let me know if you want to see mine to give
you an idea of what I mean.)

Also - take a look at the new must_get_val method for Conf  - it will
automatically die and report an error if the ATTR can't be retrieved.

powstream:
	Made the "real" session file use tempfile functionality to
	create filenames. (This makes debugging easier if I remove the
	unlink temporarily.)
owmesh.conf:
	Made many of the config params closer to what they will "really" be.
Conf.pm:
	Added a "must_get_val" method that "die's" if the ATTR can't
	be retrieved.

------------------------------------------------------------------------
r472 | boote | 2002-10-03 10:46:48 -0400 (Thu, 03 Oct 2002) | 7 lines

Added descriptions in README for a few directories.

decisions:
	Removed decisions we later changed our minds on.

jeff

------------------------------------------------------------------------
r471 | karp | 2002-10-02 17:44:00 -0400 (Wed, 02 Oct 2002) | 3 lines

Minor fix - will figure out proper sub exporting from OWP::Utils later
but this works for now (explicitly calling a sub by full name)

------------------------------------------------------------------------
r470 | karp | 2002-10-02 17:39:59 -0400 (Wed, 02 Oct 2002) | 4 lines

Initial import.

Separated out some common code using Math::BigInt.

------------------------------------------------------------------------
r469 | karp | 2002-10-02 17:25:59 -0400 (Wed, 02 Oct 2002) | 10 lines

Graphing is basically done. Usage now is:

buckets2stats.pl <dirname> <age_in_hours>

so calling the script on the right directory should do the trick
(assuming we do keep different resolutions in separate directories).

Little details may still need some ironing out but main
functionality seems to be there.

------------------------------------------------------------------------
r468 | karp | 2002-10-02 14:20:32 -0400 (Wed, 02 Oct 2002) | 8 lines

Initial import.

# Read bucket count files, construct time series stats and plot them.
# usage: buckets2stats.pl <dirname> <age_in_hours>

Currently constructs gnuplot data file but doesn't plot it yet -
need to figure out a decent way to do x-axis ticks.

------------------------------------------------------------------------
r467 | boote | 2002-10-02 12:24:19 -0400 (Wed, 02 Oct 2002) | 4 lines

fixed get_val to tr/a-z/A-Z all ATTR values.

jeff

------------------------------------------------------------------------
r466 | boote | 2002-10-02 12:06:17 -0400 (Wed, 02 Oct 2002) | 4 lines

added $conf->dump.

jeff

------------------------------------------------------------------------
r465 | karp | 2002-10-02 11:17:06 -0400 (Wed, 02 Oct 2002) | 2 lines

Include min delay into digest files.

------------------------------------------------------------------------
r464 | karp | 2002-10-01 19:40:33 -0400 (Tue, 01 Oct 2002) | 8 lines

Initial import.

# Create a histogram of bucket counts from a digest file.
# usage: cookbuckets.pl <filename>

May or may not end up using it but I thought I'd check it in
before I forget about its existence.

------------------------------------------------------------------------
r463 | karp | 2002-10-01 19:36:28 -0400 (Tue, 01 Oct 2002) | 2 lines

Use u_int32_t for bucket counts.

------------------------------------------------------------------------
r462 | boote | 2002-10-01 19:07:43 -0400 (Tue, 01 Oct 2002) | 9 lines

Added DIGESTRES stuff.

Tolya, take a look at the owmesh.conf file for an example. (I added a
commonname attribute to make it easier to make sense of those resolutions. I
also differentiated the period for the plotting from the period of "saving"
digest files.)

jeff

------------------------------------------------------------------------
r461 | boote | 2002-10-01 12:46:06 -0400 (Tue, 01 Oct 2002) | 11 lines

owmesh.conf:
	Added testing of variable reset, array append.

testconf.pl:
	Corrected full mesh test - next, not last in the loop.

Conf.pm:
	Added variable reset.

jeff

------------------------------------------------------------------------
r460 | boote | 2002-09-30 18:22:37 -0400 (Mon, 30 Sep 2002) | 16 lines

endpoint.c:
	Removed a nasty racecondition that was caused by my misunderstanding
	of how sigprocmask worked. I thought it would block even signals
	that were currently set to sig_ign, but I was wrong. Because of this
	I had to rearrange how the child sig_handlers were installed.
	(Basically, I had to install them in the parent, block the signals,
	then fork. After the fork, I reset the parents original handlers,
	and unblock the signals. The child unblocks signals and runs with
	the new sighandlers already installed by the parent.)

powstream.c:
	Added sig checking in the loop that tries to reestablish connection
	if the control connection is broken.

jeff

------------------------------------------------------------------------
r459 | boote | 2002-09-30 12:29:46 -0400 (Mon, 30 Sep 2002) | 5 lines

These files are automatically created and should not be part of the
distribution.

jeff

------------------------------------------------------------------------
r458 | boote | 2002-09-28 03:20:02 -0400 (Sat, 28 Sep 2002) | 15 lines

owmesh.conf:
	Has an example showing 3 nodes:
		CHIN,ATLA,IPLS
testconf.pl:
	Has a two full examples of using the node addresses.
	One is similar to the weathermap - it only deals with adj nodes.
	The other is does a full mesh of each "meshtype".

Conf.pm:
	Huge changes - believe it or not, I believe I managed to add
	functionality, while making the code more simple, and shorter.
	(Ok - some of it is pretty criptic, but it is perl after all...)

jeff

------------------------------------------------------------------------
r457 | karp | 2002-09-27 22:03:00 -0400 (Fri, 27 Sep 2002) | 6 lines

Initial import.

# This script sends time updates to a designated port on the central
# host and manages a persistent piece of data describing a fixed
# number of the last reboots.

------------------------------------------------------------------------
r456 | karp | 2002-09-27 19:26:36 -0400 (Fri, 27 Sep 2002) | 6 lines

Initial import.

# This script runs on the central host. It receives updates,
# removes discovered invalid data, and updates database of
# liveness intervals.

------------------------------------------------------------------------
r455 | boote | 2002-09-26 13:02:18 -0400 (Thu, 26 Sep 2002) | 4 lines

Fix arrays.

jeff

------------------------------------------------------------------------
r454 | boote | 2002-09-25 20:28:23 -0400 (Wed, 25 Sep 2002) | 5 lines

Modified to use the conf module, and to use the datadir/recv_addr/send_addr
dir structure on the node side as well.

jeff

------------------------------------------------------------------------
r453 | boote | 2002-09-25 20:27:41 -0400 (Wed, 25 Sep 2002) | 10 lines

Added karp specific defaults to the conf file for an example.

(They mimic what you had hard-coded in the nodemaster.pl script.)

BTW - the secret stuff is broken... You will need to comment them out of
the conf file, and just deal with the "default" one in the .pl script until
I can fix it tomorrow. Sorry.

jeff

------------------------------------------------------------------------
r452 | karp | 2002-09-25 15:29:56 -0400 (Wed, 25 Sep 2002) | 2 lines

Added more robustness..no reason to die if datadir not found

------------------------------------------------------------------------
r451 | karp | 2002-09-25 14:20:44 -0400 (Wed, 25 Sep 2002) | 2 lines

Another typo..sorry, didn't get around to test

------------------------------------------------------------------------
r450 | boote | 2002-09-25 13:44:01 -0400 (Wed, 25 Sep 2002) | 7 lines

testconf.pl:	fbsd perl path.
Conf.pm:
	Added error check for undefined $addr,
	Added documentation to header.

jeff

------------------------------------------------------------------------
r449 | boote | 2002-09-25 13:23:32 -0400 (Wed, 25 Sep 2002) | 5 lines

Removed a large section that I had commented out during development, but forgot
to remove.

jeff

------------------------------------------------------------------------
r448 | boote | 2002-09-25 13:18:29 -0400 (Wed, 25 Sep 2002) | 10 lines

initial OWP::Conf module. See the testconf.pl to see how it works.

It should pass in an Addr and optionally a configuration directory path.

(The testconf script uses the same directory as the testconf.pl for this.)

I have not modified nodemaster or anything to use this...

jeff

------------------------------------------------------------------------
r447 | karp | 2002-09-25 13:17:11 -0400 (Wed, 25 Sep 2002) | 2 lines

Fixed typo.

------------------------------------------------------------------------
r446 | karp | 2002-09-25 13:15:40 -0400 (Wed, 25 Sep 2002) | 5 lines

Removed hard-coded list of receiver directories - now
the script looks for them under the top_dir as appropriate.

Remove the use of 'ls' and replace it by opendir/readdir/closedir

------------------------------------------------------------------------
r445 | karp | 2002-09-25 13:10:28 -0400 (Wed, 25 Sep 2002) | 3 lines

Cleaned up owdigest, added 'verbose' option for debugging
(not set by default).. overall looks in good shape now.

------------------------------------------------------------------------
r444 | karp | 2002-09-24 20:32:53 -0400 (Tue, 24 Sep 2002) | 2 lines

Fixed the script and made it more robust.

------------------------------------------------------------------------
r443 | karp | 2002-09-24 13:39:00 -0400 (Tue, 24 Sep 2002) | 2 lines

Quick check-in for easier distribution between nodes

------------------------------------------------------------------------
r442 | boote | 2002-09-23 17:18:31 -0400 (Mon, 23 Sep 2002) | 5 lines

Added signal handling - SIGHUP now causes it to re-init control connections,
TERM and INT cause it to close the connections and exit.

jeff

------------------------------------------------------------------------
r441 | karp | 2002-09-23 15:03:09 -0400 (Mon, 23 Sep 2002) | 2 lines

Clean-up and better diagnostics

------------------------------------------------------------------------
r440 | boote | 2002-09-23 12:34:03 -0400 (Mon, 23 Sep 2002) | 4 lines

Added comments to test cvs.

jeff

------------------------------------------------------------------------
r439 | karp | 2002-09-23 10:55:38 -0400 (Mon, 23 Sep 2002) | 3 lines

Added logging liveness reports to a database. The script
also reads in the database contents on start-up.

------------------------------------------------------------------------
r438 | karp | 2002-09-23 10:50:05 -0400 (Mon, 23 Sep 2002) | 2 lines

Cosmetic changes (tiny).

------------------------------------------------------------------------
r437 | karp | 2002-09-21 04:03:27 -0400 (Sat, 21 Sep 2002) | 6 lines

Fixed a most evil bug - it only presented itself on linux and,
to this point I still can't see why I what I had before didn't work
(errors ranged from core dump to 'Bad mask' messages)
Anyway, a couple of small changes fixed it - and the code looks
slightly better too.

------------------------------------------------------------------------
r436 | boote | 2002-09-20 19:35:25 -0400 (Fri, 20 Sep 2002) | 4 lines

output lost packets.

jeff

------------------------------------------------------------------------
r435 | boote | 2002-09-20 16:26:47 -0400 (Fri, 20 Sep 2002) | 16 lines

Modified to use high 3 order bytes of frac_sec(32) instead of low order
bytes. Hopefully things are consistant now.

(Inconsistant use of this was causing packets to be sent before the start
time.)

also fixed a race condition in endpoint that happened if the endpoint proc
happen to exit after its status was queried, but before it was killed.

modified owping/owstats -V printout to use OWP_TSTAMPFMT.

(temporarily removed file-locking from powstream because restarts in
gdb don't free the locks. VERY ANNOYING!)

jeff

------------------------------------------------------------------------
r434 | karp | 2002-09-20 02:05:42 -0400 (Fri, 20 Sep 2002) | 4 lines

File validation and archiving are complete now.

--Tolya

------------------------------------------------------------------------
r433 | boote | 2002-09-20 00:35:06 -0400 (Fri, 20 Sep 2002) | 6 lines

new powstream basically works.

I need to add event handling. (cleanup on SIGINT,HUP,TERM)

jeff

------------------------------------------------------------------------
r432 | karp | 2002-09-19 19:32:06 -0400 (Thu, 19 Sep 2002) | 4 lines

Introduce reading of the start_time from owampd.info file
and sending/receving pairs <start, current>. Managing the
intervals gets a whole lot easier..

------------------------------------------------------------------------
r431 | boote | 2002-09-19 17:02:54 -0400 (Thu, 19 Sep 2002) | 5 lines

powstream compiles - but I have not tested at all yet. Gotta go, and wanted
to have this check-pointed before taking off.

jeff

------------------------------------------------------------------------
r430 | karp | 2002-09-19 15:23:31 -0400 (Thu, 19 Sep 2002) | 10 lines

Moved commonly used macros to owamp.h.

Have owampd write its pid and starttime to opts.confdir/owampd.pid
and opts.confdir/owampd.info respectively.

owampd keep read lock on owampd.pid to prevent a new incarnation
of owampd from messing either file up.

--Tolya

------------------------------------------------------------------------
r429 | boote | 2002-09-19 11:22:47 -0400 (Thu, 19 Sep 2002) | 4 lines

Changed to use new ParseRecords interface.

jeff

------------------------------------------------------------------------
r428 | boote | 2002-09-19 11:22:01 -0400 (Thu, 19 Sep 2002) | 16 lines

made ParseRecords slightly more upgradable since it will understand file
versions to some extent now. (It now takes a OWPDataHeader structure as
an arg.)

modified recv process significantly:
	- Will keep socket open until lossThresh after last packet to
	ensure that it gets good data on duplicates.
	- Removed optimization that ended test early if possible. This will
	not be a problem with v5 since the owping application will set
	a very small lossThresh by default.
	- Moved the relinking of .i files to StopSession function. This
	ensures the file only gets renamed if the session was accepted.
	(we were not compliant with the spec before.)

jeff

------------------------------------------------------------------------
r427 | boote | 2002-09-18 16:30:08 -0400 (Wed, 18 Sep 2002) | 4 lines

Modified owp file read/write functions to actually do something useful.

jeff

------------------------------------------------------------------------
r426 | karp | 2002-09-18 00:58:09 -0400 (Wed, 18 Sep 2002) | 3 lines

The script correctly notifies the central host about
current time now. Still need to add authentication.

------------------------------------------------------------------------
r425 | karp | 2002-09-18 00:50:13 -0400 (Wed, 18 Sep 2002) | 4 lines

Improved main loop. Script looks for .owp files and digests
them now. Added data structures to implemement validation
but some more work is needed.

------------------------------------------------------------------------
r424 | karp | 2002-09-17 12:16:56 -0400 (Tue, 17 Sep 2002) | 2 lines

Added mergesort/qsort work-around

------------------------------------------------------------------------
r423 | karp | 2002-09-17 02:10:07 -0400 (Tue, 17 Sep 2002) | 2 lines

Removing - added by mistake.

------------------------------------------------------------------------
r422 | karp | 2002-09-17 01:23:56 -0400 (Tue, 17 Sep 2002) | 14 lines

Moved owp_bits2prec(), and added

double
OWPPrecision(OWPDataRecPtr rec);

u_int8_t
OWPGetPrecBits(OWPDataRecPtr rec);

into the library - applications can use them but need not know
how they are implemented (implmentation will change when we move
to new precision format)

Added precision handling to owdigest.

------------------------------------------------------------------------
r421 | karp | 2002-09-17 01:17:05 -0400 (Tue, 17 Sep 2002) | 2 lines

Add owdigest to source list.

------------------------------------------------------------------------
r420 | karp | 2002-09-17 01:05:27 -0400 (Tue, 17 Sep 2002) | 2 lines

Initial commit. Skeleton of the script to run on the central host.

------------------------------------------------------------------------
r419 | karp | 2002-09-17 01:02:23 -0400 (Tue, 17 Sep 2002) | 2 lines

Periodically send current time (20-char ASCII string) to the central host.

------------------------------------------------------------------------
r418 | karp | 2002-09-16 16:04:01 -0400 (Mon, 16 Sep 2002) | 4 lines

Massive changes - for all purposes, a full rewrite.

Usage: owdigest datafile out_file

------------------------------------------------------------------------
r417 | karp | 2002-09-12 20:54:46 -0400 (Thu, 12 Sep 2002) | 2 lines

Transfer whole dir hierarchy instead of a single dir

------------------------------------------------------------------------
r416 | boote | 2002-09-12 18:30:55 -0400 (Thu, 12 Sep 2002) | 25 lines

First functioning version of powstream. Not yet validated - but it creates data
that looks fairly convincing at first glance.

Need better signal handling. (delete files on SIGINT, etc...)

api.c:
	Added OWPSessionDuration - returns duration of a current test
	session given the SID.
capi.c:
	Added timing info for delay_bound. Before it was only computed
	for the server side.
	Slightly modified OWPSessionRequest to give a little bit better
	information on why a test request failed. (It should perhaps be
	improved. See the TODO in the owamp.h header file.)
owamp.h:
	declarations for above changes.
owping.c:
	added error checking for progname. (I make the symlink the wrong
	name, and it got very confused, so I added this.)

powstream.c:
	kinda works.

jeff

------------------------------------------------------------------------
r415 | karp | 2002-09-11 23:05:53 -0400 (Wed, 11 Sep 2002) | 13 lines

Initial import - a suite of tools to take owamp data files
and transform them into bucket counts. Then take files of bucket
counts and process them further.

owdigest.c takes on input any number of owamp data files and constructs
           a digest of bin counts (records of the form <index, count>)

buckets.pl is a simple exercise in reading bucket file, I am rather
     leaning to use Python for constructing histograms - Python has
     much better numerical support and excellent interface to gnuplot.

buckets.py does just that - makes a histogram plot from bucket counts

------------------------------------------------------------------------
r414 | boote | 2002-09-11 15:43:53 -0400 (Wed, 11 Sep 2002) | 5 lines

Initial version of powstream. Doesn't work yet, but I wanted to check-point
my work.

jeff

------------------------------------------------------------------------
r413 | boote | 2002-09-09 19:51:06 -0400 (Mon, 09 Sep 2002) | 6 lines

Adding initial version of powstream. It does not work yet, but it will compile.

I also removed some things from conndata.

jeff

------------------------------------------------------------------------
r412 | karp | 2002-09-09 13:18:28 -0400 (Mon, 09 Sep 2002) | 5 lines

Fixed lost stats calculation and added precision in summary
report. Precision is computed as the worst precision among
individual packets - this is conservatively safe, but unfortunately
one bad packet can now an create unduly bad impression.

------------------------------------------------------------------------
r411 | boote | 2002-09-09 10:30:25 -0400 (Mon, 09 Sep 2002) | 4 lines

Fixed template for mkstemp. (Linux requires 6 X's.)

jeff

------------------------------------------------------------------------
r410 | boote | 2002-09-09 10:29:38 -0400 (Mon, 09 Sep 2002) | 8 lines

endpoint.c:
	removed compiler warning.

owping.c:
	fixed usage format strings.

jeff

------------------------------------------------------------------------
r409 | karp | 2002-09-06 22:55:03 -0400 (Fri, 06 Sep 2002) | 8 lines

# Read the file with binary time stamp records and print out one-way delays.
# Author: Anatoly Karp, Internet2 2002.

# usage: owdrive1.pl [datafile]

- much like the old one but more robust and reports
lost packets properly.

------------------------------------------------------------------------
r408 | karp | 2002-09-06 21:17:40 -0400 (Fri, 06 Sep 2002) | 2 lines

Improved reporting of lost packets

------------------------------------------------------------------------
r407 | karp | 2002-09-06 20:45:16 -0400 (Fri, 06 Sep 2002) | 2 lines

Fixed owstats to read the header.

------------------------------------------------------------------------
r406 | boote | 2002-09-06 18:23:51 -0400 (Fri, 06 Sep 2002) | 6 lines

removed localnode stuff.
fd's to fp's.
Added "w" option in for debugging.

jeff

------------------------------------------------------------------------
r405 | boote | 2002-09-06 17:24:48 -0400 (Fri, 06 Sep 2002) | 2 lines

context changes.

------------------------------------------------------------------------
r404 | boote | 2002-09-06 17:23:42 -0400 (Fri, 06 Sep 2002) | 31 lines

MANY changes. Mostly cleanup, but it ended up touching lots of files.

api.c:
	- Removed stuff from the ContextRecord.
	- Added schedule into tsession.
	- Created function for creating a SID so server/client could do it
	the same way.
	- Cleaned up the FileHeader stuff and made is all use buffered i/o.
	- Renamed FetchLocalRecords to ParseRecords and now uses buffered i/o.
capi.c:
	- Changed the ordering of EndpointInit stuff some so that the
	schedule can be computed before the CheckTestSession Policy
	function is called. (more important for v5, but I needed the
	schedule stuff for powstream.)
	- Combined FetchSessionInfo/FetchSessionRecords into a single function
	called FetchSession - and it uses buffered i/o.
context.c:
	- Added tsession to Endpoint functions.
	- Changed fd's to fp's.
	- Removed ctx->func_ptr indirections.
endpoint.c:
	- fd's to fp's.
	- DataFile(read/write)
	- tsession addition
	- moved SID creation out.
	- moved rand exponent generation out.
*.h:
	- interface changes for above.

jeff

------------------------------------------------------------------------
r403 | karp | 2002-09-06 16:13:40 -0400 (Fri, 06 Sep 2002) | 9 lines

The script now takes in a dirname and loops forever - matching
'*.owp' files and trying to send them off (round-robin so as not
to inflict starvation). Successfully transferred files are deleted
(after md5 check, of course)

Usage: nodemaster.pl [dirname]

--Tolya

------------------------------------------------------------------------
r402 | karp | 2002-09-05 23:41:25 -0400 (Thu, 05 Sep 2002) | 7 lines

Initial import - this script manages uploading of new datafiles
to the central server.

Usage: nodemaster.pl <filename>

--Tolya

------------------------------------------------------------------------
r401 | karp | 2002-09-04 13:02:03 -0400 (Wed, 04 Sep 2002) | 2 lines

Write data header (version 0)

------------------------------------------------------------------------
r400 | karp | 2002-09-04 12:29:58 -0400 (Wed, 04 Sep 2002) | 49 lines

The scary thing is, I had to change 10 files to take care
of this header business (all scenarios: receiver, and both
sides of Fetch). I believe most/all of them were necessary.

Added function

+/*
** Write header to the data file.
** XXX - for now just works for TestSpecPoissson. Assumes that <buf>
** has at least 96 bytes (fixed-size of Poisson Session Request).
*/
void
OWPEncodeDataHeader(OWPTestSpec	*test_spec,
		   u_int8_t version,
		   OWPBoolean server_conf_sender,
		   OWPBoolean server_conf_receiver,
		   struct sockaddr *sender,
		   struct sockaddr *receiver,
		   OWPSID		sid,
		   u_int8_t *buf)

is called by Receiver (and will be called by Fetch client in version 5)

Added a quick version (no error checks for fwrite's) of:

/*
** Write data header to the file. <len> is the length of the buffer -
** any other fields have to be accounted for separately in the
** header length value.
*/
+void
+OWPWriteDataHeadeR(FILE *fp, u_int32_t version, u_int8_t *buf, u_int32_t len)

Added 2 more args to OWPDefEndpointInitHook:

	OWPBoolean      send,
	OWPAddr         localaddr

(but this will be unnecessary once a full Session Request is
passed)

Adjusted include files and calls to it everywhere to match the new interface.

fixed sapi.c to deal with the new header

owping doesn't write the header anymore.

--Tolya

------------------------------------------------------------------------
r399 | karp | 2002-09-03 02:18:45 -0400 (Tue, 03 Sep 2002) | 7 lines

Initial import.

A Perl script to run through the data files and print records -
some variation may be useful for OWAMP deployment on Abilene.

--Tolya

------------------------------------------------------------------------
r398 | karp | 2002-09-03 01:34:39 -0400 (Tue, 03 Sep 2002) | 2 lines

Added handling of lost records.

------------------------------------------------------------------------
r397 | boote | 2002-08-30 15:05:40 -0400 (Fri, 30 Aug 2002) | 42 lines

api.c:
	modified some memory allocation to use calloc instead of malloc
	for memory initialization.

	Added a rough rtt delay-bound estimate for dynamically coming
	up with reasonable defaults for start times, and end of test
	expectations.

endpoint.c:
	modified memory allocations.

	modified recv process to optimize the end-of-test.

	modified recv process to write "lost packets" into the file.

	modified the recv process to actually make all the checks it is
	supposed to when deciding if a packet is valid.

owamp.h:
	added some ugly timeval/timespec macros. Ok, deep down, I must really
	love macro-land...

owampP.h:
	added delay_bound to cntrl record.

sapi.c:
	added delay estimate.

owping.c:
	Added from -> to into statistics banner.

	made default lossThreshold dynamic based upon rtt bound estimate.

	removed perror calls.

	fixed the -V option so it would work.

	made the start time depend upon the rtt bound estimate.


jeff

------------------------------------------------------------------------
r396 | karp | 2002-08-30 12:44:00 -0400 (Fri, 30 Aug 2002) | 2 lines

Added error-checks for command-line options.

------------------------------------------------------------------------
r395 | karp | 2002-08-30 11:15:23 -0400 (Fri, 30 Aug 2002) | 2 lines

Dynamically create getopt string.

------------------------------------------------------------------------
r394 | karp | 2002-08-29 18:19:34 -0400 (Thu, 29 Aug 2002) | 2 lines

usage() now works with owping/owstats/owfetch

------------------------------------------------------------------------
r393 | karp | 2002-08-29 16:32:31 -0400 (Thu, 29 Aug 2002) | 9 lines

Implemented owping/owstats/owfetch. Will do more error checks/sanity
checks for command line args.

Re-did buckets set-up for percentile computation after a thorough
discussion with Stas (previous version ignored negative delay
values)

--Tolya

------------------------------------------------------------------------
r392 | karp | 2002-08-29 01:10:48 -0400 (Thu, 29 Aug 2002) | 28 lines

Added a skeleton usage() - will rework it further, though.

Added function
/*
** Fetch a session with the given <sid> from the remote server.
** It is assumed that control connection has been opened already.
*/
void
owp_fetch_sid(
	      char *savefile,
	      OWPControl cntrl,
	      OWPSID sid,
	      fetch_state_ptr statep,
	      char *local,
	      char *remote
	      )

- currently used by regular owping (when client == sender)
but can be easily used by  owfetch. Further refactoring
is possible and may well happen in fact.

Currently it's not very clear how to handle the fetch
of multiple SIDs within a single control session
(since we have to allow for them to be saved I don't see
how the command-line can even be parsed in this case).
If this can be arranged then it's enough to simply
call owp_fetch_sid() multiple times.

------------------------------------------------------------------------
r391 | karp | 2002-08-27 19:08:11 -0400 (Tue, 27 Aug 2002) | 4 lines

Reimplemented command-line options using getopt().

Plugged in the use of file descriptors into owping.

------------------------------------------------------------------------
r389 | boote | 2002-08-26 20:00:56 -0400 (Mon, 26 Aug 2002) | 4 lines

Corrected scale of prec value.

jeff

------------------------------------------------------------------------
r388 | boote | 2002-08-26 15:57:36 -0400 (Mon, 26 Aug 2002) | 4 lines

Corrected sockaddr length determination.

jeff

------------------------------------------------------------------------
r387 | boote | 2002-08-25 20:04:20 -0400 (Sun, 25 Aug 2002) | 9 lines

Renamed AddrByLocalControl to OWPAddrByLocalControl.

Added fd's to library calls that create test sessions. Will add option to
use them into owping tomorrow morning.

owping: changed arg to OWP_LOOP to remove the unsigned <= 0 test.

jeff

------------------------------------------------------------------------
r386 | karp | 2002-08-23 17:49:56 -0400 (Fri, 23 Aug 2002) | 8 lines

Added print-out for endpoints of test-sessions.
Lines of the form

--- owping test session from *** to *** ---

are inserted after every 32 records
(the stars are replaced by the actual node name(s) if known)

------------------------------------------------------------------------
r385 | boote | 2002-08-23 11:21:39 -0400 (Fri, 23 Aug 2002) | 4 lines

Changed order of args so -readfile will work.

jeff

------------------------------------------------------------------------
r384 | boote | 2002-08-23 00:57:39 -0400 (Fri, 23 Aug 2002) | 13 lines

Added -from and -to command line options. Both is now the default.

Tolya - I added some really ugly prints around the session printouts so
you can see which is the "to" and which is the "from". Something else
would be MUCH better, but I don't want to look at it right now - I just
added something quick so you can see it.

To do anything better it will probably need to be integrated into your
printing stuff. I'm thinking something that uses some kind of
addr->addr format string in it would be really cool. Think about it.

jeff

------------------------------------------------------------------------
r383 | karp | 2002-08-22 19:56:30 -0400 (Thu, 22 Aug 2002) | 2 lines

Added "-percentile" option. Takes argument between 0 and 100 (float)

------------------------------------------------------------------------
r382 | boote | 2002-08-22 18:30:15 -0400 (Thu, 22 Aug 2002) | 7 lines

fixed some bugs in endpoint's time distribution calculation code:
	* recv didn't have sid
	* computed lasttime as an offset from current time instead of
		starttime like it should have for recv.

jeff

------------------------------------------------------------------------
r381 | karp | 2002-08-22 15:37:29 -0400 (Thu, 22 Aug 2002) | 2 lines

Tiny - fixed loss percentage error.

------------------------------------------------------------------------
r380 | karp | 2002-08-22 13:01:50 -0400 (Thu, 22 Aug 2002) | 2 lines

Fixed formatting and alignment for -full option.

------------------------------------------------------------------------
r379 | karp | 2002-08-21 23:46:19 -0400 (Wed, 21 Aug 2002) | 15 lines

Implemented Stas's N-reordering metric.

I do get a little compiler warning which I cannot explain at all:


owping.c: In function `do_single_record':
owping.c:568: warning: comparison of unsigned expression >= 0 is always true


Also implemented "-readfrom" option. I didn't call it "-sessionfile"
since I still plan sooner or later doing a twin option "-writeto".

NOTE: by default "-keepdata" is turned off. However it gets turned ON
when used with "-readfrom" (I think this is sensible)

------------------------------------------------------------------------
r378 | karp | 2002-08-21 18:01:00 -0400 (Wed, 21 Aug 2002) | 2 lines

Added percentiles computations.

------------------------------------------------------------------------
r377 | karp | 2002-08-21 00:38:34 -0400 (Wed, 21 Aug 2002) | 2 lines

Quick check-in with coredump bug fixed - thanks, efence

------------------------------------------------------------------------
r376 | karp | 2002-08-20 15:36:18 -0400 (Tue, 20 Aug 2002) | 4 lines

This bug never materialized but I just noticed it anyway -
if open(".i") succeeds we shouldn't try opening
complete file. Easy fix.

------------------------------------------------------------------------
r375 | karp | 2002-08-20 15:26:45 -0400 (Tue, 20 Aug 2002) | 8 lines

Removed the ".i' warning altogether - it's not supposed to
happen when ENOENT occurs, yet mysteriously it happens AND
ENOENT error message gets printed ("No such file or directory").

Investigating this would be a fun adventure into deeper secrets
of linux but...another time maybe. The situation is completely
benign, anyway.

------------------------------------------------------------------------
r374 | karp | 2002-08-20 15:13:13 -0400 (Tue, 20 Aug 2002) | 2 lines

Fixed permissions problem when fetching from remote host.

------------------------------------------------------------------------
r373 | karp | 2002-08-20 13:47:49 -0400 (Tue, 20 Aug 2002) | 2 lines

Fixed duplicates counting bug.

------------------------------------------------------------------------
r372 | karp | 2002-08-20 13:20:58 -0400 (Tue, 20 Aug 2002) | 3 lines

Fixed Fetch warning messages - no need to issue them when can't open ".i"
file (but do warn if ".i" file exists and can't be opened)

------------------------------------------------------------------------
r371 | boote | 2002-08-20 12:35:26 -0400 (Tue, 20 Aug 2002) | 9 lines

Fix to ensure WriteSessionRequest is not sent if cntrl->state shows current
state is test.

(The test state was wrong on both sides, but it was hidden because the
WriteSessionRequest was not properly checking if it should be allowed
to execute.)

jeff

------------------------------------------------------------------------
r370 | boote | 2002-08-20 12:32:24 -0400 (Tue, 20 Aug 2002) | 7 lines

fix to allow control connection to properly report failed connections if
msgtype is invalid.

also fix of cntrl->state to actually notice that test sessions are over.

jeff

------------------------------------------------------------------------
r369 | boote | 2002-08-20 11:54:14 -0400 (Tue, 20 Aug 2002) | 4 lines

Fix sid not properly returned bug.

jeff

------------------------------------------------------------------------
r368 | boote | 2002-08-20 11:31:40 -0400 (Tue, 20 Aug 2002) | 4 lines

fix compiler warning.

jeff

------------------------------------------------------------------------
r367 | karp | 2002-08-19 21:25:18 -0400 (Mon, 19 Aug 2002) | 6 lines

Implemented -keepdata, -full, -quiet and -datadir options.

Finished computing stats. Guy and Stas request a median now.
Removed max - average and stddev will follow soon (keep for
now as sanity check + debugging info).

------------------------------------------------------------------------
r366 | boote | 2002-08-19 20:31:51 -0400 (Mon, 19 Aug 2002) | 4 lines

Fix malloc problem.

jeff

------------------------------------------------------------------------
r365 | boote | 2002-08-19 19:46:58 -0400 (Mon, 19 Aug 2002) | 4 lines

Was setting the wrong default address for the server side of the test.

jeff

------------------------------------------------------------------------
r364 | boote | 2002-08-19 19:07:59 -0400 (Mon, 19 Aug 2002) | 7 lines

forgot to 0 port after copying saddr from tcp socket causing local bind's to
be wrong.

Replaced some mallocs with calloc's to zero memory.

jeff

------------------------------------------------------------------------
r363 | boote | 2002-08-19 15:22:09 -0400 (Mon, 19 Aug 2002) | 6 lines

fixed "connect" problem with bad default address being selected. Default
test addresses are now determined by looking at the saddr of the control
socket.

jeff

------------------------------------------------------------------------
r362 | karp | 2002-08-18 23:42:28 -0400 (Sun, 18 Aug 2002) | 2 lines

Debugged the window so it actully works (tested small win_size)

------------------------------------------------------------------------
r361 | karp | 2002-08-18 21:29:58 -0400 (Sun, 18 Aug 2002) | 7 lines

Added stats print-out. Finished window management - still need
to add duplicate packets tracking but that will be easy now.
Checking in while it still works :) [and my head begins to hurt!]

Did some serious clean-up - now have few functions, each doing
something truly useful.

------------------------------------------------------------------------
r360 | karp | 2002-08-18 01:57:24 -0400 (Sun, 18 Aug 2002) | 2 lines

Fixed directory path

------------------------------------------------------------------------
r359 | karp | 2002-08-18 00:09:13 -0400 (Sun, 18 Aug 2002) | 4 lines

Re-did the window using fixed-sized array - comparable performance
but less headaches with memory management. Added new command-line
options - still need to incorporate them.

------------------------------------------------------------------------
r358 | karp | 2002-08-16 19:59:11 -0400 (Fri, 16 Aug 2002) | 2 lines

Zero out memory for robust hash lookups

------------------------------------------------------------------------
r357 | boote | 2002-08-16 19:05:37 -0400 (Fri, 16 Aug 2002) | 6 lines

Fixed memory problem with endpoint functions.

removed select returned message from server.

jeff

------------------------------------------------------------------------
r356 | boote | 2002-08-16 15:04:33 -0400 (Fri, 16 Aug 2002) | 6 lines

api.c: corrected uninitialized var.

owping: check strdup return.

jeff

------------------------------------------------------------------------
r355 | boote | 2002-08-16 13:13:59 -0400 (Fri, 16 Aug 2002) | 4 lines

Fixed re-binding address.

jeff

------------------------------------------------------------------------
r354 | karp | 2002-08-16 13:03:07 -0400 (Fri, 16 Aug 2002) | 2 lines

Fixed handling of header in data file.

------------------------------------------------------------------------
r353 | karp | 2002-08-16 13:02:25 -0400 (Fri, 16 Aug 2002) | 2 lines

Added OWPGetDataHeader() function.

------------------------------------------------------------------------
r352 | karp | 2002-08-16 01:47:27 -0400 (Fri, 16 Aug 2002) | 4 lines

owping prints ping-style results to screen - results
are nonsense and must be debugged further but at least
now we have something tangible to work with.

------------------------------------------------------------------------
r351 | karp | 2002-08-16 01:43:31 -0400 (Fri, 16 Aug 2002) | 2 lines

Small bug fix

------------------------------------------------------------------------
r350 | boote | 2002-08-15 20:20:01 -0400 (Thu, 15 Aug 2002) | 4 lines

client seems to be working fine as receiver.

jeff

------------------------------------------------------------------------
r349 | boote | 2002-08-15 20:03:12 -0400 (Thu, 15 Aug 2002) | 4 lines

modified path functions/conndata to not need additional dynamic memory.

jeff

------------------------------------------------------------------------
r348 | karp | 2002-08-15 19:14:54 -0400 (Thu, 15 Aug 2002) | 3 lines

Have application (owping) manipulate timestamp data records
using a wrapper data structure OWPCookedDataRec.

------------------------------------------------------------------------
r347 | karp | 2002-08-15 17:15:11 -0400 (Thu, 15 Aug 2002) | 2 lines

Minor typos

------------------------------------------------------------------------
r346 | karp | 2002-08-15 17:04:41 -0400 (Thu, 15 Aug 2002) | 6 lines

Write TypeP header to file when fetching to local disk - done
in capi.c so owping need not worry.

Removed owp_save_to_disk from owping - have owping call
OWPFetchSession() to get data to local disk.

------------------------------------------------------------------------
r345 | karp | 2002-08-15 16:32:10 -0400 (Thu, 15 Aug 2002) | 2 lines

Have client process Type-P during Fetch.

------------------------------------------------------------------------
r344 | boote | 2002-08-15 16:05:33 -0400 (Thu, 15 Aug 2002) | 3 lines

policy changes for client. (There is a problem with the endpoint now - it can't
write to the directory...) I'll look at it when I get back.

------------------------------------------------------------------------
r343 | karp | 2002-08-15 16:01:57 -0400 (Thu, 15 Aug 2002) | 17 lines

Changed OWPFetchSessions to look like this:

OWPErrSeverity
OWPFetchSession(OWPControl cntrl,
		u_int32_t  begin,
		u_int32_t  end,
		OWPSID	   sid,
		int        fd)

it now fetches records from remote server and writes them
to user-provided file descriptor.

Removed no longer needed

OWPFetchRecords()
OWPCheckPadding() [part of OWPFetchSession now]

------------------------------------------------------------------------
r342 | karp | 2002-08-15 02:00:23 -0400 (Thu, 15 Aug 2002) | 27 lines

At the high level added:

/*
** Retrieve records from remote server and save them in a file
** on the local disk. No printing is done. Returns 0 on success,
** or -1 on failure.
*/
int
owp_fetch_to_local(OWPControl cntrl,
		   u_int32_t  num_rec,
		   char       *datadir,
		   OWPSID     sid);

Added data structures and functions to support managing fetch state
and, in particular, the window, for producing statistics.

Streamlined output functions - there is now a master function:

void
owp_record_out(u_int8_t *rec, fetch_state_ptr state)

which can be used to print records in any desired style.

Set up conndata.datadir (user provided or else unique temporary)
[just realized I forgot to actually do mkdir() - will add in
 next check-in]

------------------------------------------------------------------------
r341 | karp | 2002-08-15 01:43:34 -0400 (Thu, 15 Aug 2002) | 2 lines

Exclusively cosmetic changes.

------------------------------------------------------------------------
r340 | karp | 2002-08-15 01:41:07 -0400 (Thu, 15 Aug 2002) | 7 lines

Change opendatafile() to accept real_data_dir (which was has been set up
in conndata) and updated the code in OWPDefEndpointInit accordingly.

changed and moved make_data_dir() to defaults.c

Minor cosmetic changes.

------------------------------------------------------------------------
r339 | karp | 2002-08-15 01:32:25 -0400 (Thu, 15 Aug 2002) | 12 lines

Make owp_check_control set up the connnection's data directories.

ATTENTION: Jeff, owp_check_control currently doesn't have
an error handle as argument, which was ok until recent changes - but
now it calls make_data_dir to set up data directories (and
make_data_dir can't get an error handle either - since the caller
doesn't have it) yet it seems that setting up data dirs is an action
critical enough that errors must be reported somehow. I have
for now put calls to fprintf(stderr, ..) but maybe you can
suggest a better way. owp_check_control currently receives policy handle
as its app_data.

------------------------------------------------------------------------
r338 | karp | 2002-08-15 01:16:25 -0400 (Thu, 15 Aug 2002) | 2 lines

Added 'real_data_dir' and 'link_data_dir' fields to conndata.

------------------------------------------------------------------------
r337 | karp | 2002-08-15 01:14:49 -0400 (Thu, 15 Aug 2002) | 19 lines

Added functions:

/*
** Given a 20-byte timestamp record, return its sequence number.
*/
u_int32_t
OWPGetSeqno(u_int8_t *rec);

/*
** Parse the 20-byte timestamp data record for application to use.
*/
void
OWPParseDataRecord(u_int8_t *rec,
		   OWPTimeStamp *send,
		   OWPTimeStamp *recv,
		   u_int32_t     *seq_no);

/*

------------------------------------------------------------------------
r336 | boote | 2002-08-14 19:58:21 -0400 (Wed, 14 Aug 2002) | 6 lines

Removed some printing (#define VERBOSE if you want it back).

Fixed MANY wierd isolated problems that are making me go bald and grey.

jeff

------------------------------------------------------------------------
r335 | boote | 2002-08-14 17:05:46 -0400 (Wed, 14 Aug 2002) | 7 lines

Corrected a number of protocol problems. (error detection problems as well.)

Client side seems to be working correctly now. Server still has some strangeness
going on. On to that next.

jeff

------------------------------------------------------------------------
r334 | boote | 2002-08-14 12:35:20 -0400 (Wed, 14 Aug 2002) | 5 lines

Corrected ReadControlAck to read the full two blocks instead of one. It works
much better this way.

jeff

------------------------------------------------------------------------
r333 | boote | 2002-08-14 12:11:29 -0400 (Wed, 14 Aug 2002) | 5 lines

Added endpoint_status function so the status of a session endpoint can be
queried.

jeff

------------------------------------------------------------------------
r332 | karp | 2002-08-12 19:39:25 -0400 (Mon, 12 Aug 2002) | 3 lines

Set up skeleton and basic structures for Fetch - both local
and remote.

------------------------------------------------------------------------
r331 | karp | 2002-08-12 19:30:59 -0400 (Mon, 12 Aug 2002) | 23 lines

Changed OWPFetchRecords to more flexible interface so it
can serve as a driver for various processing modes.
Separated handling final 16-byte padding into a separate
function

OWPErrSeverity
+OWPCheckPadding(OWPControl cntrl)

Added new function
/*
** "Fetching" data from local disk - assume the header has been
** processed already.
*/
OWPErrSeverity
OWPFetchLocalRecords(int fd,
		     u_int32_t num_rec,
		     OWPDoRawDataRecord proc_rec,
		     void *app_data)


It seems somewhat tricky (and a bit ugly) to combine it with
OWPFetchRecords so I am thinking of just keeping them apart.

------------------------------------------------------------------------
r330 | boote | 2002-08-09 15:19:56 -0400 (Fri, 09 Aug 2002) | 21 lines

I2util:
	made random use raw io so forked processes could read from the
	same fd without problems.

	added readn/writen functions from owamp

owamp:
	made everything use I2 versions of readn/writen

	removed get_timestamp_func from ctx - we are not using it.

	stopped forks from closing all open descriptors

owampd/owping:

	PolicyInit was core dumping because we were calling it with
	an errhand and it was expecting a ctx... I changed the apps
	to call it with a ctx.

jeff

------------------------------------------------------------------------
r329 | boote | 2002-08-08 20:26:12 -0400 (Thu, 08 Aug 2002) | 8 lines

Cleaned up the StopSessions functions - they were a bit confused.
Added the Wait version one.
Corrected places where OWPErrOK was assumed to be 0 - since it isn't anymore...
Added timeval conversion functions.
removed unixtime.h since everything is in owamp.h and owampP.h.

jeff

------------------------------------------------------------------------
r328 | boote | 2002-08-08 16:50:29 -0400 (Thu, 08 Aug 2002) | 9 lines

I2util: added a va_list logging function.

owamp:
	changed the OWPError function to be a macro and removed the
	OWPErrorLine function. The I2ErrLog stuff is used by the OWPError
	macro.

jeff

------------------------------------------------------------------------
r327 | karp | 2002-08-08 15:04:11 -0400 (Thu, 08 Aug 2002) | 30 lines

Fully implemented server-side Fetch functionality. Added functions:

OWPErrSeverity
OWPProcessRetrieveSession(OWPControl cntrl);  /* top level function */
- it calls the following ones:

/*
** Read records from the given descriptor and send it to the OWPControl socket.
*/
static OWPErrSeverity
OWPSendFullDataFile(OWPControl cntrl, int fd,u_int32_t blksize,off_t filesize);

/*
** Read timestamp data records from the descriptor and count or send them
** to Control socket depending on <type>. Error code is returned via
** <*err_ret> and must be checked by caller. When <type> is OWP_COUNT,
** returns the number of records within the given range (and when
** <type> is OWP_SEND the return value can be ignored).
*/
static u_int32_t
OWPProcessRecordsInRange(OWPControl      cntrl,
			 int             fd,
			 u_int32_t       begin,
			 u_int32_t       end,
			 u_int32_t       blksize,
			 off_t           rem_bytes,
			 int             type,       /* OWP_COUNT, OWP_SEND */
			 OWPErrSeverity* err_ret
)

------------------------------------------------------------------------
r326 | boote | 2002-08-08 14:16:03 -0400 (Thu, 08 Aug 2002) | 15 lines

Modified the random functions to be relative to a random "context".
Modified the OWPErr functions to exclusively use the I2Err functions.
(The OWPErr functions are simply a wrapper around the I2Err functions -
unfortunately they can't be macros due to the var-args...)

This means if you want to have an application defined error function, you have
to define the I2ErrHandler yourself, and assign it to eh in the OWPContext.

This actually simplified things quite a bit. I would almost like to go
through and remove all the OWPError and OWPErrLine calls and replace them
with I2 varients - may do that later, doesn't seem worth it right now. It
would make the __FILE__ and __LINE__ macro's cleaner.

jeff

------------------------------------------------------------------------
r325 | karp | 2002-08-06 19:13:24 -0400 (Tue, 06 Aug 2002) | 2 lines

More replacements of the last #defines - done now.

------------------------------------------------------------------------
r324 | karp | 2002-08-06 18:51:45 -0400 (Tue, 06 Aug 2002) | 2 lines

Added defines for nodes/sessions dirsr etc

------------------------------------------------------------------------
r323 | boote | 2002-08-06 18:01:31 -0400 (Tue, 06 Aug 2002) | 9 lines

libraries are merged.

We still need to clean the namespace, and it will probably be a good idea
to look at some things a bit closer. I think there are some things that
should perhaps be moved around to make them clearer. (Code review kinds of
things.)

jeff

------------------------------------------------------------------------
r322 | boote | 2002-08-06 17:44:56 -0400 (Tue, 06 Aug 2002) | 4 lines

in the process of combining libowamp/libowpcontrib

jeff

------------------------------------------------------------------------
r321 | boote | 2002-08-06 17:43:13 -0400 (Tue, 06 Aug 2002) | 2 lines

Removing owpcontrib.

------------------------------------------------------------------------
r320 | boote | 2002-08-06 17:20:23 -0400 (Tue, 06 Aug 2002) | 5 lines

Moved a number of functions from unixtime.c into owamp/time.c : renamed
hexencode in print.c.

jeff

------------------------------------------------------------------------
r319 | karp | 2002-08-06 16:44:47 -0400 (Tue, 06 Aug 2002) | 2 lines

Make hexencode public for use in debug functions

------------------------------------------------------------------------
r318 | boote | 2002-08-06 16:36:58 -0400 (Tue, 06 Aug 2002) | 10 lines

Added sym-link dir for all session files.

corrected memory over-run with char * path variables.

Added policy configuration to client side.

Unified use of OWP_PATH_SEPARATOR.

jeff

------------------------------------------------------------------------
r317 | karp | 2002-08-06 16:35:23 -0400 (Tue, 06 Aug 2002) | 2 lines

Added owp_dump_msg() function

------------------------------------------------------------------------
r316 | karp | 2002-08-06 14:14:42 -0400 (Tue, 06 Aug 2002) | 7 lines

Added randomness source initialization support, and updated
affected code elsewhere. The proper order of events now is:

1. OWPContextInitialize() [calls I2RandomSourceInit()]
2. repeated calls to I2RandomBytes() [not affected by any subsequent changes
			             in underlying randomness source]

------------------------------------------------------------------------
r315 | boote | 2002-08-05 13:48:31 -0400 (Mon, 05 Aug 2002) | 8 lines

Test sessions seem to work - owping doesn't wait for the test session to finish - but if you wait until the -datadir/SID.i file is renamed to -datadir/SID you
do get a complete file.

I need to modify the file-buffering some, and owping needs to be modified to
wait for the test session to complete.

jeff

------------------------------------------------------------------------
r314 | karp | 2002-08-05 11:21:06 -0400 (Mon, 05 Aug 2002) | 2 lines

Minor fix - misplaced #define

------------------------------------------------------------------------
r313 | karp | 2002-08-05 11:18:15 -0400 (Mon, 05 Aug 2002) | 2 lines

Linked in math library.

------------------------------------------------------------------------
r312 | karp | 2002-08-05 11:17:27 -0400 (Mon, 05 Aug 2002) | 14 lines

Implemented owping output. The master function doing the output is

/*
** Master output function - reads the records sent by the server
** and prints them to the stdout in a style specified by <type>.
** Its value is interpreted as follows:
** 0 - print out send and recv timestamsps for each record in machine-readable
** format;
** 1 - print one-way delay in msec (in %.3f format) for each record,
** and final summary (original ping style: max/avg/min/stdev) at the end.
*/
int
do_records_all(OWPControl cntrl, u_int32_t num_rec, int type, FILE *fp);

------------------------------------------------------------------------
r311 | karp | 2002-08-05 10:54:27 -0400 (Mon, 05 Aug 2002) | 2 lines

Moved fetch call-back functions into owping.c. Minor fixes.

------------------------------------------------------------------------
r310 | boote | 2002-08-02 16:15:34 -0400 (Fri, 02 Aug 2002) | 4 lines

fixed memory bugs relating to sockaddr_storage.

jeff

------------------------------------------------------------------------
r309 | boote | 2002-08-01 12:47:22 -0400 (Thu, 01 Aug 2002) | 8 lines

First cut at the recv/send functionality. There are definitely some problems
still -but sessions to actually happen. (Data files don't seem to have
everything in them I would expect yet...)

But - I wanted to get this all checked in before I leave for my flight.

jeff

------------------------------------------------------------------------
r308 | karp | 2002-07-31 16:33:47 -0400 (Wed, 31 Jul 2002) | 2 lines

Initial import.

------------------------------------------------------------------------
r307 | karp | 2002-07-30 13:12:39 -0400 (Tue, 30 Jul 2002) | 2 lines

Minor - replaced bcopy by memcpy (yes, watched arg order\!)

------------------------------------------------------------------------
r306 | karp | 2002-07-30 13:10:45 -0400 (Tue, 30 Jul 2002) | 25 lines

Added tree-traversal functions:

/*
** Generic type for a node-processing function.
*/
typedef void (*owp_node_func)(
	owp_tree_node_ptr node,   /* Node to be processed.         */
	void *data                /* Additional data to be passed. */
);

/*
** Generic tree traversal function. Caller provides the node-processing
** function <func> along with any necessary data.
*/
extern void
owp_tree_iterate_df(owp_tree_node_ptr root, owp_node_func func, void *data);

/*
** Default function for printing node info to a given file stream
** (to be cast as FILE* from <data>)
*/
extern void owp_print_node(owp_tree_node_ptr node, void *data);

Fixed bugs with saving nodes to `class2node' hash.

------------------------------------------------------------------------
r305 | karp | 2002-07-29 21:24:52 -0400 (Mon, 29 Jul 2002) | 2 lines

Fixed memory leaks and corrected line-counting in read_ip2class()

------------------------------------------------------------------------
r304 | karp | 2002-07-29 21:23:44 -0400 (Mon, 29 Jul 2002) | 2 lines

Make a valid config file so server can start without aborting

------------------------------------------------------------------------
r303 | karp | 2002-07-29 20:25:45 -0400 (Mon, 29 Jul 2002) | 2 lines

Minor bug fix.

------------------------------------------------------------------------
r302 | karp | 2002-07-29 18:40:16 -0400 (Mon, 29 Jul 2002) | 6 lines

This is a message for the last check-in (typed Enter too fast, sorry).
Completely re-wrote owp_read_ip2class() - removed arbitrary restrictions
on length of classnames along the way.

Minor fixes elsewhere.

------------------------------------------------------------------------
r301 | karp | 2002-07-29 18:35:24 -0400 (Mon, 29 Jul 2002) | 2 lines

access2.c

------------------------------------------------------------------------
r300 | boote | 2002-07-26 20:03:32 -0400 (Fri, 26 Jul 2002) | 9 lines

compiles - but I have NOT tested it at ALL.

I'm sorry tolya, but I've run out of time. I will try and do more
 while in Boulder. (The send code is complete, but I don't have
 the receiver code in there yet. It shouldn't be too hard, the
 difficult timing stuff was in the sender.)

jeff

------------------------------------------------------------------------
r299 | karp | 2002-07-26 15:34:11 -0400 (Fri, 26 Jul 2002) | 2 lines

Fixed memory leaks from indiscriminate use of raw2datum()

------------------------------------------------------------------------
r298 | karp | 2002-07-26 14:20:40 -0400 (Fri, 26 Jul 2002) | 2 lines

Added file banner.

------------------------------------------------------------------------
r297 | karp | 2002-07-26 12:54:48 -0400 (Fri, 26 Jul 2002) | 2 lines

Switched order of dependencies to allow use of owpcontrib/print.c

------------------------------------------------------------------------
r296 | karp | 2002-07-26 12:53:03 -0400 (Fri, 26 Jul 2002) | 2 lines

Added prototype for owp_print_owpaddr

------------------------------------------------------------------------
r295 | karp | 2002-07-26 12:46:00 -0400 (Fri, 26 Jul 2002) | 19 lines

Added debug functions:

void
owp_print_strnet(owp_access_netmask *ptr, FILE* fp);
- prints out 'netmask struct' used by policy functions.

void
owp_print_netmask(const I2datum *key, FILE* fp);
- convenience function. Prints out netmask returned as an I2datum
from a hash look-up.

/* Show the contents of a sockaddr struct. */
void
owp_print_sockaddr(struct sockaddr *sock);

/* Show the contents of an OWPAddr struct. */
void
owp_print_owpaddr(FILE *fp, OWPAddr addr);

------------------------------------------------------------------------
r294 | karp | 2002-07-26 11:56:03 -0400 (Fri, 26 Jul 2002) | 2 lines

Tiny - set policy field in conndata (NewConnection)

------------------------------------------------------------------------
r293 | karp | 2002-07-26 11:29:19 -0400 (Fri, 26 Jul 2002) | 2 lines

Added check_test() prototype.

------------------------------------------------------------------------
r292 | karp | 2002-07-26 11:28:07 -0400 (Fri, 26 Jul 2002) | 2 lines

Fixed policy arg to NewConnection. Installed default call-backsin cfg.

------------------------------------------------------------------------
r291 | karp | 2002-07-25 14:56:58 -0400 (Thu, 25 Jul 2002) | 2 lines

Fixed a big with a wrong message size.

------------------------------------------------------------------------
r290 | karp | 2002-07-25 14:07:22 -0400 (Thu, 25 Jul 2002) | 2 lines

Minor fixes.

------------------------------------------------------------------------
r289 | karp | 2002-07-25 13:12:30 -0400 (Thu, 25 Jul 2002) | 3 lines

Simplified _OWPSendBlocks and OWPReceiveBlocks, and also enabled
them to send/receive *any* number of blocks.

------------------------------------------------------------------------
r288 | karp | 2002-07-25 12:46:38 -0400 (Thu, 25 Jul 2002) | 2 lines

Added prototype for _OWPReadDataHeader()

------------------------------------------------------------------------
r287 | karp | 2002-07-25 12:45:26 -0400 (Thu, 25 Jul 2002) | 2 lines

Implmented OWPFetchRecords() using the callback function mechanism.

------------------------------------------------------------------------
r286 | karp | 2002-07-24 00:51:33 -0400 (Wed, 24 Jul 2002) | 2 lines

Added #ifdefs for AF_INET6

------------------------------------------------------------------------
r285 | karp | 2002-07-24 00:46:12 -0400 (Wed, 24 Jul 2002) | 2 lines

Added functions OWPFetchSession() and OWPReadDataHeader().

------------------------------------------------------------------------
r284 | karp | 2002-07-23 12:19:32 -0400 (Tue, 23 Jul 2002) | 2 lines

Added OWPnum64 OWPusec2num64() function.

------------------------------------------------------------------------
r283 | boote | 2002-07-23 10:31:01 -0400 (Tue, 23 Jul 2002) | 4 lines

api.c,owampP.h,protocol.c:	modified kid to be 16 byte field.

jeff

------------------------------------------------------------------------
r282 | karp | 2002-07-22 16:39:14 -0400 (Mon, 22 Jul 2002) | 2 lines

Added timespec conversions.

------------------------------------------------------------------------
r281 | karp | 2002-07-22 16:07:02 -0400 (Mon, 22 Jul 2002) | 2 lines

Fixed bugs in crucial policy lookups.

------------------------------------------------------------------------
r280 | karp | 2002-07-22 15:30:15 -0400 (Mon, 22 Jul 2002) | 2 lines

Added print.c to source files.

------------------------------------------------------------------------
r279 | karp | 2002-07-22 15:28:56 -0400 (Mon, 22 Jul 2002) | 2 lines

Removed arithm128 files from sources.

------------------------------------------------------------------------
r278 | karp | 2002-07-22 13:30:07 -0400 (Mon, 22 Jul 2002) | 2 lines

Make arithmetic functions public.

------------------------------------------------------------------------
r277 | karp | 2002-07-22 12:05:37 -0400 (Mon, 22 Jul 2002) | 2 lines

Removing arithm128_* files

------------------------------------------------------------------------
r276 | karp | 2002-07-22 11:57:47 -0400 (Mon, 22 Jul 2002) | 2 lines

Added missing prototypes.

------------------------------------------------------------------------
r275 | karp | 2002-07-22 11:52:22 -0400 (Mon, 22 Jul 2002) | 2 lines

Fixed harmless compiler warnings.

------------------------------------------------------------------------
r274 | karp | 2002-07-22 11:49:43 -0400 (Mon, 22 Jul 2002) | 2 lines

Removing test-hash.c

------------------------------------------------------------------------
r273 | boote | 2002-07-19 19:08:03 -0400 (Fri, 19 Jul 2002) | 9 lines

Made changes to use sockaddr_storage instead of dynamic memory...

Made many other minor fixes.

First cut at EndpointInit and EndpointInitHook - no data being sent yet - just
dealing with process stuff so far.

jeff

------------------------------------------------------------------------
r272 | karp | 2002-07-19 15:44:39 -0400 (Fri, 19 Jul 2002) | 2 lines

Added owp_ip_packet_size function.

------------------------------------------------------------------------
r271 | karp | 2002-07-19 14:01:44 -0400 (Fri, 19 Jul 2002) | 2 lines

Minor bug fix with init values in _OWPAddrAlloc.

------------------------------------------------------------------------
r270 | karp | 2002-07-19 10:31:13 -0400 (Fri, 19 Jul 2002) | 2 lines

Fixed bugs in look-ups. Changed field class2limits to class2node

------------------------------------------------------------------------
r269 | karp | 2002-07-18 13:27:47 -0400 (Thu, 18 Jul 2002) | 2 lines

oops - forgot semicolon

------------------------------------------------------------------------
r268 | karp | 2002-07-18 13:26:04 -0400 (Thu, 18 Jul 2002) | 2 lines

Added 'mode' field to OWPPerConnDataRec struct.

------------------------------------------------------------------------
r267 | karp | 2002-07-17 23:09:47 -0400 (Wed, 17 Jul 2002) | 2 lines

Minor clarifications in comments.

------------------------------------------------------------------------
r266 | karp | 2002-07-17 23:07:44 -0400 (Wed, 17 Jul 2002) | 2 lines

Slightly changed interface to read_class2limits.

------------------------------------------------------------------------
r265 | karp | 2002-07-17 23:06:47 -0400 (Wed, 17 Jul 2002) | 3 lines

Finished owp_check_control() and added owp_check_test()
hook functions.

------------------------------------------------------------------------
r264 | karp | 2002-07-17 23:05:11 -0400 (Wed, 17 Jul 2002) | 2 lines

More integrity checks for config files.

------------------------------------------------------------------------
r263 | karp | 2002-07-17 23:03:59 -0400 (Wed, 17 Jul 2002) | 5 lines

Added macros for easier access to class limits.
Added a pointer to the root of class tree hierarchy
to the policy struct - simplifies set-up of default
classes for ip addresses.

------------------------------------------------------------------------
r262 | karp | 2002-07-17 12:35:09 -0400 (Wed, 17 Jul 2002) | 2 lines

Added 'node' field for the connection class.

------------------------------------------------------------------------
r261 | karp | 2002-07-16 17:35:34 -0400 (Tue, 16 Jul 2002) | 2 lines

Added defaults.c to source list.

------------------------------------------------------------------------
r260 | karp | 2002-07-16 17:34:48 -0400 (Tue, 16 Jul 2002) | 2 lines

Added consistency and integrity checks to owp_get_description()

------------------------------------------------------------------------
r259 | karp | 2002-07-16 17:32:30 -0400 (Tue, 16 Jul 2002) | 2 lines

Extended print_class2node_binding to print all node fields.

------------------------------------------------------------------------
r258 | karp | 2002-07-16 17:31:41 -0400 (Tue, 16 Jul 2002) | 2 lines

Added application-provided owp_check_control() function.

------------------------------------------------------------------------
r257 | karp | 2002-07-16 17:30:51 -0400 (Tue, 16 Jul 2002) | 2 lines

Slightly more interesting config.

------------------------------------------------------------------------
r256 | karp | 2002-07-16 17:29:26 -0400 (Tue, 16 Jul 2002) | 2 lines

Added owp_sockaddr2class() function.

------------------------------------------------------------------------
r255 | karp | 2002-07-16 17:28:18 -0400 (Tue, 16 Jul 2002) | 3 lines

Added prototypes for owp_kid2passwd() and owp_sockaddr2class() functions.
Minor clean-up.

------------------------------------------------------------------------
r254 | karp | 2002-07-15 19:01:40 -0400 (Mon, 15 Jul 2002) | 2 lines

Initial import - added owp_get_aes_key() function.

------------------------------------------------------------------------
r253 | karp | 2002-07-15 18:32:28 -0400 (Mon, 15 Jul 2002) | 2 lines

Added owp_kid2passwd() function.

------------------------------------------------------------------------
r252 | karp | 2002-07-15 17:04:04 -0400 (Mon, 15 Jul 2002) | 2 lines

Added policy field. Fixed typedef typo.

------------------------------------------------------------------------
r251 | karp | 2002-07-15 00:53:10 -0400 (Mon, 15 Jul 2002) | 2 lines

Minor fix.

------------------------------------------------------------------------
r250 | karp | 2002-07-15 00:52:43 -0400 (Mon, 15 Jul 2002) | 2 lines

Added prototypes for new functions, and definitions for tree structures.

------------------------------------------------------------------------
r249 | karp | 2002-07-15 00:45:33 -0400 (Mon, 15 Jul 2002) | 3 lines

Add function owp_print_class2node_binding() - used to see/debug
the tree hierarchy of usage classes.

------------------------------------------------------------------------
r248 | karp | 2002-07-15 00:43:11 -0400 (Mon, 15 Jul 2002) | 3 lines

Initial import of read_class2limits.c - read the tree structure of classes,
and their associated usage limits.

------------------------------------------------------------------------
r247 | karp | 2002-07-15 00:40:40 -0400 (Mon, 15 Jul 2002) | 2 lines

Example of a new class2limits format.

------------------------------------------------------------------------
r246 | karp | 2002-07-14 23:55:50 -0400 (Sun, 14 Jul 2002) | 4 lines

Fixed lower level function to pass errors upwards instead
of exiting. Completed processing the password file -
owp_read_passwd_file(). Added owp_ prefix to symbols.

------------------------------------------------------------------------
r245 | boote | 2002-07-04 12:46:19 -0400 (Thu, 04 Jul 2002) | 2 lines

Adding.

------------------------------------------------------------------------
r244 | boote | 2002-07-04 12:45:27 -0400 (Thu, 04 Jul 2002) | 15 lines

Modified the app_data to be relative to a connection. It should be set with
the data type defiend in owamp/conndata.h - which I will check in momentarily.

This will allow each child process to request resouces from the parent process.
(It might be a cool idea to call the policy stuff directly if pipefd is < 0.
that way the same functions can be used from the client but we can talk
about this when I get back.)

Tolya, I hope this is clear to you.


See you next week. I need to take off now.

jeff

------------------------------------------------------------------------
r243 | boote | 2002-07-03 18:09:40 -0400 (Wed, 03 Jul 2002) | 7 lines

Fixed a number of really dumb errors on my part.

owping will actually talk to owampd now - the test sessions are still
non-existant, but things are moving in the right direction.

jeff

------------------------------------------------------------------------
r242 | boote | 2002-07-02 21:11:30 -0400 (Tue, 02 Jul 2002) | 4 lines

Fixed compiler error.

jeff

------------------------------------------------------------------------
r241 | boote | 2002-07-02 19:25:17 -0400 (Tue, 02 Jul 2002) | 15 lines

Big changes... Too many to go through. I should not have gone so long between
check-in's.

Basically I think the control protocol is nearly finished. I have not actually
tried it yet however - it is actually a little hard to test without firing off
a test, and I have not written the udp code yet. tomorrow. The only part of
the control protocol that is not finished is retreiving session data. The
client can currently request the data, but the server will always deny.
(I figured we can just look at the data on disk for now - I want to get
actual sessions working before messing with it.)

removed the CheckAddr func stuff.

jeff

------------------------------------------------------------------------
r240 | karp | 2002-06-25 15:21:28 -0400 (Tue, 25 Jun 2002) | 2 lines

Parsing and print-out for new design of the password file.

------------------------------------------------------------------------
r239 | karp | 2002-06-25 15:20:19 -0400 (Tue, 25 Jun 2002) | 2 lines

Migrated to access2.c

------------------------------------------------------------------------
r238 | karp | 2002-06-24 21:48:36 -0400 (Mon, 24 Jun 2002) | 2 lines

Removed duplicate PolicyInit().

------------------------------------------------------------------------
r237 | karp | 2002-06-24 21:47:45 -0400 (Mon, 24 Jun 2002) | 3 lines

Added functions fetching the smallest netmask containing a given IP
address (v4 or v6). Full print-out of ip2class hash for debugging.

------------------------------------------------------------------------
r236 | karp | 2002-06-24 21:21:51 -0400 (Mon, 24 Jun 2002) | 6 lines

Mostly minimalistic changes or plugs just to get the program to compile so
I could test.

Also changed id2class to ip2class everywhere - cleaner solution in light
of the upcoming changes to config files design.

------------------------------------------------------------------------
r235 | karp | 2002-06-23 23:13:03 -0400 (Sun, 23 Jun 2002) | 2 lines

Added conversions OWPnum64 to/from struct timeval. Comments/clean-up.

------------------------------------------------------------------------
r234 | boote | 2002-06-21 20:21:10 -0400 (Fri, 21 Jun 2002) | 4 lines

cleaned up a bit. won't compile until I add the process_requests function...

jeff

------------------------------------------------------------------------
r233 | boote | 2002-06-21 20:19:46 -0400 (Fri, 21 Jun 2002) | 2 lines

remove warning.

------------------------------------------------------------------------
r232 | boote | 2002-06-21 20:15:50 -0400 (Fri, 21 Jun 2002) | 14 lines

api.c: added OWPGetMode

capi.c: remove state setting - done by protocol.c

io.c: made readn/writen public functions

owamp.h/owampP.h: modifed state stuff - more changes coming to address email...

protocol.c: state stuff

sapi.c: remove state setting

jeff

------------------------------------------------------------------------
r231 | karp | 2002-06-21 16:18:00 -0400 (Fri, 21 Jun 2002) | 3 lines

Replaced 'unsigned long long' by u_int64_t. Improved comments
and added usage example.

------------------------------------------------------------------------
r230 | karp | 2002-06-21 14:38:22 -0400 (Fri, 21 Jun 2002) | 4 lines

Initial import of 32.32 arithmetic geared for use with Owamp
timestamps. Generation of uniform and exponential random
numbers using AES and based on 64-bit integer type.

------------------------------------------------------------------------
r229 | karp | 2002-06-19 02:10:51 -0400 (Wed, 19 Jun 2002) | 2 lines

Fixed bugs in IPv6 print-out.

------------------------------------------------------------------------
r228 | karp | 2002-06-19 00:27:03 -0400 (Wed, 19 Jun 2002) | 2 lines

Added print-out for Ipv4 and IPv6 cases in read_id2class

------------------------------------------------------------------------
r227 | karp | 2002-06-18 20:06:22 -0400 (Tue, 18 Jun 2002) | 10 lines

Parser reads and prints KID part of id2class mapping (IPv4 is easy
and I just need to add hex-encoding or reverse numeric-to-ASCII mapping
to be able to print IPv6 part). Saving data in a hash is finished
completely (for all three types).

To test: similar to what was in owampd (ignoring error-checking)

PolicyInit2(eh, ip2class, class2limits, passwd, &out);
I2hash_print(policy->ip2class, stdout);

------------------------------------------------------------------------
r226 | karp | 2002-06-18 17:42:03 -0400 (Tue, 18 Jun 2002) | 2 lines

More warnings removed

------------------------------------------------------------------------
r225 | karp | 2002-06-18 17:13:05 -0400 (Tue, 18 Jun 2002) | 2 lines

Fixed warnings.

------------------------------------------------------------------------
r224 | karp | 2002-06-18 16:36:53 -0400 (Tue, 18 Jun 2002) | 2 lines

Added prototype for OWPrand_context_free

------------------------------------------------------------------------
r223 | karp | 2002-06-18 15:56:17 -0400 (Tue, 18 Jun 2002) | 2 lines

owamp_read_id2class() understands ipv6 now.

------------------------------------------------------------------------
r222 | karp | 2002-06-17 01:34:59 -0400 (Mon, 17 Jun 2002) | 2 lines

Simplified logic in owamp_read_id2class().

------------------------------------------------------------------------
r221 | karp | 2002-06-15 22:20:15 -0400 (Sat, 15 Jun 2002) | 2 lines

Correctly recognize legal IPv4 and IPv6 masks.

------------------------------------------------------------------------
r220 | karp | 2002-06-14 21:20:46 -0400 (Fri, 14 Jun 2002) | 2 lines

Added access2.c to the list of source files.

------------------------------------------------------------------------
r219 | karp | 2002-06-14 21:20:17 -0400 (Fri, 14 Jun 2002) | 2 lines

Initial import. Started work on ipv6 policy.

------------------------------------------------------------------------
r218 | boote | 2002-06-14 17:05:22 -0400 (Fri, 14 Jun 2002) | 4 lines

m4 macro for __attribute__ check...

jeff

------------------------------------------------------------------------
r217 | boote | 2002-06-14 17:01:51 -0400 (Fri, 14 Jun 2002) | 4 lines

Adding check for __attribute__.

jeff

------------------------------------------------------------------------
r216 | boote | 2002-06-14 17:00:50 -0400 (Fri, 14 Jun 2002) | 59 lines

LOTS of cleanup. The owping/owampd directories may no longer compile due to
changes here - but I really wanted to get this checked in because I have made a
number of changes.

Generically, one major change was that I removed the OWPByte type and replaced
it everywhere with u_int8_t - I decided it was just easier to explicitly state
the types we want. If /sys/types.h doesn't exist on a platform, we will need
to figure out a reasonable byte type for that platform anyway - and we can
just define u_int8_t ourselves for those systems.


Makefile.am:
	added dependancy to owpcontrib library.

api.c:
	mostly cleanup - initialization of cntrl->zero field.

capi.c:
	Lots of misc fixes - changed the "protocol" functions that it calls.
context.c:
	Byte change
error.c:
	__attribute__ cleanup
io.c:
	size_t <=> ssize_t mismatches made error reporting impossible.
	Byte changes
owamp.h:
	changed a number of include files
	changed the prototypes for functions
	removed bit fields
	cleaned up namespace
owampP.h:
	added __attribute__ macro test
	modified includes
	made constants more consistant
	added state constants and macros
	Byte changes
	Added OWPAcceptType
	Added all the protocol.c prototypes
sapi.c:
	LOTS of changes to reflect that most of what was here, is now done
	in protocol.c
time.c:
	Byte changes - memory alignment changes.

protocol.c:
	All reads/writes specific to protocol messages is now in this
	file. Had to do a bunch of changes to fix memory alignment (easy
	to do - but had to look through everything to make sure it was
	done.) This replaced both cprotocol.c and sprotocol.c - each
	protocol message now has a read and a write function for it, and
	as little "smarts" as possible - essentially these are formatting
	functions - although I have started to put the "state" machine
	in them, because the "state" of the connection can be determined
	by the last protocol message recieved and/or sent. The "state"
	stuff is NOT currently consistant however, and needs work.

jeff

------------------------------------------------------------------------
r215 | karp | 2002-06-12 13:13:49 -0400 (Wed, 12 Jun 2002) | 2 lines

Added OWP prefix to all symbols.

------------------------------------------------------------------------
r214 | karp | 2002-06-12 12:42:01 -0400 (Wed, 12 Jun 2002) | 2 lines

Moved all static data into context to be passed.

------------------------------------------------------------------------
r213 | karp | 2002-06-12 11:00:56 -0400 (Wed, 12 Jun 2002) | 2 lines

More clean-up.

------------------------------------------------------------------------
r212 | karp | 2002-06-11 20:35:09 -0400 (Tue, 11 Jun 2002) | 2 lines

Match latest changes to arithm128.c

------------------------------------------------------------------------
r211 | karp | 2002-06-11 20:34:36 -0400 (Tue, 11 Jun 2002) | 4 lines

Added a chunk of the future RFC. Renamed num_128 to num128,
num_add() to num128_add(), and num_mul() to num128_mul().
Removed auxilliary/debug functions - much leaner file now.

------------------------------------------------------------------------
r210 | karp | 2002-06-11 16:18:05 -0400 (Tue, 11 Jun 2002) | 2 lines

Implemented timeval2num() conversion function.

------------------------------------------------------------------------
r209 | karp | 2002-06-11 00:14:24 -0400 (Tue, 11 Jun 2002) | 2 lines

Added prototype for bytes2Key().

------------------------------------------------------------------------
r208 | karp | 2002-06-10 19:21:35 -0400 (Mon, 10 Jun 2002) | 2 lines

Removed leftshift() and mask arrays. Lots of overall improvements.

------------------------------------------------------------------------
r207 | karp | 2002-06-10 00:28:17 -0400 (Mon, 10 Jun 2002) | 3 lines

Put in fixes to make code work on machines with any size of long
and short. Added 128-bit counter for generator of uniforms.

------------------------------------------------------------------------
r206 | karp | 2002-06-09 15:33:16 -0400 (Sun, 09 Jun 2002) | 5 lines

More reorganization and clean-up. Keep currently unused functions
static. Fixed a subtle bug in mask2 (hitting once every 256 times).
This version of exponential generator finally is in excellent
agreement with Anderson-Darling critical values.

------------------------------------------------------------------------
r205 | karp | 2002-06-09 01:15:18 -0400 (Sun, 09 Jun 2002) | 3 lines

Removed more unneeded code. Completely changed the interface to
match srand()/rand() approach.

------------------------------------------------------------------------
r204 | karp | 2002-06-08 19:07:53 -0400 (Sat, 08 Jun 2002) | 3 lines

Separated left shift into a separate function. Fixed many compiler
warnings.

------------------------------------------------------------------------
r203 | karp | 2002-06-07 17:11:11 -0400 (Fri, 07 Jun 2002) | 2 lines

Clean-up. Removed unnecessary comments.

------------------------------------------------------------------------
r202 | karp | 2002-06-07 17:04:20 -0400 (Fri, 07 Jun 2002) | 2 lines

Added 128-bit counters.

------------------------------------------------------------------------
r201 | karp | 2002-06-07 13:37:43 -0400 (Fri, 07 Jun 2002) | 2 lines

Improved precision in the 64th bit of Q[].

------------------------------------------------------------------------
r200 | karp | 2002-06-06 23:40:10 -0400 (Thu, 06 Jun 2002) | 2 lines

Quick check-in - fixed reuse of uniforms.

------------------------------------------------------------------------
r199 | boote | 2002-06-06 19:59:29 -0400 (Thu, 06 Jun 2002) | 7 lines

substaintial reorganization of the server code. I'm not done yet, but I wanted
to check in to check-point the work.

(This version compiles, but will definately not work.)

jeff

------------------------------------------------------------------------
r198 | karp | 2002-06-06 18:10:56 -0400 (Thu, 06 Jun 2002) | 2 lines

Algorithm is largely working - checking in for safety's sake.

------------------------------------------------------------------------
r197 | karp | 2002-06-05 22:50:17 -0400 (Wed, 05 Jun 2002) | 2 lines

Corrected small bugs - more work is needed.

------------------------------------------------------------------------
r196 | karp | 2002-06-05 18:28:12 -0400 (Wed, 05 Jun 2002) | 2 lines

Not needed anymore - implemented Knuth at home.

------------------------------------------------------------------------
r195 | karp | 2002-06-05 16:27:56 -0400 (Wed, 05 Jun 2002) | 2 lines

Essentially completed implementation of Knuth. Untested so far.

------------------------------------------------------------------------
r194 | karp | 2002-06-04 18:24:11 -0400 (Tue, 04 Jun 2002) | 2 lines

Added support for counter mode.

------------------------------------------------------------------------
r193 | karp | 2002-06-04 18:23:07 -0400 (Tue, 04 Jun 2002) | 2 lines

Started working on Knuth algorithm.

------------------------------------------------------------------------
r192 | karp | 2002-06-03 23:04:47 -0400 (Mon, 03 Jun 2002) | 2 lines

Tiny bug - updated arithm128 dependence.

------------------------------------------------------------------------
r191 | karp | 2002-06-03 23:01:52 -0400 (Mon, 03 Jun 2002) | 2 lines

Replaced arithm* with arithm128* source files.

------------------------------------------------------------------------
r190 | karp | 2002-06-03 23:00:38 -0400 (Mon, 03 Jun 2002) | 2 lines

Renamed and improved into arithm128*

------------------------------------------------------------------------
r189 | karp | 2002-06-03 22:59:18 -0400 (Mon, 03 Jun 2002) | 2 lines

Clean-up and better documentation. Renamed the file into arithm128*.{c,h}

------------------------------------------------------------------------
r188 | karp | 2002-06-03 13:17:54 -0400 (Mon, 03 Jun 2002) | 2 lines

Various improvements. Added more conversion functions.

------------------------------------------------------------------------
r187 | karp | 2002-06-03 01:12:23 -0400 (Mon, 03 Jun 2002) | 2 lines

Added conversion functions.

------------------------------------------------------------------------
r186 | boote | 2002-06-02 14:42:17 -0400 (Sun, 02 Jun 2002) | 33 lines

Reorganizing things...

Tolya - when you create new files please put a $Id$ comment header at the
beginning of the file. (I don't really care that much if you use the comment
script, but I really want the version number in there - it makes it much easier
to determin how out-of-date printout's are.)

Also - I moved your arithmatic out of I2util and put it into owamp - it is
difficult to imagine something more specific to owamp. I2util is for code
that is likely to be used for projects completely unrelated to owamp.

I'm thinking more and more about rolling all the owpcontrib code right into
the owamp directory, but I decided to leave it alone for now. Let me know
if you have opionions one way or the other about it.

Oh - I also broke up api.c into 3 files:
api.c
capi.c
sapi.c

api.c contains functions that are used by capi.c and sapi.c. capi.c is client
api functions and sapi.c is server api functions.

Now that I've reorganized the code to more easily digestable chunks, I'm going
to start taking some of the code from owampd and putting it in sapi.c, and
extending it to actually start test sessions.

(I probably won't get enough done today to check in again today - in fact,
considering what I will be doing, it will probably be a few days before I
check-in again.)

jeff

------------------------------------------------------------------------
r185 | boote | 2002-06-02 13:16:43 -0400 (Sun, 02 Jun 2002) | 48 lines

This version of owping/owampd will go all the way through making a test request
to the server. The server will just print out that a request happened.

owamp/
Makefile.am:
	adding time.c: functions for encoding/decoding struct timestamps
	to the format required for network transmittion.
api.c:
	Corrected default address mechanisms in NodeByAddr and related...

context.c:
	Corrected callendpointinithook function.

cprotocol.c:
	Added function that encodes TestRequests, and reads AcceptSession
	messages.

endpoint.c:
	Forgot to set the end_data_ret pointer in the init func...

io.c:
	Corrected the type used to return the value from the OWPReadn
	function - it was unable to detect an error condition.

owamp.h:
	Renamed OWPPoissonTestSpec to OWPTestSpecPoisson - names should
	go from general to specific, so the "family" of the type can
	be seen immediately.

owampP.h:
	Added time.c prototypes.

owampd/
owampd.c:
	#ifdef'd out problem hiding things. (Problems from children were
	being printed to a file instead of being seen in stderr where they
	would be noticed. And removed the "exit" - so the server would
	actually read a request.

owping/
owping.c:
	Added a "flush" for stderr because some error messages were getting
	lost. (I may remove this later - the error messages are showing now,
	but stderr should automatically be line buffered, so I need to
	figure out what is going on here...)
	Also modified how the "addr" code is called to reflect the corrections
	mentioned above in api.c.

------------------------------------------------------------------------
r184 | karp | 2002-05-31 18:26:33 -0400 (Fri, 31 May 2002) | 2 lines

Initial import - implementation of 128-bit arithmetic.

------------------------------------------------------------------------
r183 | karp | 2002-05-31 09:39:49 -0400 (Fri, 31 May 2002) | 2 lines

Fix to make things compile.

------------------------------------------------------------------------
r182 | karp | 2002-05-30 18:56:54 -0400 (Thu, 30 May 2002) | 2 lines

Bulk check-in to have a common base.

------------------------------------------------------------------------
r181 | boote | 2002-05-29 19:03:49 -0400 (Wed, 29 May 2002) | 7 lines

Added endpoint logic - the "meat" is not there yet.

owping currently core dumps because it passes in null addresses - I will
fix it tomorrow.

jeff

------------------------------------------------------------------------
r180 | boote | 2002-05-28 13:13:20 -0400 (Tue, 28 May 2002) | 22 lines

api.c:
	All the logic for making a test request - still need to fill in
	the details for local endpoints.
context.c:
	Modified the Policy functions a bit.
cprotocol.c:
	Started the stub for sending a test request to the server - will have
	it use the same structure Tolya is using to parse the request once
	he checks it in.
io.c:
	Added connect_tmout function.
owamp.h:
	modified addr structure prototype to include port.
owampP.h:
	added prototypes for context.c
owampd.c:
	Modified calls to functions I had changed.
owping.c:
	ditto

jeff

------------------------------------------------------------------------
r179 | karp | 2002-05-23 23:52:07 -0400 (Thu, 23 May 2002) | 2 lines

Minor bug fixes and clean-up. Added some error checks.

------------------------------------------------------------------------
r178 | karp | 2002-05-23 21:44:36 -0400 (Thu, 23 May 2002) | 2 lines

Improved handling of EINTR in select().

------------------------------------------------------------------------
r177 | karp | 2002-05-23 18:40:26 -0400 (Thu, 23 May 2002) | 8 lines

Child is ready for testing Control session now. Server can simply
be started from command line by typing:

./owampd

(it will bind to port 5555 and begin accepting connections.
Will Control part work? I don't know yet.)

------------------------------------------------------------------------
r176 | karp | 2002-05-23 16:46:42 -0400 (Thu, 23 May 2002) | 2 lines

Parent correctly manages fd_set now.

------------------------------------------------------------------------
r175 | karp | 2002-05-22 18:33:01 -0400 (Wed, 22 May 2002) | 2 lines

Fixed a bug in OWPServerReadRequest().

------------------------------------------------------------------------
r174 | boote | 2002-05-22 12:57:09 -0400 (Wed, 22 May 2002) | 4 lines

Oops - typo already....

jeff

------------------------------------------------------------------------
r173 | boote | 2002-05-22 12:55:12 -0400 (Wed, 22 May 2002) | 5 lines

Added ability to specify nodenames with rfc2396/rfc2732 service specifiers.
(i.e. "node:service" syntax.)

jeff

------------------------------------------------------------------------
r172 | karp | 2002-05-22 12:31:27 -0400 (Wed, 22 May 2002) | 4 lines

Rewrote server skeleton to make use of parent-child communication
via pipes. The code is still quite raw, and much needs to be
improved.

------------------------------------------------------------------------
r171 | boote | 2002-05-22 12:25:40 -0400 (Wed, 22 May 2002) | 4 lines

Adding port to Addr struct.

jeff

------------------------------------------------------------------------
r170 | boote | 2002-05-22 11:42:52 -0400 (Wed, 22 May 2002) | 5 lines

moved connect_tmout to io.c and renamed _OWPConnect - modified port number
for control to 5555.

jeff

------------------------------------------------------------------------
r169 | karp | 2002-05-20 23:44:16 -0400 (Mon, 20 May 2002) | 4 lines

Minor clean-up. Sorted out _OWPCallCheckControlPolicy() call.

Doesn't compile yet due to timevalclear and others...

------------------------------------------------------------------------
r168 | karp | 2002-05-20 23:41:30 -0400 (Mon, 20 May 2002) | 2 lines

Added OWP_ prefix to OPEN_CLASS, AUTH_CLASS and BANNED_CLASS

------------------------------------------------------------------------
r167 | boote | 2002-05-20 19:11:20 -0400 (Mon, 20 May 2002) | 7 lines

api.c
	fixed bug in ClientConnect code.
error.c
	fixed bug in sizeof buffer args - caused error messages to be corrupt.

jeff

------------------------------------------------------------------------
r166 | boote | 2002-05-20 18:50:09 -0400 (Mon, 20 May 2002) | 12 lines

bootstrap:
	add call to configure

owamp/api.c
	fixed connect_tmout - I will probably move this function to
	io once I'm sure it all compiles.

owpcontrib/access.h.in
	Added default value for OWP_PREFIX to headerfile.

jeff

------------------------------------------------------------------------
r165 | karp | 2002-05-20 17:54:10 -0400 (Mon, 20 May 2002) | 2 lines

Fixed location of parentheses.

------------------------------------------------------------------------
r164 | karp | 2002-05-20 17:51:43 -0400 (Mon, 20 May 2002) | 3 lines

Improved check_control() function. Cleaner logic in read/process request
loop (as discussed on the way to Ben).

------------------------------------------------------------------------
r163 | karp | 2002-05-20 17:49:35 -0400 (Mon, 20 May 2002) | 2 lines

Stream-lined usage class names - added OWP_ prefix.

------------------------------------------------------------------------
r162 | karp | 2002-05-20 17:47:34 -0400 (Mon, 20 May 2002) | 2 lines

Clean-up. Removed unused functions OWPSendServerGreeting and others.

------------------------------------------------------------------------
r161 | karp | 2002-05-20 17:45:28 -0400 (Mon, 20 May 2002) | 2 lines

#defines for Control message lengths

------------------------------------------------------------------------
r160 | karp | 2002-05-20 17:43:38 -0400 (Mon, 20 May 2002) | 3 lines

Added #defines for OWP_CTRL_* Control protocol message types,
and prototype for OWPServerReadRequest().

------------------------------------------------------------------------
r159 | karp | 2002-05-20 17:41:48 -0400 (Mon, 20 May 2002) | 2 lines

Added robustness to OWPControlAccept().

------------------------------------------------------------------------
r158 | karp | 2002-05-17 22:57:53 -0400 (Fri, 17 May 2002) | 9 lines

Some clean-up of things not being used right now.

Bug fixes in owamp_first_check(), fixed check_control() prototype.

Fixed a bug with the number of args in OWPServerCheckAddrPolicy(... NULL...)
which caused me some core dumps and torturous debugging. Wouldn't happen
if I had put a prototype in owamp.h (grrrrr) -
thanks for the lesson, Jeff! -:)

------------------------------------------------------------------------
r157 | karp | 2002-05-17 22:51:14 -0400 (Fri, 17 May 2002) | 2 lines

Improve parsing passwd file.

------------------------------------------------------------------------
r156 | karp | 2002-05-17 22:45:47 -0400 (Fri, 17 May 2002) | 2 lines

Added prototypes for OWPGetContext() and OWPServerCheckAddrPolicy().

------------------------------------------------------------------------
r155 | boote | 2002-05-16 20:38:50 -0400 (Thu, 16 May 2002) | 4 lines

check-point last week of work.

jeff

------------------------------------------------------------------------
r154 | boote | 2002-05-16 17:53:10 -0400 (Thu, 16 May 2002) | 4 lines

Fix for conf_dir and adding gettimeofday interface.

jeff

------------------------------------------------------------------------
r153 | karp | 2002-05-16 16:04:10 -0400 (Thu, 16 May 2002) | 2 lines

Fixed return type of owamp_nimberize.

------------------------------------------------------------------------
r152 | karp | 2002-05-16 15:44:53 -0400 (Thu, 16 May 2002) | 2 lines

Commented out _OWPSendServerGreeting and _OWPReadServerGreeting

------------------------------------------------------------------------
r151 | karp | 2002-05-16 15:43:42 -0400 (Thu, 16 May 2002) | 2 lines

Incorporated removal of challenge field from OWPControl.

------------------------------------------------------------------------
r150 | karp | 2002-05-16 15:35:04 -0400 (Thu, 16 May 2002) | 2 lines

Quick check-in while everything still compiles.

------------------------------------------------------------------------
r149 | karp | 2002-05-14 18:12:01 -0400 (Tue, 14 May 2002) | 2 lines

Replaced OWPContext by OWPControl argument in _OWPCallCheckTestPolicy().

------------------------------------------------------------------------
r148 | karp | 2002-05-13 21:51:14 -0400 (Mon, 13 May 2002) | 2 lines

Simple bc script to compute Q[] series from Knuth algorithm.

------------------------------------------------------------------------
r147 | karp | 2002-05-13 21:39:31 -0400 (Mon, 13 May 2002) | 2 lines

Computed hex-encoded Q[] values for Knuth S algorithm.

------------------------------------------------------------------------
r146 | boote | 2002-05-11 17:52:36 -0400 (Sat, 11 May 2002) | 7 lines

I believe a full build will not work.

Tolya - I ifdef'd out ControlAccept since it isn't compiling right now. I'll
let you correct the problmes and add it back in.

jeff

------------------------------------------------------------------------
r145 | boote | 2002-05-11 16:14:39 -0400 (Sat, 11 May 2002) | 4 lines

Corrected a few bugs.

jeff

------------------------------------------------------------------------
r144 | boote | 2002-05-11 04:34:21 -0400 (Sat, 11 May 2002) | 16 lines

Renaming contrib to owpcontrib.

Modified the OWP_CONF_DIR flag to be set relative to a "prefix" that is set
as autoconf normally would. - this took renaming access.h to access.h.in and
having autoconf parse it and make changes.

api.c:
Added a connect_tmout to api.c

Corrected logic for CheckControlPolicy checks.

owping:
A bit more - won't currently compile.

jeff

------------------------------------------------------------------------
r143 | karp | 2002-05-10 17:58:30 -0400 (Fri, 10 May 2002) | 2 lines

Removed OWPAddrCheck() - not needed.

------------------------------------------------------------------------
r142 | karp | 2002-05-08 18:14:44 -0400 (Wed, 08 May 2002) | 15 lines

Implementation of uniform and exponential distributions following
the original Marsaglia-Ahrens (1972) algorithm as described in
Knuth (1998), with latest improvements. Culled from the libranlib
C library for random number generators.

Usage: float genexp(float mu);

will generate successive draws from exponential distribution
with mean mu. (I've just generated 200 of those and visually it
looks good).

Current implementation is using made on-the-spot uniform draws.
Alternative is to use system-provided random() to get the
uniform deviates as input for the algorithm.

------------------------------------------------------------------------
r141 | karp | 2002-05-03 17:32:37 -0400 (Fri, 03 May 2002) | 2 lines

Some clean-up. Removed policy init into a separate function.

------------------------------------------------------------------------
r140 | karp | 2002-05-03 17:30:55 -0400 (Fri, 03 May 2002) | 2 lines

Added prototypes and main loop inside Control session.

------------------------------------------------------------------------
r139 | karp | 2002-05-03 17:04:15 -0400 (Fri, 03 May 2002) | 2 lines

Add typedef for policy_data.

------------------------------------------------------------------------
r138 | karp | 2002-05-03 17:02:03 -0400 (Fri, 03 May 2002) | 13 lines

Fix prototype for owamp_read_class2limits.

Provide
policy_data *PolicyInit(
	   OWPContext ctx,
	   char *ip2class_file,
	   char *class2limits_file,
	   char *passwd_file,
	   OWPErrSeverity *err_ret
	   );

which applications can use to initialize policy database.

------------------------------------------------------------------------
r137 | karp | 2002-05-03 16:53:43 -0400 (Fri, 03 May 2002) | 3 lines

Initial import for print.c - basic hash print-out functions
are isolated there.

------------------------------------------------------------------------
r136 | karp | 2002-05-03 16:51:29 -0400 (Fri, 03 May 2002) | 11 lines

This allows applications (owampd for now) access config directory as
OWP_CONF_DIR. Temporary solution, hopefully to be replaced using
autoheader.

Jeff, I did some reading on AC_CONFIG_HEADER but I am still
not comfortable using it. I don't want to spend too much time
on it - I am making this commit just so I can get on with
the rest of the server.

--Tolya

------------------------------------------------------------------------
r135 | boote | 2002-05-02 14:56:29 -0400 (Thu, 02 May 2002) | 8 lines

My changes now compile.

I added some dependency stuff to the Makefile.am in owping.

tolya - that same dependency stuff might be useful in owampd...

jeff

------------------------------------------------------------------------
r134 | boote | 2002-05-02 13:51:12 -0400 (Thu, 02 May 2002) | 5 lines

Removing kid - and updating owping to latest. Don't update until after my next
check-in, I still need to verify compilation.

jeff

------------------------------------------------------------------------
r133 | karp | 2002-05-01 14:48:07 -0400 (Wed, 01 May 2002) | 2 lines

Not need to update IV as this is done in rijndael api now. Added banner.

------------------------------------------------------------------------
r132 | karp | 2002-05-01 14:26:28 -0400 (Wed, 01 May 2002) | 2 lines

Update owampd skeleton to have things compile.

------------------------------------------------------------------------
r131 | karp | 2002-05-01 14:14:20 -0400 (Wed, 01 May 2002) | 2 lines

sprotocol.c

------------------------------------------------------------------------
r130 | karp | 2002-05-01 14:12:28 -0400 (Wed, 01 May 2002) | 4 lines

Fixed rijndael API to update IV automatically during blockEncrypt/
blockDecrypt so that libowamp (_OWPEncryptBlocks and _OWPDecryptBlocks)
need not worry about it at all.

------------------------------------------------------------------------
r129 | boote | 2002-04-30 14:32:24 -0400 (Tue, 30 Apr 2002) | 4 lines

reverse if test to make more clear.

jeff

------------------------------------------------------------------------
r128 | boote | 2002-04-30 14:31:40 -0400 (Tue, 30 Apr 2002) | 5 lines

owping will compile now. Because the configure.ac file changed - you need
to ./bootstrap after updating to this.

jeff

------------------------------------------------------------------------
r127 | karp | 2002-04-30 13:23:45 -0400 (Tue, 30 Apr 2002) | 2 lines

Updated to make use of latest additions to the api.

------------------------------------------------------------------------
r126 | boote | 2002-04-30 12:43:34 -0400 (Tue, 30 Apr 2002) | 4 lines

forgot to add owpingP.h as source file...

jeff

------------------------------------------------------------------------
r125 | boote | 2002-04-30 12:42:59 -0400 (Tue, 30 Apr 2002) | 15 lines

owping first real check-in. Not real functional, but at least gives an
outline. Does not implement policy hooks yet. (Should be able to use exact
same ones as owampd after cleanup.)

I2util/I2util/
	table.c:made sure default compare function doesn't overrun memory.

owping/
Makefile.am:	added localaddr template - still working on code.
owping.c:	organized.
localaddr.[ch]	localaddr template.
owpingP.h:	typedefs for owping.

jeff

------------------------------------------------------------------------
r124 | karp | 2002-04-30 12:36:49 -0400 (Tue, 30 Apr 2002) | 2 lines

Removed unused code.

------------------------------------------------------------------------
r123 | karp | 2002-04-30 12:35:38 -0400 (Tue, 30 Apr 2002) | 2 lines

Replaced old key field by encrypt_key and decrypt_key in OWPControlRec.

------------------------------------------------------------------------
r122 | karp | 2002-04-30 12:31:20 -0400 (Tue, 30 Apr 2002) | 7 lines

Removed send_blocks().

Added 	_OWPSendBlocks(OWPControl cntrl, char* buf, int num_blocks),
	_OWPReceiveBlocks(OWPControl cntrl, char* buf, int num_blocks),
	_OWPEncryptBlocks(OWPControl cntrl,char *buf,int num_blocks,char *out)
	_OWPDecryptBlocks(OWPControl cntrl,char *buf,int num_blocks,char *out)

------------------------------------------------------------------------
r121 | karp | 2002-04-30 12:24:50 -0400 (Tue, 30 Apr 2002) | 6 lines

Added _OWPMakeKey(OWPControl cntrl, OWPByte *binKey),
	OWPEncryptToken(char *binKey, char *token_in, char *token_out),
	OWPDecryptToken(char *binKey, char *token_in, char *token_out).

Minor clean-up.

------------------------------------------------------------------------
r120 | boote | 2002-04-30 11:15:44 -0400 (Tue, 30 Apr 2002) | 2 lines

table change.

------------------------------------------------------------------------
r119 | boote | 2002-04-30 11:12:40 -0400 (Tue, 30 Apr 2002) | 4 lines

wrong include syntax.

jeff

------------------------------------------------------------------------
r118 | boote | 2002-04-30 09:43:49 -0400 (Tue, 30 Apr 2002) | 17 lines

Removed references to old table symbols are replaced them with I2hash_init
etc...

(I need to verify this compiles on a system up there - so expect another ci
shortly.)

I also changed the table code to use the I2ErrLog stuff instead of OWPError.

Tolya - I think it would be much cleaner to remove the hash functions from
owampd - and put them all into access.[ch]. I don't see any reason why
owamp_read_ip2class, owamp_read_class2limits, and read_passwd_file couldn't
call I2hash_init themselves and return the hash_table as the return value of
the function. You could still call I2hash_print for debugging purposes - but
the code could be much cleaner this way. What do you think?

jeff

------------------------------------------------------------------------
r117 | boote | 2002-04-26 18:43:35 -0400 (Fri, 26 Apr 2002) | 4 lines

Adding options to link in I2util from owamp directories.

jeff

------------------------------------------------------------------------
r116 | karp | 2002-04-26 17:37:46 -0400 (Fri, 26 Apr 2002) | 2 lines

Remove unnneded field-setting functions.

------------------------------------------------------------------------
r115 | karp | 2002-04-26 17:22:55 -0400 (Fri, 26 Apr 2002) | 2 lines

Trimmed down rijndael api, keeping only what's necessary.

------------------------------------------------------------------------
r114 | karp | 2002-04-26 13:00:17 -0400 (Fri, 26 Apr 2002) | 2 lines

Changed OWPAESGetKeyFunc prototype to use OWPByte* key_ret.

------------------------------------------------------------------------
r113 | karp | 2002-04-26 00:12:40 -0400 (Fri, 26 Apr 2002) | 2 lines

Removed send_data and OWPServerOK

------------------------------------------------------------------------
r112 | karp | 2002-04-26 00:11:42 -0400 (Fri, 26 Apr 2002) | 2 lines

Minor typo corrected.

------------------------------------------------------------------------
r111 | karp | 2002-04-26 00:10:40 -0400 (Fri, 26 Apr 2002) | 2 lines

Added _OWPSendServerGreeting(), _OWPReadClientGreeting() and _OWPServerOK().

------------------------------------------------------------------------
r110 | karp | 2002-04-26 00:08:15 -0400 (Fri, 26 Apr 2002) | 2 lines

Started work on block IO.

------------------------------------------------------------------------
r109 | karp | 2002-04-26 00:06:28 -0400 (Fri, 26 Apr 2002) | 2 lines

Broke down OWPControlAccept() into protocol-driven pieces.

------------------------------------------------------------------------
r108 | boote | 2002-04-25 12:43:14 -0400 (Thu, 25 Apr 2002) | 4 lines

fix double alloc bug - clean up error handling in client_connect and client_open.

jeff

------------------------------------------------------------------------
r107 | boote | 2002-04-25 12:23:28 -0400 (Thu, 25 Apr 2002) | 4 lines

test code - needs work before it can be added to build process.

jeff

------------------------------------------------------------------------
r106 | karp | 2002-04-25 11:47:28 -0400 (Thu, 25 Apr 2002) | 2 lines

(Re)moved random_bytes().

------------------------------------------------------------------------
r105 | karp | 2002-04-25 11:46:38 -0400 (Thu, 25 Apr 2002) | 2 lines

Added random.c to the source files list.

------------------------------------------------------------------------
r104 | karp | 2002-04-25 11:46:02 -0400 (Thu, 25 Apr 2002) | 2 lines

Initial import.

------------------------------------------------------------------------
r103 | boote | 2002-04-25 11:43:32 -0400 (Thu, 25 Apr 2002) | 4 lines

Added support to build sub-package I2util.

jeff

------------------------------------------------------------------------
r102 | karp | 2002-04-25 01:40:48 -0400 (Thu, 25 Apr 2002) | 2 lines

Removed OWPKey

------------------------------------------------------------------------
r101 | karp | 2002-04-25 01:40:21 -0400 (Thu, 25 Apr 2002) | 2 lines

Added prototype for random_bytes()

------------------------------------------------------------------------
r100 | karp | 2002-04-25 01:28:58 -0400 (Thu, 25 Apr 2002) | 2 lines

Moved random_bytes from owampd.c to api.c

------------------------------------------------------------------------
r99 | karp | 2002-04-24 23:17:49 -0400 (Wed, 24 Apr 2002) | 5 lines

Fake commit - botched putting proper log message for the last one.
In the last one: got rid of doit() and started breaking up its
code into OWP* functions. Re-did main() to make more consistent
use of these functions.

------------------------------------------------------------------------
r98 | karp | 2002-04-24 23:14:03 -0400 (Wed, 24 Apr 2002) | 2 lines

*** empty log message ***

------------------------------------------------------------------------
r97 | karp | 2002-04-24 23:09:26 -0400 (Wed, 24 Apr 2002) | 2 lines

Got rid of OWPKey.

------------------------------------------------------------------------
r96 | karp | 2002-04-24 23:09:02 -0400 (Wed, 24 Apr 2002) | 2 lines

Fixed prototype for OWPControlAccept().

------------------------------------------------------------------------
r95 | karp | 2002-04-24 23:06:29 -0400 (Wed, 24 Apr 2002) | 3 lines

Replaced OWPKey by OWPByte[16] everywhere. Started redoing OWPControlAccept() -
not finished yet. Added OWPAddrCheck().

------------------------------------------------------------------------
r94 | karp | 2002-04-24 22:58:07 -0400 (Wed, 24 Apr 2002) | 2 lines

Added sprotocol.c to the sources list.

------------------------------------------------------------------------
r93 | karp | 2002-04-24 02:24:31 -0400 (Wed, 24 Apr 2002) | 2 lines

Removed a lot server code to be placed in OWPControlAccept.

------------------------------------------------------------------------
r92 | karp | 2002-04-24 02:23:05 -0400 (Wed, 24 Apr 2002) | 2 lines

Added prototype for OWPControlAccept().

------------------------------------------------------------------------
r91 | karp | 2002-04-24 02:22:25 -0400 (Wed, 24 Apr 2002) | 2 lines

Started work on OWPControlAccept().

------------------------------------------------------------------------
r90 | boote | 2002-04-23 15:06:06 -0400 (Tue, 23 Apr 2002) | 4 lines

This version compiles.

jeff

------------------------------------------------------------------------
r89 | boote | 2002-04-23 14:39:38 -0400 (Tue, 23 Apr 2002) | 4 lines

check-point files: COMPILE NOT TESTED YET - don't update to these.

jeff

------------------------------------------------------------------------
r88 | karp | 2002-04-23 12:47:00 -0400 (Tue, 23 Apr 2002) | 2 lines

Some clean-up - pass hash and Context pointers as function arguments.

------------------------------------------------------------------------
r87 | karp | 2002-04-23 01:01:10 -0400 (Tue, 23 Apr 2002) | 2 lines

Largely finished Control connection set-up.

------------------------------------------------------------------------
r86 | karp | 2002-04-23 00:59:42 -0400 (Tue, 23 Apr 2002) | 2 lines

Added some function prototype docs.

------------------------------------------------------------------------
r85 | karp | 2002-04-23 00:58:24 -0400 (Tue, 23 Apr 2002) | 2 lines

Added function to set writeIV, readIV and session_key in OWPControl.

------------------------------------------------------------------------
r84 | karp | 2002-04-23 00:57:26 -0400 (Tue, 23 Apr 2002) | 2 lines

Changed writeIV, readIV, challenge and session_key types to unsigned char.

------------------------------------------------------------------------
r83 | karp | 2002-04-22 23:38:45 -0400 (Mon, 22 Apr 2002) | 2 lines

Added io.c

------------------------------------------------------------------------
r82 | karp | 2002-04-22 14:44:32 -0400 (Mon, 22 Apr 2002) | 2 lines

Changed readIV/writeIV types for smooth interaction with rijndael API.

------------------------------------------------------------------------
r81 | boote | 2002-04-22 13:37:39 -0400 (Mon, 22 Apr 2002) | 4 lines

Modified fields.

jeff

------------------------------------------------------------------------
r80 | karp | 2002-04-22 12:58:56 -0400 (Mon, 22 Apr 2002) | 2 lines

Moved readn() and writen() to owamp/io.c

------------------------------------------------------------------------
r79 | karp | 2002-04-22 12:00:42 -0400 (Mon, 22 Apr 2002) | 2 lines

Initial import.

------------------------------------------------------------------------
r78 | karp | 2002-04-20 01:07:54 -0400 (Sat, 20 Apr 2002) | 2 lines

Completely re-did printing out of hash tables.

------------------------------------------------------------------------
r77 | karp | 2002-04-20 01:04:48 -0400 (Sat, 20 Apr 2002) | 2 lines

Initial import. Trivial main().

------------------------------------------------------------------------
r76 | karp | 2002-04-20 01:04:18 -0400 (Sat, 20 Apr 2002) | 2 lines

Added owping.c to the list of source files.

------------------------------------------------------------------------
r75 | karp | 2002-04-20 01:02:49 -0400 (Sat, 20 Apr 2002) | 2 lines

Embedded print-out facilities inside the hash table itself.

------------------------------------------------------------------------
r74 | karp | 2002-04-20 01:00:55 -0400 (Sat, 20 Apr 2002) | 2 lines

Added function limits2datum. Minor cleanup in owamp_read_class2limits.

------------------------------------------------------------------------
r73 | karp | 2002-04-19 13:58:03 -0400 (Fri, 19 Apr 2002) | 2 lines

Updated to use home-made hash instead of ndbm.

------------------------------------------------------------------------
r72 | karp | 2002-04-19 13:55:23 -0400 (Fri, 19 Apr 2002) | 2 lines

Temporary plug to have things compile.

------------------------------------------------------------------------
r71 | karp | 2002-04-19 13:53:56 -0400 (Fri, 19 Apr 2002) | 2 lines

Changed to use home-made hash instead of ndbm.

------------------------------------------------------------------------
r70 | karp | 2002-04-19 13:53:02 -0400 (Fri, 19 Apr 2002) | 2 lines

Added table.h and table.c to source file list.

------------------------------------------------------------------------
r69 | karp | 2002-04-19 13:51:06 -0400 (Fri, 19 Apr 2002) | 2 lines

Initial import.

------------------------------------------------------------------------
r68 | boote | 2002-04-18 12:22:06 -0400 (Thu, 18 Apr 2002) | 4 lines

Adding rijndael functions into libowamp.a

jeff

------------------------------------------------------------------------
r67 | boote | 2002-04-18 12:02:04 -0400 (Thu, 18 Apr 2002) | 4 lines

test-hash should not be a "test" - it is part of the library.

jeff

------------------------------------------------------------------------
r66 | boote | 2002-04-18 10:58:33 -0400 (Thu, 18 Apr 2002) | 4 lines

Adding checks into the code for problems found at "configure" time.

jeff

------------------------------------------------------------------------
r65 | boote | 2002-04-17 18:26:14 -0400 (Wed, 17 Apr 2002) | 4 lines

moved test-hash back to contrib where it should have been.

jeff

------------------------------------------------------------------------
r64 | boote | 2002-04-17 18:18:49 -0400 (Wed, 17 Apr 2002) | 4 lines

Errg - sometime cvs is annoying.

jeff

------------------------------------------------------------------------
r63 | boote | 2002-04-17 18:17:50 -0400 (Wed, 17 Apr 2002) | 2 lines

Missed this one...

------------------------------------------------------------------------
r62 | boote | 2002-04-17 18:00:56 -0400 (Wed, 17 Apr 2002) | 4 lines

first cut and using gnu autobuild tools.

jeff

------------------------------------------------------------------------
r61 | karp | 2002-04-17 16:15:47 -0400 (Wed, 17 Apr 2002) | 2 lines

Updated to use ../owamp instead of ../libowamp.

------------------------------------------------------------------------
r60 | karp | 2002-04-17 15:35:28 -0400 (Wed, 17 Apr 2002) | 2 lines

Now that we have owamp.h don't need home-made defines anymore.

------------------------------------------------------------------------
r59 | karp | 2002-04-17 15:34:42 -0400 (Wed, 17 Apr 2002) | 2 lines

Seaparated server code into owampd.

------------------------------------------------------------------------
r58 | karp | 2002-04-17 15:32:40 -0400 (Wed, 17 Apr 2002) | 2 lines

Initial import.

------------------------------------------------------------------------
r57 | karp | 2002-04-17 12:50:21 -0400 (Wed, 17 Apr 2002) | 2 lines

Remove more hidden Stevens bits

------------------------------------------------------------------------
r56 | karp | 2002-04-17 01:56:38 -0400 (Wed, 17 Apr 2002) | 2 lines

Removing.

------------------------------------------------------------------------
r55 | karp | 2002-04-17 01:54:40 -0400 (Wed, 17 Apr 2002) | 2 lines

Removing

------------------------------------------------------------------------
r54 | karp | 2002-04-17 01:50:59 -0400 (Wed, 17 Apr 2002) | 2 lines

Cosmetic change.

------------------------------------------------------------------------
r53 | karp | 2002-04-17 01:50:25 -0400 (Wed, 17 Apr 2002) | 2 lines

Made all error-reporting consistent with libowamp.

------------------------------------------------------------------------
r52 | karp | 2002-04-16 18:35:41 -0400 (Tue, 16 Apr 2002) | 2 lines

Start incorporating libowamp functions.

------------------------------------------------------------------------
r51 | karp | 2002-04-16 18:34:51 -0400 (Tue, 16 Apr 2002) | 2 lines

Added syslog support, changed field name in owamp_limits

------------------------------------------------------------------------
r50 | karp | 2002-04-16 18:29:32 -0400 (Tue, 16 Apr 2002) | 2 lines

Commented out a few little bits and added two stubs to make compile.

------------------------------------------------------------------------
r49 | boote | 2002-04-16 15:51:10 -0400 (Tue, 16 Apr 2002) | 4 lines

Fix func pointers.

jeff

------------------------------------------------------------------------
r48 | karp | 2002-04-16 11:25:58 -0400 (Tue, 16 Apr 2002) | 2 lines

Added banner and ident info.

------------------------------------------------------------------------
r47 | karp | 2002-04-15 17:24:52 -0400 (Mon, 15 Apr 2002) | 2 lines

Changed EXTRACT_ALL to NO.

------------------------------------------------------------------------
r46 | karp | 2002-04-15 16:40:51 -0400 (Mon, 15 Apr 2002) | 2 lines

Exclude test patterns. Separate sources from comments.

------------------------------------------------------------------------
r45 | karp | 2002-04-15 15:59:23 -0400 (Mon, 15 Apr 2002) | 2 lines

Initial import.

------------------------------------------------------------------------
r44 | karp | 2002-04-15 12:12:39 -0400 (Mon, 15 Apr 2002) | 2 lines

Minor fix.

------------------------------------------------------------------------
r43 | karp | 2002-04-15 12:04:58 -0400 (Mon, 15 Apr 2002) | 2 lines

Included <sys/time.h> and <sys/param.h>

------------------------------------------------------------------------
r42 | boote | 2002-04-15 10:26:28 -0400 (Mon, 15 Apr 2002) | 4 lines

check-point - this at least compiles.

jeff

------------------------------------------------------------------------
r41 | karp | 2002-04-15 03:38:42 -0400 (Mon, 15 Apr 2002) | 2 lines

Initial import.

------------------------------------------------------------------------
r40 | karp | 2002-04-15 03:31:50 -0400 (Mon, 15 Apr 2002) | 2 lines

Initial import.

------------------------------------------------------------------------
r39 | karp | 2002-04-15 03:27:24 -0400 (Mon, 15 Apr 2002) | 2 lines

Initial import for rijndael.

------------------------------------------------------------------------
r38 | karp | 2002-04-15 03:25:20 -0400 (Mon, 15 Apr 2002) | 2 lines

Added processing of client greeting.

------------------------------------------------------------------------
r37 | karp | 2002-04-14 19:12:14 -0400 (Sun, 14 Apr 2002) | 2 lines

Initial import.

------------------------------------------------------------------------
r36 | karp | 2002-04-14 19:11:18 -0400 (Sun, 14 Apr 2002) | 2 lines

Major rewrite.

------------------------------------------------------------------------
r35 | karp | 2002-04-14 19:10:42 -0400 (Sun, 14 Apr 2002) | 2 lines

Moved test functions to test-hash.c

------------------------------------------------------------------------
r34 | boote | 2002-04-12 18:33:37 -0400 (Fri, 12 Apr 2002) | 4 lines

check-point.

jeff

------------------------------------------------------------------------
r33 | boote | 2002-04-12 16:06:37 -0400 (Fri, 12 Apr 2002) | 4 lines

Add a few new fields...

jeff

------------------------------------------------------------------------
r32 | karp | 2002-04-12 14:26:44 -0400 (Fri, 12 Apr 2002) | 2 lines

Added random_byte. Minor cosmetic changes.

------------------------------------------------------------------------
r31 | karp | 2002-04-11 18:10:38 -0400 (Thu, 11 Apr 2002) | 2 lines

Added tracking of free (Ctrl)-connections. Password file processing.

------------------------------------------------------------------------
r30 | karp | 2002-04-11 00:39:50 -0400 (Thu, 11 Apr 2002) | 2 lines

Replaced owamp_datumify with str2datum. Added tcp_listen and read_passwd_file

------------------------------------------------------------------------
r29 | karp | 2002-04-09 11:11:45 -0400 (Tue, 09 Apr 2002) | 2 lines

Minor cosmetic changes.

------------------------------------------------------------------------
r28 | karp | 2002-04-08 19:06:23 -0400 (Mon, 08 Apr 2002) | 2 lines

Added policy_check and test_policy functions.

------------------------------------------------------------------------
r27 | karp | 2002-04-04 17:25:47 -0500 (Thu, 04 Apr 2002) | 2 lines

Class2limits processing complete.

------------------------------------------------------------------------
r26 | karp | 2002-04-04 17:16:23 -0500 (Thu, 04 Apr 2002) | 2 lines

Separated hashes from filenames. Moved tests into separate functions from main.

------------------------------------------------------------------------
r25 | karp | 2002-04-04 15:00:21 -0500 (Thu, 04 Apr 2002) | 2 lines

Fix owamp_read_limits() to do its job.

------------------------------------------------------------------------
r24 | karp | 2002-04-04 13:41:04 -0500 (Thu, 04 Apr 2002) | 2 lines

Cleaned up ipaddr2class() function.

------------------------------------------------------------------------
r23 | karp | 2002-04-04 12:40:27 -0500 (Thu, 04 Apr 2002) | 2 lines

Isolated dbm_* dependent code into wrapper functions

------------------------------------------------------------------------
r22 | boote | 2002-04-04 12:33:23 -0500 (Thu, 04 Apr 2002) | 5 lines

Not completely consistant at the moment - but I wanted to check-in anyway since
I won't be able to look at this for a few days.

jeff

------------------------------------------------------------------------
r21 | karp | 2002-04-04 01:28:04 -0500 (Thu, 04 Apr 2002) | 2 lines

Removed datum2string (redundant anyway).

------------------------------------------------------------------------
r20 | karp | 2002-04-04 01:24:28 -0500 (Thu, 04 Apr 2002) | 2 lines

Major revamping.

------------------------------------------------------------------------
r19 | boote | 2002-04-01 18:11:37 -0500 (Mon, 01 Apr 2002) | 4 lines

just checking in for backup purposes.

jeff

------------------------------------------------------------------------
r18 | karp | 2002-04-01 11:24:37 -0500 (Mon, 01 Apr 2002) | 2 lines

Fix names bug made in last commit

------------------------------------------------------------------------
r17 | karp | 2002-04-01 11:12:58 -0500 (Mon, 01 Apr 2002) | 2 lines

Minor readability improvements

------------------------------------------------------------------------
r16 | karp | 2002-03-31 17:59:09 -0500 (Sun, 31 Mar 2002) | 2 lines

Changed to dbm API. Added print_dbm function. Some clean-up

------------------------------------------------------------------------
r15 | karp | 2002-03-31 17:09:33 -0500 (Sun, 31 Mar 2002) | 2 lines

Added dbm, open, and assert support

------------------------------------------------------------------------
r14 | karp | 2002-03-31 04:27:42 -0500 (Sun, 31 Mar 2002) | 2 lines

Added fcntl header file.

------------------------------------------------------------------------
r13 | karp | 2002-03-31 04:26:55 -0500 (Sun, 31 Mar 2002) | 2 lines

Some clean-up. Basic skeleton for parsing config file.

------------------------------------------------------------------------
r12 | karp | 2002-03-30 18:32:03 -0500 (Sat, 30 Mar 2002) | 2 lines

Initial import

------------------------------------------------------------------------
r11 | boote | 2002-03-28 17:14:00 -0500 (Thu, 28 Mar 2002) | 4 lines

OWAMPKey

jeff

------------------------------------------------------------------------
r10 | boote | 2002-03-28 16:57:01 -0500 (Thu, 28 Mar 2002) | 4 lines

change copywrite

jeff

------------------------------------------------------------------------
r9 | boote | 2002-03-28 13:48:05 -0500 (Thu, 28 Mar 2002) | 4 lines

Next revision...

jeff

------------------------------------------------------------------------
r8 | boote | 2002-03-22 15:25:15 -0500 (Fri, 22 Mar 2002) | 2 lines

next round.

------------------------------------------------------------------------
r7 | karp | 2002-03-22 11:42:24 -0500 (Fri, 22 Mar 2002) | 2 lines

Added and clarified some api docs. Corrected name mismatches

------------------------------------------------------------------------
r6 | boote | 2002-03-21 17:10:48 -0500 (Thu, 21 Mar 2002) | 2 lines

Command-line vim is working!

------------------------------------------------------------------------
r5 | boote | 2002-03-21 16:54:40 -0500 (Thu, 21 Mar 2002) | 2 lines

*** empty log message ***

------------------------------------------------------------------------
r4 | boote | 2002-03-20 17:20:32 -0500 (Wed, 20 Mar 2002) | 2 lines

*** empty log message ***

------------------------------------------------------------------------
r3 | boote | 2002-03-19 18:08:10 -0500 (Tue, 19 Mar 2002) | 2 lines

Initial design docs.

------------------------------------------------------------------------
r2 | boote | 2002-03-19 12:25:09 -0500 (Tue, 19 Mar 2002) | 4 lines

Adding initial design docs to owamp.

jeff

------------------------------------------------------------------------
r1 | (no author) | 2002-03-19 12:25:09 -0500 (Tue, 19 Mar 2002) | 1 line

New repository initialized by cvs2svn.
------------------------------------------------------------------------
